(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5538:function(e,t,a){e.exports=a(5803)},5539:function(e,t,a){},5775:function(e,t,a){},5779:function(e,t,a){},5801:function(e,t,a){},5803:function(e,t,a){"use strict";a.r(t);a(5539);var n=a(7),r=a(12),o=a(10),l=a(11),i=a(9),s=a(167),c=a.n(s),u=a(170),d=a.n(u),m=a(171),p=a.n(m),g=a(81),h=a.n(g),f=a(57),v=a.n(f),E=a(169),b=a.n(E),C=a(18),T=a(38),O=a(165),S=a.n(O),y=a(242),N=a.n(y),L=a(194),R=a(14),I=a(133),A=a.n(I),w=a(31),D=a.n(w),x=a(193),j=a(344),k=a.n(j),M=function e(){Object(n.a)(this,e)};M.parseQueryParams=function(e){var t={};if(e){var a=e;if(e.startsWith("?")&&(a=e.substr(1)),a)for(var n=a.split("&"),r=0;r<n.length;r++){var o=n[r].split("="),l=decodeURIComponent(o[0]);l&&(t[l]=2!==o.length||!o[1]||decodeURIComponent(o[1]))}}return t},M.generateQueryParamString=function(e){var t="";if(e)for(var a=Object.entries(e),n=0;n<a.length;n++){var r=a[n],o=Object(x.a)(r,2),l=o[0],i=o[1];if(i){if("string"!==typeof i&&"number"!==typeof i&&"boolean"!==typeof i)throw Error("Query param value need to be a string, number or boolean "+"instead found ".concat(typeof i));t+=t?"&":"?",t+="".concat(encodeURIComponent(l),"=").concat(encodeURIComponent(i))}}return t},M.callObservabilityAPI=function(e,t){return e.url="".concat(t.get(ae.CONFIG).observabilityAPIURL).concat(e.url),M.callAPI(e,t)},M.callAPI=function(e,t){return new Promise(function(a,n){e.headers||(e.headers={}),e.headers.Accept||(e.headers.Accept="application/json"),e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e.data||"POST"!==e.method&&"PUT"!==e.method&&"PATCH"!==e.method||(e.data={}),k()(e).then(function(e){e.status>=200&&e.status<400?a(e.data):n(e.data)}).catch(function(e){if(e.response){var a=e.response;401===a.status&&t&&se.signOut(t),n(new Error(a.data))}else n(e)})})};var _=M,P=a(89),B=a.n(P),F=a(44),G=a.n(F),U=a(61),q=a.n(U),V=a(0),z=a.n(V),H=a(33),W=a.n(H),Q=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M12.5,0.8H1.5c-0.7,0-1.2,0.6-1.2,1.2v7.4c0,0.7,0.6,1.2,1.2,1.2h4.3v1.2H4.5v1.2h4.9v-1.2H8.2v-1.2h4.3\nc0.7,0,1.2-0.6,1.2-1.2V2.1C13.8,1.4,13.2,0.8,12.5,0.8z M12.5,9.5H1.5V2.1h11.1V9.5z M10,9L7.9,7.8V5.5L10,4.3L12,5.5v2.4L10,9z M9.1,7.2L10,7.7l0.9-0.5v-1L10,5.7L9.1,6.2V7.2z M8,6.8L5.5,5.4l0.4-0.6l2.5,1.4L8,6.8z M4,7.2L1.9,6V3.7L4,2.5L6,3.7V6L4,7.2z M3.1,5.4L4,5.9l0.9-0.5v-1L4,3.8L3.1,4.3V5.4z"}))},Y=a(5808),K=a(30),Z=Object(K.withStyles)(function(e){return{notFoundContainer:{position:"relative",top:0,left:0,height:"100%",width:"100%",display:"grid"},notFound:{margin:"auto",textAlign:"center"},notFoundContentIndicator:{margin:3*e.spacing.unit,fontSize:"4em",color:"#6e6e6e"},notFoundTitle:{margin:e.spacing.unit,fontSize:"1.5em",fontWeight:400,color:"#6e6e6e"},notFoundDescription:{fontSize:"1em",fontWeight:300,color:"#808080",maxWidth:"50vw"},navigationButton:{margin:e.spacing.unit},navigationButtonIcon:{marginRight:e.spacing.unit}}},{withTheme:!0})(Object(Y.a)(function(e){return z.a.createElement("div",{className:e.classes.notFoundContainer},z.a.createElement("div",{className:e.classes.notFound},z.a.createElement(q.a,{className:e.classes.notFoundContentIndicator}),z.a.createElement("div",{className:e.classes.notFoundTitle},e.title?e.title:"Unable to Find What You were Looking For"),e.description?z.a.createElement("div",{className:e.classes.notFoundDescription},e.description):null,e.showNavigationButtons?z.a.createElement(z.a.Fragment,null,z.a.createElement(G.a,{variant:"outlined",size:"small",className:e.classes.navigationButton,onClick:function(){return e.history.goBack()}},z.a.createElement(B.a,{className:e.classes.navigationButtonIcon}),"Go Back"),z.a.createElement(G.a,{variant:"outlined",size:"small",className:e.classes.navigationButton,onClick:function(){return e.history.push("/")}},z.a.createElement(Q,{fontSize:"small",className:e.classes.navigationButtonIcon}),"Overview")):null))})),X={Pattern:{DATE_TIME:"DD MMM YYYY, hh:mm A",PRECISE_DATE_TIME:"DD MMM YYYY, hh:mm:ss A",Query:{SECONDS:"second(?:s)?",MINUTES:"minute(?:s)?",HOURS:"hour(?:s)?",DAYS:"day(?:s)?",MONTHS:"month(?:s)?",YEARS:"year(?:s)?"}},Span:{Kind:{CLIENT:"CLIENT",SERVER:"SERVER",PRODUCER:"PRODUCER",CONSUMER:"CONSUMER"}},Cell:{GATEWAY_NAME_PATTERN:/^gateway$/,COMPONENT_NAME_PATTERN:/^(.+)--(.+)$/},System:{ISTIO_MIXER_NAME_PATTERN:/^istio-mixer$/,GLOBAL_GATEWAY_NAME_PATTERN:/^global-gateway$/,SIDECAR_AUTH_FILTER_OPERATION_NAME_PATTERN:/^async\sext_authz\segress$/},CelleryType:{SYSTEM:"System",COMPONENT:"Component"},Status:{Success:"Success",Error:"Error",Warning:"Warning"},Dashboard:{ALL_VALUE:"All",INBOUND:"Inbound",OUTBOUND:"Outbound",SIDE_NAV_BAR_WIDTH:240,APIM_HOSTNAME:"wso2-apim"}};X.Pattern.Query.TIME_UNIT="".concat(X.Pattern.Query.YEARS,"|").concat(X.Pattern.Query.MONTHS,"|")+"".concat(X.Pattern.Query.DAYS,"|").concat(X.Pattern.Query.HOURS,"|").concat(X.Pattern.Query.MINUTES,"|")+"".concat(X.Pattern.Query.SECONDS),X.Pattern.Query.TIME="([0-9]+)\\s*(".concat(X.Pattern.Query.TIME_UNIT,")"),X.Pattern.Query.RELATIVE_TIME="^\\s*now\\s*(?:-\\s*(?:".concat(X.Pattern.Query.TIME,"\\s*)+)?$");var J=X,$=a(41),ee=a.n($),te=function e(){var t,a=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n.a)(this,e),this.state={},this.set=function(e,t){e&&(a.state[e]||(a.state[e]={value:null}),a.notify(e,t),a.state[e].value=t)},this.unset=function(e){e&&a.state[e]&&(a.notify(e,null),a.state[e].value=null)},this.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return a.state[e]&&(t=a.state[e].value),t},this.addListener=function(e,t){a.state[e]||(a.state[e]={}),a.state[e].listeners||(a.state[e].listeners=[]),a.state[e].listeners.push(t)},this.removeListener=function(e,t){if(a.state[e]){var n=a.state[e].listeners;if(n){var r=n.indexOf(t);n.splice(r,1)}}},this.notify=function(e,t){var n=a.state[e].value,r=a.state[e].listeners;n!==t&&r&&r.forEach(function(a){return a(e,n,t)})},this.loadConfig=function(){var t=a;return new Promise(function(a,n){_.callAPI({url:"/config",method:"GET"}).then(function(n){t.set(e.CONFIG,n),a(n)}).catch(function(e){n(e)})})};var o=null;if(r.globalFilterStartTime){var l=ee()(parseInt(r.globalFilterStartTime,10)).format(J.Pattern.DATE_TIME);"Invalid date"!==l&&(o=l)}var i=null;if(r.globalFilterEndTime){var s=ee()(parseInt(r.globalFilterEndTime,10)).format(J.Pattern.DATE_TIME);"Invalid date"!==s&&(i=s)}for(var c=!r.hasOwnProperty("globalAutoRefresh")||!0===r.globalAutoRefresh||"true"===r.globalAutoRefresh,u=(t={},Object(C.a)(t,e.USER,se.getAuthenticatedUser()),Object(C.a)(t,e.LOADING_STATE,{loadingOverlayCount:0,message:null}),Object(C.a)(t,e.NOTIFICATION_STATE,{isOpen:!1,message:null,notificationLevel:null}),Object(C.a)(t,e.CONFIG,{}),Object(C.a)(t,e.GLOBAL_FILTER,{startTime:o||"now - 24 hours",endTime:i||"now",dateRangeNickname:o||i?null:"Last 24 hours",refreshInterval:c?3e4:-1}),t),d={},m=Object.entries(u),p=0;p<m.length;p++){var g=m[p],h=Object(x.a)(g,2),f=h[0],v=h[1];d[f]={value:v}}this.state=d};te.USER="user",te.LOADING_STATE="loadingState",te.NOTIFICATION_STATE="notificationState",te.CONFIG="config",te.GLOBAL_FILTER="globalFilter";var ae=te,ne=z.a.createContext({}),re=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=Object(R.a)(Object(R.a)(a));e.mounted=!0,e.stateHolder.loadConfig().then(function(){e.mounted&&e.setState({isLoading:!1,isConfigAvailable:!0})}).catch(function(){e.mounted&&e.setState({isLoading:!1})})},a.componentWillUnmount=function(){a.mounted=!1},a.render=function(){var e=a.props,t=e.children,n=e.classes,r=a.state,o=r.isLoading,l=r.isConfigAvailable?t:z.a.createElement(Z,{title:"Failed to Load Cellery Observability Portal Configuration"});return z.a.createElement(ne.Provider,{value:a.stateHolder},o?z.a.createElement(D.a,{container:!0,justify:"center",alignItems:"center",className:n.container},z.a.createElement(D.a,{item:!0},z.a.createElement(A.a,{size:60}))):l)},a.state={isLoading:!0,isConfigAvailable:!1},a.mounted=!1;var l=_.parseQueryParams(e.location.search);return a.stateHolder=new ae(l),a}return Object(l.a)(t,e),t}(z.a.Component),oe=Object(K.withStyles)(function(){return{container:{minHeight:"100%",bottom:0}}},{withTheme:!0})(Object(Y.a)(re)),le=function(e){var t=function(t){function a(){var t,l;Object(n.a)(this,a);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(l=Object(r.a)(this,(t=Object(o.a)(a)).call.apply(t,[this].concat(s)))).render=function(){var t=l.props,a=t.forwardedRef,n=Object(L.a)(t,["forwardedRef"]);return z.a.createElement(ne.Consumer,null,function(t){return z.a.createElement(e,Object.assign({globalState:t,ref:a},n))})},l}return Object(l.a)(a,t),a}(z.a.Component);return z.a.forwardRef(function(e,a){return z.a.createElement(t,Object.assign({},e,{forwardedRef:a}))})},ie=function e(){Object(n.a)(this,e)};ie.signIn=function(e,t){if(!e)throw Error('Username provided cannot be "'.concat(e,'"'));var a={username:e};localStorage.setItem(ae.USER,JSON.stringify(a)),t.set(ae.USER,a)},ie.signOut=function(e){e.unset(ae.USER),localStorage.setItem("isAuthenticated","loggedOut"),window.location.reload()},ie.getAuthenticatedUser=function(){var e;try{e=JSON.parse(localStorage.getItem(ae.USER))}catch(t){e=null,localStorage.removeItem(ae.USER)}return e};var se=ie,ce=a(166),ue=a.n(ce),de=a(161),me=a.n(de),pe=a(240),ge=a.n(pe),he=a(160),fe=a.n(he),ve=a(241),Ee=a.n(ve),be=a(347),Ce=a.n(be),Te=function e(){var t=this;Object(n.a)(this,e),this.initializeMainColors=function(){t.colorMap&&"object"===typeof t.colorMap||(t.colorMap={}),t.colorMap[e.SYSTEM]="#ababab",t.colorMap[e.UNKNOWN]="#71736f",t.colorMap[e.SUCCESS]=ge.a[500],t.colorMap[e.WARNING]=Ee.a[800],t.colorMap[e.ERROR]=fe.a[500],t.colorMap[e.CLIENT_ERROR]=me.a[500]},this.addKeys=function(e){for(var a=t,n=e.filter(function(e){return!(e in a.colorMap)}),r=t.generateColors(n.length),o=0;o<n.length;o++)a.colorMap[n[o]]=r[o];t.persistColorMap()},this.getColor=function(e){return e in t.colorMap||t.addKeys([e]),t.colorMap[e]},this.getColorForPercentage=function(a,n){var r=e.SUCCESS;return a<n.get(ae.CONFIG).percentageRangeMinValue.warningThreshold&&(r=e.WARNING),a<n.get(ae.CONFIG).percentageRangeMinValue.errorThreshold&&(r=e.ERROR),(a<0||a>1)&&(r=e.UNKNOWN),t.colorMap[r]},this.generateColors=function(e){for(var a=[],n=e;n>0;){var r=Ce()({luminosity:"light",count:n}),o=!0,l=!1,i=void 0;try{for(var s,c=r[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var u=s.value;t.colorMap[u]||a.includes(u)||(a.push(u),n-=1)}}catch(d){l=!0,i=d}finally{try{o||null==c.return||c.return()}finally{if(l)throw i}}}return a},this.resetColors=function(){localStorage.removeItem(e.LOCAL_STORAGE_ITEM),t.initializeMainColors(),t.notify()},this.addListener=function(e){t.listeners.push(e)},this.removeListener=function(e){var a=t.listeners.indexOf(e);t.listeners.splice(a,1)},this.notify=function(){t.listeners.forEach(function(e){return e()})},this.persistColorMap=function(){localStorage.setItem(e.LOCAL_STORAGE_ITEM,JSON.stringify(t.colorMap))},this.loadColorMap=function(){t.colorMap=JSON.parse(localStorage.getItem(e.LOCAL_STORAGE_ITEM))},this.loadColorMap(),this.initializeMainColors(),this.listeners=[]};Te.SYSTEM="System",Te.UNKNOWN="UNKNOWN",Te.SUCCESS="SUCCESS",Te.WARNING="WARNING",Te.ERROR="ERROR",Te.CLIENT_ERROR="CLIENT_ERROR",Te.LOCAL_STORAGE_ITEM="colorMap",Te.shadeColor=function(e,t){var a=parseInt(e.slice(1),16),n=t<0?0:255,r=t<0?-1*t:t,o=a>>16,l=a>>8&255,i=255&a;return"#".concat((16777216+65536*(Math.round((n-o)*r)+o)+256*(Math.round((n-l)*r)+l)+(Math.round((n-i)*r)+i)).toString(16).slice(1))};var Oe=Te,Se=a(135),ye=a.n(Se),Ne=a(164),Le=a.n(Ne),Re=a(163),Ie=a.n(Re),Ae=a(52),we=a.n(Ae),De=a(244),xe=a.n(De),je=a(117),ke=a.n(je),Me=a(162),_e=a.n(Me),Pe=a(36),Be=a.n(Pe),Fe=a(73),Ge=a.n(Fe),Ue=a(243),qe=a.n(Ue),Ve=function e(){Object(n.a)(this,e)};Ve.YEARS="years",Ve.MONTHS="months",Ve.DAYS="days",Ve.HOURS="hours",Ve.MINUTES="minutes",Ve.SECONDS="seconds",Ve.TIME_GRANULARITY_MINIMUM_VALUE=2,Ve.parseTime=function(e){var t=ee()(e,J.Pattern.DATE_TIME,!0);if(new RegExp(J.Pattern.Query.RELATIVE_TIME,"i").test(e)){for(var a,n=new RegExp(J.Pattern.Query.TIME,"gi"),r=[];a=n.exec(e);)r.push({amount:a[1],unit:a[2]});t=ee()();for(var o=0;o<r.length;o++){var l=r[o],i=l.amount,s=l.unit.toLowerCase();t=t.subtract(i,s.endsWith("s")?s:"".concat(s,"s"))}}else if("Invalid date"===t.format())throw Error("Invalid time");return t},Ve.getTimeGranularity=function(e,t){return t.diff(e,Ve.YEARS)>Ve.TIME_GRANULARITY_MINIMUM_VALUE?Ve.YEARS:t.diff(e,Ve.MONTHS)>Ve.TIME_GRANULARITY_MINIMUM_VALUE?Ve.MONTHS:t.diff(e,Ve.DAYS)>Ve.TIME_GRANULARITY_MINIMUM_VALUE?Ve.DAYS:t.diff(e,Ve.HOURS)>Ve.TIME_GRANULARITY_MINIMUM_VALUE?Ve.HOURS:t.diff(e,Ve.MINUTES)>Ve.TIME_GRANULARITY_MINIMUM_VALUE?Ve.MINUTES:Ve.SECONDS};var ze=Ve,He=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M13.8,5L9.9,1.7C9.8,1.5,9.6,1.5,9.4,1.6C9.2,1.7,9.1,1.8,9.1,2.1v1.7c-3,0.2-4.5,1.7-5.2,3C3.2,8,3.1,9.2,3.1,9.6\nc0,0.1,0,0.1,0,0.2l0,0l0,0.2c0,0.2,0.3,0.4,0.5,0.4c0.3,0,0.5-0.2,0.5-0.5l0-0.1c0.1-2,3.7-2.5,5-2.7v1.6c0,0.2,0.1,0.4,0.3,0.5\nc0.2,0.1,0.4,0.1,0.6-0.1l3.8-3.3C13.9,5.7,14,5.5,14,5.4S13.9,5.1,13.8,5z M13.6,5.2L13.6,5.2L13.6,5.2L13.6,5.2z M10,6.1\nC9.9,6,9.7,6,9.6,6c0,0,0,0,0,0C9.4,6,6.7,6.1,4.9,7.2C5.6,6,6.9,4.8,9.6,4.8c0.1,0,0.3-0.1,0.4-0.2c0.1-0.1,0.2-0.2,0.2-0.4V3.2\nl2.5,2.2l-2.5,2.2V6.5C10.1,6.4,10.1,6.2,10,6.1z M12.3,8.8v1.8c0,0.8-0.6,1.4-1.3,1.4H1.7c-0.7,0-1.3-0.6-1.3-1.4V5.1\nc0-0.8,0.6-1.4,1.3-1.4h3.1C5,3.7,5.2,4,5.2,4.3c0,0.3-0.2,0.5-0.5,0.5h-3c-0.2,0-0.3,0.1-0.3,0.3v5.6c0,0.2,0.1,0.3,0.3,0.3H11\nc0.2,0,0.3-0.1,0.3-0.3V8.8c0-0.3,0.2-0.5,0.5-0.5C12.1,8.3,12.3,8.6,12.3,8.8z"}))},We=a(134),Qe=a.n(We),Ye=a(68),Ke=a.n(Ye),Ze=a(32),Xe=a.n(Ze),Je=a(5),$e=a.n(Je),et=z.a.createContext(null),tt=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleColorChange=function(){a.state.colorGenerator.removeListener(a.handleColorChange);var e=new Oe;a.setState({colorGenerator:e}),e.addListener(a.handleColorChange)},a.render=function(){var e=a.props.children,t=a.state.colorGenerator;return z.a.createElement(et.Provider,{value:t},e)};var l=new Oe;return a.state={colorGenerator:l},l.addListener(a.handleColorChange),a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"componentWillUnmount",value:function(){this.state.colorGenerator.removeListener(this.handleColorChange)}}]),t}(z.a.Component),at=function(e){var t=function(t){function a(){return Object(n.a)(this,a),Object(r.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(l.a)(a,t),Object(T.a)(a,[{key:"render",value:function(){var t=this.props,a=t.forwardedRef,n=Object(L.a)(t,["forwardedRef"]);return z.a.createElement(et.Consumer,null,function(t){return z.a.createElement(e,Object.assign({colorGenerator:t,ref:a},n))})}}]),a}(z.a.Component);return z.a.forwardRef(function(e,a){return z.a.createElement(t,Object.assign({},e,{forwardedRef:a}))})},nt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleDashboardSharePopoverOpen=function(e){a.setState({dashBoardSharePopoverElement:e.currentTarget})},a.handleDashboardSharePopoverClose=function(){a.setState({dashBoardSharePopoverElement:null})},a.handleAccountPopoverOpen=function(e){a.setState({accountPopoverElement:e.currentTarget})},a.handleAccountPopoverClose=function(){a.setState({accountPopoverElement:null})},a.handleSideNavBarOpen=function(){var e=a.props.onSideNavBarOpen;e&&e()},a.copyShareableLinkToClipboard=function(){a.dashboardShareableLinkRef.current&&(a.dashboardShareableLinkRef.current.select(),document.execCommand("copy"),a.setState({isDashboardLinkCopiedTooltipOpen:!0}))},a.onDashboardLinkCopiedTooltipClose=function(){a.setState({isDashboardLinkCopiedTooltipOpen:!1})},a.resetColorScheme=function(){a.props.colorGenerator.resetColors()},a.getShareableLink=function(){var e=a.props,t=e.globalState,n=e.location,r=t.get(ae.GLOBAL_FILTER),o=_.parseQueryParams(n.search);return o.globalFilterStartTime=ze.parseTime(r.startTime).valueOf(),o.globalFilterEndTime=ze.parseTime(r.endTime).valueOf(),window.location.origin+n.pathname+_.generateQueryParamString(o)},a.state={isDashboardLinkCopiedTooltipOpen:!1,dashBoardSharePopoverElement:null,accountPopoverElement:null},a.dashboardShareableLinkRef=z.a.createRef(),a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.isSideNavBarOpen,n=e.globalState,r=this.state,o=r.dashBoardSharePopoverElement,l=r.isDashboardLinkCopiedTooltipOpen,i=r.accountPopoverElement,s=Boolean(i),c=Boolean(o),u=n.get(ae.USER);return z.a.createElement(N.a,{position:"fixed",className:$e()(t.appBar,Object(C.a)({},t.appBarShift,a))},z.a.createElement(Qe.a,{disableGutters:!a},z.a.createElement(we.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleSideNavBarOpen,className:$e()(t.menuButton,Object(C.a)({},t.hide,a))},z.a.createElement(_e.a,null)),z.a.createElement(Xe.a,{variant:"h6",color:"inherit",className:t.grow},"Cellery Observability"),u?z.a.createElement("div",null,z.a.createElement(Ke.a,{title:"Change color scheme",placement:"bottom"},z.a.createElement(we.a,{onClick:this.resetColorScheme,color:"inherit"},z.a.createElement(Ie.a,null))),z.a.createElement(Ke.a,{title:"Get shareable dashboard link",placement:"bottom"},z.a.createElement(we.a,{color:"inherit","aria-haspopup":"true",variant:"contained","aria-owns":c?"share-dashboard":void 0,onClick:this.handleDashboardSharePopoverOpen},z.a.createElement(He,null))),z.a.createElement(qe.a,{id:"share-dashboard",open:c,anchorEl:o,onClose:this.handleDashboardSharePopoverClose,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},z.a.createElement("div",{className:t.popoverContent},z.a.createElement(Xe.a,{color:"textSecondary",variant:"subtitle2",gutterBottom:!0},"Share Dashboard"),z.a.createElement(ye.a,null),z.a.createElement(Ge.a,{className:t.copyContainer,elevation:1},z.a.createElement(xe.a,{className:t.copyInput,inputProps:{spellCheck:!1},value:this.getShareableLink(),inputRef:this.dashboardShareableLinkRef}),z.a.createElement(Ke.a,{title:"Copied!",disableFocusListener:!1,disableHoverListener:!1,placement:"top",disableTouchListener:!1,open:l,onClose:this.onDashboardLinkCopiedTooltipClose},z.a.createElement(we.a,{color:"primary",className:t.iconButton,"aria-label":"Copy",onClick:this.copyShareableLinkToClipboard},z.a.createElement(Le.a,null)))))),z.a.createElement(we.a,{"aria-owns":s?"user-info-appbar":void 0,color:"inherit","aria-haspopup":"true",onClick:this.handleAccountPopoverOpen},z.a.createElement(S.a,null)),z.a.createElement(ke.a,{id:"user-info-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:s,onClose:this.handleAccountPopoverClose},z.a.createElement(Be.a,{onClick:this.handleAccountPopoverClose,className:t.avatarContainer},z.a.createElement(ue.a,{className:t.userAvatar},u.username.substr(0,1).toUpperCase()),u.username),z.a.createElement(Be.a,{onClick:function(){return se.signOut(n)}},"Sign Out"))):null))}}]),t}(z.a.Component),rt=Object(K.withStyles)(function(e){return{appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),backgroundColor:e.palette.primary.dark},appBarShift:{marginLeft:J.Dashboard.SIDE_NAV_BAR_WIDTH,width:"calc(100% - ".concat(J.Dashboard.SIDE_NAV_BAR_WIDTH,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginLeft:12,marginRight:20},hide:{display:"none"},grow:{flexGrow:1},popoverContent:{margin:3*e.spacing.unit},copyContainer:{marginTop:2*e.spacing.unit,boxShadow:"none",border:"1px solid #eee"},copyInput:{margin:e.spacing.unit,flex:1},iconButton:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},avatarContainer:{marginBottom:2*e.spacing.unit,pointerEvents:"none"},userAvatar:{marginRight:1.5*e.spacing.unit,color:"#fff",backgroundColor:e.palette.primary.main}}},{withTheme:!0})(Object(Y.a)(le(at(nt)))),ot=function e(){Object(n.a)(this,e)};ot.Levels={INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR"},ot.showLoadingOverlay=function(e,t){var a=t.get(ae.LOADING_STATE);t.set(ae.LOADING_STATE,{loadingOverlayCount:a.loadingOverlayCount+1,message:e})},ot.hideLoadingOverlay=function(e){var t=e.get(ae.LOADING_STATE);e.set(ae.LOADING_STATE,{loadingOverlayCount:0===t.loadingOverlayCount?0:t.loadingOverlayCount-1,message:null})},ot.showNotification=function(e,t,a){a.set(ae.NOTIFICATION_STATE,{isOpen:!0,message:e,notificationLevel:t})},ot.closeNotification=function(e){e.set(ae.NOTIFICATION_STATE,Object(i.a)({},e.get(ae.NOTIFICATION_STATE),{isOpen:!1}))};var lt=ot,it=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M10.7,13.7l-3.1-1.8V8.4l3.1-1.8l3.1,1.8v3.6L10.7,13.7z M7,7.5L3.8,5.7V2L7,0.2L10.2,2v3.6L7,7.5z M5.1,4.9 l1.9,1l1.9\n-1V 2.8L7,1.8l-1.9,1V4.9z M3.4,13.8L0.2,12V8.4l3.2-1.8l3.2,1.8V12L3.4,13.8z M8.8,11.2l1.9,1l1.9-1V9.1l-1.9 -1l-1.9,\n1V11.2z M1.5,11.2l1.9,1l1.9-1V9.1l-1.9-1l-1.9,1V11.2z"}))},st=a(118),ct=a.n(st),ut=a(90),dt=a.n(ut),mt=a(131),pt=a.n(mt),gt=a(245),ht=a.n(gt),ft=a(136),vt=a.n(ft),Et=a(137),bt=a.n(Et),Ct=a(138),Tt=a.n(Ct),Ot=a(64),St=a.n(Ot),yt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var l=arguments.length,i=new Array(l),s=0;s<l;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(i)))).handleSideNavBarClose=function(){var e=a.props.onSideNavBarClose;e&&e()},a.handleNavItemClick=function(e){a.props.history.push(e,{hideBackButton:!0})},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){for(var e,t,a=this,n=this.props,r=n.classes,o=n.theme,l=n.location,i=n.isSideNavBarOpen,s=["/","/cells","/tracing"],c=0,u=0;u<s.length;u++)l.pathname.startsWith(s[u])&&(c=u);return z.a.createElement(pt.a,{variant:"permanent",open:i,className:$e()(r.drawer,(e={},Object(C.a)(e,r.drawerOpen,i),Object(C.a)(e,r.drawerClose,!i),e)),classes:{paper:$e()((t={},Object(C.a)(t,r.drawerOpen,i),Object(C.a)(t,r.drawerClose,!i),t))}},z.a.createElement("div",{className:r.toolbar},z.a.createElement(we.a,{onClick:this.handleSideNavBarClose},"rtl"===o.direction?z.a.createElement(dt.a,null):z.a.createElement(ct.a,null))),z.a.createElement(ye.a,null),z.a.createElement(ht.a,{className:r.list},z.a.createElement(Ke.a,{title:"Overview",placement:"right",disableFocusListener:i,disableHoverListener:i,disableTouchListener:i},z.a.createElement(vt.a,{index:0,button:!0,key:"Overview",className:$e()(Object(C.a)({},r.active,0===c)),onClick:function(e){a.handleNavItemClick(s[0],e)}},z.a.createElement(bt.a,{className:r.listIcon},z.a.createElement(Q,{className:$e()(Object(C.a)({},r.active,0===c))})),z.a.createElement(Tt.a,{primary:"Overview",classes:{primary:$e()(Object(C.a)({},r.active,0===c))}}))),z.a.createElement(Ke.a,{title:"Cells",placement:"right",disableFocusListener:i,disableHoverListener:i,disableTouchListener:i},z.a.createElement(vt.a,{index:1,button:!0,key:"Cells",className:$e()(Object(C.a)({},r.active,1===c)),onClick:function(e){a.handleNavItemClick(s[1],e)}},z.a.createElement(bt.a,{className:r.listIcon},z.a.createElement(it,{className:$e()(Object(C.a)({},r.active,1===c))})),z.a.createElement(Tt.a,{primary:"Cells",classes:{primary:$e()(Object(C.a)({},r.active,1===c))}}))),z.a.createElement(Ke.a,{title:"Distributed Tracing",placement:"right",disableFocusListener:i,disableHoverListener:i,disableTouchListener:i},z.a.createElement(vt.a,{index:2,button:!0,key:"Distributed Tracing",className:$e()(Object(C.a)({},r.active,2===c)),onClick:function(e){a.handleNavItemClick(s[2],e)}},z.a.createElement(bt.a,{className:r.listIcon},z.a.createElement(St.a,{className:$e()(Object(C.a)({},r.active,2===c))})),z.a.createElement(Tt.a,{primary:"Distributed Tracing",classes:{primary:$e()(Object(C.a)({},r.active,2===c))}})))))}}]),t}(z.a.Component),Nt=Object(K.withStyles)(function(e){return{drawer:{width:J.Dashboard.SIDE_NAV_BAR_WIDTH,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:J.Dashboard.SIDE_NAV_BAR_WIDTH,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(C.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:7*e.spacing.unit+1},e.breakpoints.up("sm"),{width:9*e.spacing.unit+1}),toolbar:Object(i.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),list:{paddingTop:0},listIcon:{paddingLeft:e.spacing.unit},active:{color:e.palette.primary.main,fontWeight:500}}},{withTheme:!0})(Object(Y.a)(yt)),Lt=a(246),Rt=a.n(Lt),It=a(168),At=a.n(It),wt=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleSideNavBarOpen=function(){a.setState({isSideNavBarOpen:!0})},a.handleSideNavBarClose=function(){a.setState({isSideNavBarOpen:!1})},a.handleLoadingStateChange=function(e,t,n){a.setState({loadingState:{isLoading:n.loadingOverlayCount>0,message:n.message}})},a.handleNotificationStateChange=function(e,t,n){a.setState({notificationState:{isOpen:n.isOpen,message:n.message,notificationLevel:n.notificationLevel}})},a.handleNotificationClose=function(){var e=a.props.globalState;lt.closeNotification(e)},a.generateSnackbarMessage=function(){var e,t=a.props.classes,n=a.state.notificationState;switch(n.notificationLevel){case lt.Levels.SUCCESS:e=c.a;break;case lt.Levels.WARNING:e=At.a;break;case lt.Levels.ERROR:e=h.a;break;default:e=b.a}return z.a.createElement("span",{className:t.snackbarMessageContainer},z.a.createElement(e,{className:t.snackbarIcon}),z.a.createElement("span",{className:t.snackbarMessage},n.message))},a.render=function(){var e=a.props,t=e.classes,n=e.children,r=a.state,o=r.isSideNavBarOpen,l=r.loadingState,i=r.notificationState;return z.a.createElement("div",{className:t.appRoot},z.a.createElement(rt,{isSideNavBarOpen:o,onSideNavBarOpen:a.handleSideNavBarOpen}),z.a.createElement(Nt,{isSideNavBarOpen:o,onSideNavBarClose:a.handleSideNavBarClose}),z.a.createElement("main",{className:t.content},z.a.createElement("div",{className:t.progressOverlayContainer,style:{display:l.isLoading?"block":"none"}},z.a.createElement("div",{className:t.toolbar}),z.a.createElement("div",{className:t.progressOverlay},z.a.createElement("div",{className:t.progress},z.a.createElement(d.a,{className:t.progressIndicator,thickness:4.5,size:45}),z.a.createElement("div",{className:t.progressContent},l.message?l.message:"Loading","...")))),n),z.a.createElement(Rt.a,{open:i.isOpen,ContentProps:{"aria-describedby":"main-notification"},anchorOrigin:{vertical:"bottom",horizontal:"left"},onClose:a.handleNotificationClose,message:a.generateSnackbarMessage(),autoHideDuration:5e3,action:[z.a.createElement(v.a,{key:"close","aria-label":"Close",color:"inherit",onClick:a.handleNotificationClose},z.a.createElement(p.a,null))]}))};var l=e.globalState.get(ae.LOADING_STATE),s=e.globalState.get(ae.NOTIFICATION_STATE);return a.state={isSideNavBarOpen:!1,loadingState:Object(i.a)({},l),notificationState:Object(i.a)({},s)},e.globalState.addListener(ae.LOADING_STATE,a.handleLoadingStateChange),e.globalState.addListener(ae.NOTIFICATION_STATE,a.handleNotificationStateChange),a}return Object(l.a)(t,e),t}(z.a.Component),Dt=Object(K.withStyles)(function(e){return{appRoot:{display:"flex",flexGrow:1,minHeight:"100%"},toolbar:Object(i.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),content:{position:"relative",flexGrow:1,padding:3*e.spacing.unit,minHeight:"100%"},progressOverlayContainer:{position:"absolute",zIndex:9999,top:0,left:0,width:"100%",height:"100%"},progressOverlay:{position:"relative",display:"grid",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgb(0, 0, 0, 0.5)"},progress:{textAlign:"center",margin:"auto"},progressIndicator:{margin:2*e.spacing.unit},progressContent:{fontSize:"large",fontWeight:500,width:"100%",color:"#ffffff"},snackbarIcon:{fontSize:"1.5em"},snackbarMessageContainer:{display:"flex",alignItems:"center"},snackbarMessage:{paddingLeft:e.spacing.unit}}},{withTheme:!0})(le(wt)),xt=a(192),jt=a.n(xt),kt=Object(K.withStyles)(function(e){return{table:{minWidth:1020},tableWrapper:{overflowX:"auto",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit}}})(function(e){var t=e.classes,a=e.options,n=e.columns,r=e.data;return z.a.createElement("div",{className:t.tableWrapper},z.a.createElement(jt.a,{data:r,columns:n,options:Object(i.a)({},{download:!1,selectableRows:!1,print:!1,filterType:"dropdown",responsive:"scroll"},a)}))}),Mt=a(102),_t=a.n(Mt),Pt=a(348),Bt=le(at(function(e){var t,a=e.colorGenerator,n=e.globalState,r=e.value,o=a.getColorForPercentage(r,n);return t=r<0||r>1?Pt.a:r<n.get(ae.CONFIG).percentageRangeMinValue.errorThreshold?q.a:r<n.get(ae.CONFIG).percentageRangeMinValue.warningThreshold?q.a:_t.a,z.a.createElement(t,{style:{color:o}})})),Ft=a(5804),Gt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n){a.loadComponentInfo(e,t,n)},a.loadComponentInfo=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=Object(R.a)(Object(R.a)(a)),s={queryStartTime:t.valueOf(),queryEndTime:n.valueOf()};e&&(lt.showLoadingOverlay("Loading Component Info",o),i.setState({isLoading:!0})),_.callObservabilityAPI({url:"/http-requests/cells/".concat(l,"/components/").concat(_.generateQueryParamString(s)),method:"GET"},o).then(function(t){var a=t.map(function(e){return{sourceCell:e[0],sourceComponent:e[1],destinationCell:e[2],destinationComponent:e[3],httpResponseGroup:e[4],totalResponseTimeMilliSec:e[5],requestCount:e[6]}});i.setState({componentInfo:a}),e&&(lt.hideLoadingOverlay(o),i.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),i.setState({isLoading:!1}),lt.showNotification("Failed to load component information",lt.Levels.ERROR,o))})},a.render=function(){var e=a.props.cell,t=a.state,n=t.componentInfo,r=t.isLoading,o=[{name:"Health",options:{customBodyRender:function(e){return z.a.createElement(Bt,{value:e})}}},{name:"Component",options:{customBodyRender:function(t){return z.a.createElement(Ft.a,{to:"/cells/".concat(e,"/components/").concat(t)},t)}}},{name:"Inbound Error Rate",options:{customBodyRender:function(e){return"".concat(Math.round(100*e)," %")}}},{name:"Outbound Error Rate",options:{customBodyRender:function(e){return"".concat(Math.round(100*e)," %")}}},{name:"Average Response Time (ms)",options:{customBodyRender:function(e){return Math.round(e)}}},{name:"Average Inbound Request Count (requests/s)"}],l={},i=function(e){l[e]||(l[e]={inboundErrorCount:0,outboundErrorCount:0,requestCount:0,totalResponseTimeMilliSec:0})},s=function(t,a){return!J.System.GLOBAL_GATEWAY_NAME_PATTERN.test(a)&&t===e},c=!0,u=!1,d=void 0;try{for(var m,p=n[Symbol.iterator]();!(c=(m=p.next()).done);c=!0){var g=m.value;s(g.sourceCell,g.sourceComponent)&&(i(g.sourceComponent),"5xx"===g.httpResponseGroup&&(l[g.sourceComponent].outboundErrorCount+=g.requestCount)),s(g.destinationCell,g.destinationComponent)&&(i(g.destinationComponent),"5xx"===g.httpResponseGroup&&(l[g.destinationComponent].inboundErrorCount+=g.requestCount),l[g.destinationComponent].requestCount+=g.requestCount,l[g.destinationComponent].totalResponseTimeMilliSec+=g.totalResponseTimeMilliSec)}}catch(b){u=!0,d=b}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}var h,f=[];for(var v in l)if(l.hasOwnProperty(v)&&Boolean(v)){var E=l[v];f.push([0===E.requestCount?-1:1-E.inboundErrorCount/E.requestCount,v,0===E.requestCount?0:E.inboundErrorCount/E.requestCount,0===E.requestCount?0:E.outboundErrorCount/E.requestCount,0===E.requestCount?0:E.totalResponseTimeMilliSec/E.requestCount,E.requestCount])}return h=f.length>0?z.a.createElement(kt,{columns:o,options:{filter:!1},data:f}):z.a.createElement(Z,{title:"No Components Found",description:'No Components found in "'.concat(e,'" cell.')+'This is because no requests were found between components in "'.concat(e,'" cell in the ')+"selected time range"}),r?null:h},a.state={componentInfo:[],isLoading:!1},a}return Object(l.a)(t,e),t}(z.a.Component),Ut=Object(K.withStyles)({})(le(Gt)),qt=(a(233),Object(K.withStyles)(function(e){return{unknownErrorContainer:{position:"relative",top:0,left:0,height:"100%",width:"100%",display:"grid"},unknownError:{margin:"auto",textAlign:"center"},unknownErrorContentIndicator:{margin:3*e.spacing.unit,fontSize:"4em",color:"#6E6E6E"},unknownErrorTitle:{margin:e.spacing.unit,fontSize:"1.5em",fontWeight:400,color:"#6e6e6e"},unknownErrorDescription:{fontSize:"1em",fontWeight:300,color:"#808080",maxWidth:"50vw"},navigationButtonsContainer:{margin:3*e.spacing.unit},navigationButton:{margin:e.spacing.unit},navigationButtonIcon:{marginRight:e.spacing.unit}}},{withTheme:!0})(Object(Y.a)(function(e){return z.a.createElement("div",{className:e.classes.unknownErrorContainer},z.a.createElement("div",{className:e.classes.unknownError},z.a.createElement(q.a,{className:e.classes.unknownErrorContentIndicator}),z.a.createElement("div",{className:e.classes.unknownErrorTitle},e.title?e.title:"Something Went Wrong"),e.description?z.a.createElement("div",{className:e.classes.unknownErrorDescription},e.description):null,e.showNavigationButtons?z.a.createElement("div",{className:e.classes.navigationButtonsContainer},z.a.createElement(G.a,{variant:"outlined",size:"small",className:e.classes.navigationButton,onClick:function(){return e.history.goBack()}},z.a.createElement(B.a,{className:e.classes.navigationButtonIcon}),"Go Back"),z.a.createElement(G.a,{variant:"outlined",size:"small",className:e.classes.navigationButton,onClick:function(){return e.history.push("/")}},z.a.createElement(Q,{fontSize:"small",className:e.classes.navigationButtonIcon}),"Overview")):null))}))),Vt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).render=function(){var e=a.props,t=e.children,n=e.title,r=e.description,o=e.showNavigationButtons;return a.state.hasError?z.a.createElement(qt,{title:n,description:r,showNavigationButtons:o}):t},a.state={hasError:!1},a}return Object(l.a)(t,e),t}(z.a.Component);Vt.getDerivedStateFromError=function(e){return console.error(e),{hasError:!0}};var zt=Vt,Ht=a(69),Wt=a.n(Ht),Qt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.dependencyGraph.current&&a.draw()},a.componentDidUpdate=function(){a.dependencyGraph.current&&a.draw()},a.draw=function(){var e=a.props,n=e.nodeData,r=e.edgeData,o=e.onClickNode,l=e.onClickGraph,i=e.selectedCell,s=e.viewGenerator,c=e.graphType,u=[],d=[];n&&n.forEach(function(e,t){u.push({id:e.id,label:e.id,shape:"image",image:s(e.id,0)})}),r&&r.forEach(function(e,t){d.find(function(t){return t.from===e.source&&t.to===e.target})||d.push({id:t,from:e.source,to:e.target})});var m=new Wt.a.DataSet(u),p=new Wt.a.DataSet(d),g={nodes:m,edges:p},h=new Wt.a.Network(a.dependencyGraph.current,g,t.GRAPH_OPTIONS);c===t.GraphType.OVERVIEW&&(h.on("selectNode",function(e){o(e.nodes[0],!0)}),h.on("deselectNode",function(e){l()})),i&&h.selectNodes([i],!1);var f=m.get({returnType:"Object"});h.on("hoverNode",function(e){var t=h.getConnectedNodes(e.node);if(t.length>0){var a=e.node;for(var n in f)f.hasOwnProperty(n)&&(f[n].image=s(n,.8),void 0===f[n].hiddenLabel&&(f[n].hiddenLabel=f[n].label,f[n].label=void 0));for(var r=0;r<t.length;r++)f[t[r]].image=s(t[r],0),void 0!==f[t[r]].hiddenLabel&&(f[t[r]].label=f[t[r]].hiddenLabel,f[t[r]].hiddenLabel=void 0);f[a].image=s(a,0),void 0!==f[a].hiddenLabel&&(f[a].label=f[a].hiddenLabel,f[a].hiddenLabel=void 0)}var o=[];for(var l in f)f.hasOwnProperty(l)&&o.push(f[l]);m.update(o)});h.on("blurNode",function(){for(var e in f)f.hasOwnProperty(e)&&(f[e].image=s(e,0),void 0!==f[e].hiddenLabel&&(f[e].label=f[e].hiddenLabel,f[e].hiddenLabel=void 0));var t=[];for(var a in f)f.hasOwnProperty(a)&&t.push(f[a]);m.update(t)})},a.render=function(){var e=a.props,t=e.nodeData,n=e.classes;return t&&t.length>0?z.a.createElement(zt,{title:"Unable to Render",description:"Unable to Render due to Invalid Data"},z.a.createElement("div",{className:n.graph,ref:a.dependencyGraph})):z.a.createElement(qt,{title:"No Data Available",description:"No Data Available to render Dependency Graph"})},a.dependencyGraph=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.Component);Qt.GraphType={OVERVIEW:"overview",DEPENDENCY:"dependency"},Qt.GRAPH_OPTIONS={nodes:{shapeProperties:{borderRadius:10},borderWidth:1,size:35,font:{size:15,color:"#000000"}},edges:{width:2,smooth:!1,color:{inherit:!1,color:"#ccc7c7"},arrows:{to:{enabled:!0,scaleFactor:.5}}},layout:{randomSeed:1,improvedLayout:!0},autoResize:!0,physics:{enabled:!0,barnesHut:{gravitationalConstant:-1e3,centralGravity:.3,springLength:100,springConstant:.04,damping:.09,avoidOverlap:1},forceAtlas2Based:{gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:1},repulsion:{centralGravity:1,springLength:0,springConstant:0,nodeDistance:0,damping:.09},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.1,solver:"forceAtlas2Based",stabilization:{enabled:!0,iterations:1e3,updateInterval:100,onlyDynamicEdges:!1,fit:!0},adaptiveTimestep:!1},interaction:{hover:!0}};var Yt=Object(K.withStyles)(function(e){return{graph:{width:"100%",height:"100%"}}})(Qt),Kt=a(92),Zt=a.n(Kt),Xt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime).valueOf(),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime).valueOf())},a.update=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=Object(R.a)(Object(R.a)(a)),s={queryStartTime:t.valueOf(),queryEndTime:n.valueOf()};e&&lt.showLoadingOverlay("Loading Cell Dependency Graph",o),_.callObservabilityAPI({url:"/dependency-model/cells/".concat(l).concat(_.generateQueryParamString(s)),method:"GET"},o).then(function(t){i.setState({data:{nodes:t.nodes,edges:t.edges}}),e&&lt.hideLoadingOverlay(o)}).catch(function(){e&&(lt.hideLoadingOverlay(o),lt.showNotification("Failed to load cell dependency view",lt.Levels.ERROR,o))})},a.onClickCell=function(e){},a.render=function(){var e,t=a.props,n=t.classes,r=t.cell,o=t.colorGenerator,l=a.state.data.nodes.length,i=a.state.data.nodes,s=a.state.data.edges;return e=l>1?z.a.createElement(zt,{title:"Unable to Render",description:"Unable to Render due to Invalid Data"},z.a.createElement(Yt,{id:"graph-id",nodeData:i,edgeData:s,selectedCell:r,onClickNode:a.onClickCell,viewGenerator:function(e,t){var a=Oe.shadeColor(o.getColor(e),t),n=Oe.shadeColor(a,-.08),l='<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 14 14">'+'<path fill="'.concat(a,'"  stroke="').concat(r===e?"#444":n,'" stroke-opacity="').concat(1-t,'" ')+' stroke-width="0.5px" d="M8.92.84H5a1.45,1.45,0,0,0-1,.42L1.22,4a1.43,1.43,0,0,0-.43,1V9a1.43,1.43,0,0,0,.43,1L4,12.75a1.4,1.4,0,0,0,1,.41H8.92a1.4,1.4,0,0,0,1-.41L12.72,10a1.46,1.46,0,0,0,.41-1V5a1.46,1.46,0,0,0-.41-1L9.94,1.25A1.44,1.44,0,0,0,8.92.84Z" transform="translate(-0.54 -0.37)"/></svg>';return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(l))},graphType:"dependency"})):z.a.createElement("div",null,z.a.createElement(Zt.a,{className:n.infoIcon,color:"action"}),z.a.createElement(Xe.a,{variant:"subtitle2",color:"textSecondary",className:n.info},'"'.concat(r,'"')," cell does not depend on any other Cell")),z.a.createElement("div",{className:n.dependencies},z.a.createElement(Xe.a,{color:"textSecondary",className:n.subtitle},"Dependencies"),z.a.createElement("div",{className:n.graphContainer},z.a.createElement("div",{className:n.diagram},e)))},a.state={data:{nodes:[],edges:[]}},a}return Object(l.a)(t,e),t}(z.a.Component),Jt=Object(K.withStyles)(function(e){return{subtitle:{fontWeight:400,fontSize:"1rem",display:"block"},dependencies:{marginTop:3*e.spacing.unit},graphContainer:{display:"flex"},diagram:{padding:3*e.spacing.unit,flexGrow:1},graph:{width:"100%",height:"100%"},info:{display:"inline-flex"},infoIcon:{verticalAlign:"middle",display:"inline-flex",fontSize:18,marginRight:4}}},{withTheme:!0})(at(le(Xt))),$t=a(71),ea=a.n($t),ta=a(72),aa=a.n(ta),na=a(34),ra=a.n(na),oa=a(60),la=a.n(oa),ia=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=Object(R.a)(Object(R.a)(a)),s={queryStartTime:t.valueOf(),queryEndTime:n.valueOf(),destinationCell:l};e&&(lt.showLoadingOverlay("Loading Cell Info",o),i.setState({isLoading:!0})),_.callObservabilityAPI({url:"/http-requests/cells/metrics/".concat(_.generateQueryParamString(s)),method:"GET"},o).then(function(t){var a=t.map(function(e){return{isError:"5xx"===e[1],count:e[5]}}).reduce(function(e,t){return t.isError&&(e.errorsCount+=t.count),e.total+=t.count,e},{errorsCount:0,total:0});i.setState({health:1-(0===a.total?a.errorsCount/a.total:0),isDataAvailable:a.total>0}),e&&(lt.hideLoadingOverlay(o),i.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),i.setState({isLoading:!1}),lt.showNotification("Failed to load cell information",lt.Levels.ERROR,o))})},a.render=function(){var e,t=a.props,n=t.classes,r=t.cell,o=a.state,l=o.health,i=o.isLoading,s=o.isDataAvailable;return e=s?z.a.createElement(ea.a,{className:n.table},z.a.createElement(aa.a,null,z.a.createElement(la.a,null,z.a.createElement(ra.a,{className:n.tableCell},z.a.createElement(Xe.a,{color:"textSecondary"},"Health")),z.a.createElement(ra.a,{className:n.tableCell},z.a.createElement(Bt,{value:l}))))):z.a.createElement(Z,{title:"Cell Not Found",description:'The "'.concat(r,'" cell not found. This is possibly ')+"because no requests had been received/sent by this cell in the selected time period"}),z.a.createElement(z.a.Fragment,null,i?null:e,s?z.a.createElement(Jt,{cell:r,className:n.root}):null)},a.state={isDataAvailable:!1,health:-1,dependencyGraphData:[],isLoading:!1},a}return Object(l.a)(t,e),t}(z.a.Component),sa=Object(K.withStyles)(function(){return{root:{display:"flex"},table:{width:"20%",marginTop:25},tableCell:{borderBottom:"none"}}})(at(le(ia))),ca=a(59),ua=a.n(ca),da=a(65),ma=a.n(da),pa=a(66),ga=a.n(pa),ha=a(82),fa=a.n(ha),va=a(83),Ea=a.n(va),ba=a(103),Ca=a.n(ba),Ta=a(50),Oa=a.n(Ta),Sa=a(250),ya=a.n(Sa),Na=a(251),La=a.n(Na),Ra=a(252),Ia=a.n(Ra),Aa=a(172),wa=a.n(Aa),Da=a(173),xa=a.n(Da),ja=a(174),ka=a.n(ja),Ma=a(175),_a=a.n(Ma),Pa=a(180),Ba=a.n(Pa),Fa=a(254),Ga=a.n(Fa),Ua=a(6),qa=a.n(Ua),Va=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.props.loadTracesOnMount&&a.loadTraces(!0)},a.handleChangeRowsPerPage=function(e){var t=e.target.value;a.setState({rowsPerPage:t})},a.handleChangePage=function(e,t){a.setState({page:t})},a.loadTracePage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";e.stopPropagation(),a.props.onTraceClick(t,n,r)},a.getColorForComponent=function(e){var t=a.props.colorGenerator,n=Oe.UNKNOWN;return e.cellName?n=e.cellName:J.System.GLOBAL_GATEWAY_NAME_PATTERN.test(e.serviceName)||J.System.ISTIO_MIXER_NAME_PATTERN.test(e.serviceName)?n=Oe.SYSTEM:e.serviceName&&(n=e.serviceName),t.getColor(n)},a.loadTraces=function(e){var t=Object(R.a)(Object(R.a)(a)),n=t.props,r=n.globalState,o=n.filter,l=n.globalFilterOverrides,s=o.cell,c=o.component,u=o.operation,d=o.tags,m=o.minDuration,p=o.minDurationMultiplier,g=o.maxDuration,h=o.maxDurationMultiplier,f={},v=function(e,t){t&&t!==J.Dashboard.ALL_VALUE&&(f[e]=t)};v("cell",s),v("serviceName",c),v("operationName",u),v("tags",JSON.stringify(d&&Object.keys(d).length>0?d:{})),v("minDuration",m*p),v("maxDuration",g*h),v("queryStartTime",l&&l.queryStartTime?l.queryStartTime.valueOf():ze.parseTime(r.get(ae.GLOBAL_FILTER).startTime).valueOf()),v("queryEndTime",l&&l.queryEndTime?l.queryEndTime.valueOf():ze.parseTime(r.get(ae.GLOBAL_FILTER).endTime).valueOf()),e&&(lt.showLoadingOverlay("Searching for Traces",r),t.setState({isLoading:!0})),_.callObservabilityAPI({url:"/traces/search".concat(_.generateQueryParamString(f)),method:"GET"},r).then(function(a){t.setState(function(e){return Object(i.a)({},e,{hasSearchCompleted:!0,searchResults:{rootSpans:a.rootSpans.map(function(e){return{traceId:e[0],rootCellName:e[1],rootServiceName:e[2],rootOperationName:e[3],rootStartTime:e[4],rootDuration:e[5]}}),spanCounts:a.spanCounts.map(function(e){return{traceId:e[0],cellName:e[1],serviceName:e[2],count:e[3]}})}})}),e&&(lt.hideLoadingOverlay(r),t.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(r),t.setState({isLoading:!1}),lt.showNotification("Failed to search for Traces",lt.Levels.ERROR,r))})},a.render=function(){var e=a.props,t=e.classes,n=e.hideTitle,r=a.state,o=r.rowsPerPage,l=r.page,s=r.hasSearchCompleted,c=r.isLoading,u=r.searchResults,d=u.rootSpans.reduce(function(e,t){return e[t.traceId]=Object(i.a)({},t),e},{}),m=u.spanCounts.reduce(function(e,t){return e[t.traceId]&&(e[t.traceId].services||(e[t.traceId].services=[]),e[t.traceId].services.push(Object(i.a)({},t))),e},d),p=[];for(var g in m)m.hasOwnProperty(g)&&p.push(m[g]);return s&&!c?p.length>0?z.a.createElement(z.a.Fragment,null,n?null:z.a.createElement(Xe.a,{variant:"h6",color:"inherit",className:t.subheading},"Traces"),p.slice(l*o,l*o+o).map(function(e){return z.a.createElement(Ge.a,{key:e.traceId,className:t.trace,onClick:function(t){return a.loadTracePage(t,e.traceId)}},z.a.createElement(D.a,{container:!0,className:t.traceHeader},z.a.createElement(D.a,{item:!0,xs:8},e.rootCellName?z.a.createElement("span",{className:t.cellName},"".concat(e.rootCellName,":")):null,z.a.createElement("span",{className:t.serviceName},e.rootServiceName),z.a.createElement("span",{className:t.operationName},e.rootOperationName)),z.a.createElement(D.a,{item:!0,xs:4,className:t.traceHeaderRight},z.a.createElement("span",null,e.services.reduce(function(e,t){return e+t.count},0)," Spans"),z.a.createElement("span",{className:t.rootStartTime},ee()(e.rootStartTime).format(J.Pattern.DATE_TIME)),z.a.createElement("span",{className:t.durationIcon},z.a.createElement(Ba.a,{varient:"inherit",fontSize:"small"})),z.a.createElement("span",{className:t.duration},e.rootDuration/1e3," s"))),z.a.createElement("div",{className:t.traceContent},e.services.sort(function(e,t){return e.serviceName<t.serviceName?-1:e.serviceName>t.serviceName?1:0}).map(function(n){return z.a.createElement("div",{key:"".concat(n.cellName,"-").concat(n.serviceName),className:t.serviceTag,onClick:function(t){return a.loadTracePage(t,e.traceId,n.cellName,n.serviceName)}},z.a.createElement("div",{className:t.serviceTagColor,style:{backgroundColor:a.getColorForComponent(n)}}),z.a.createElement("div",{className:t.serviceTagContent},z.a.createElement("span",{className:t.tagCellName},n.cellName?"".concat(n.cellName,": "):null," "),z.a.createElement("span",{className:t.tagServiceName},n.serviceName," (",n.count,")")))})))}),z.a.createElement(Ga.a,{component:"div",count:p.length,rowsPerPage:o,backIconButtonProps:{"aria-label":"Previous Page"},page:l,labelRowsPerPage:"Traces Per Page",onChangePage:a.handleChangePage,nextIconButtonProps:{"aria-label":"Next Page"},onChangeRowsPerPage:a.handleChangeRowsPerPage})):z.a.createElement(Z,{title:"No Traces Found",description:"No Traces matching the above specifications were found"}):null},a.state={rowsPerPage:5,page:0,hasSearchCompleted:!1,isLoading:!1,searchResults:{rootSpans:[],spanCounts:[]}},a}return Object(l.a)(t,e),t}(z.a.PureComponent),za=qa()(function(e){return{trace:{cursor:"pointer",marginTop:2*e.spacing.unit,marginRight:0,marginBottom:2*e.spacing.unit,marginLeft:0},traceHeader:{backgroundColor:"#dfdfdf",padding:e.spacing.unit},traceHeaderRight:{fontWeight:400,fontSize:"small",textAlign:"right"},cellName:{fontWeight:500,fontSize:"normal"},serviceName:{fontWeight:500,fontSize:"normal",paddingRight:e.spacing.unit},operationName:{color:"#616161",fontSize:"small"},rootStartTime:{fontWeight:300,color:"#616161",marginLeft:e.spacing.unit,fontSize:"normal"},duration:{color:"#444",fontStyle:"italic",padding:Number(e.spacing.unit)/2},durationIcon:{verticalAlign:"-webkit-baseline-middle",paddingLeft:2*e.spacing.unit,color:"#666"},tagCellName:{color:"#666",paddingLeft:Number(e.spacing.unit)/2},tagServiceName:{color:"#222"},traceContent:{padding:e.spacing.unit},serviceTag:{borderStyle:"solid",borderWidth:"thin",borderColor:"#c9c9c9",margin:e.spacing.unit,display:"inline-block"},serviceTagColor:{height:"100%",width:e.spacing.unit,display:"table-cell"},serviceTagContent:{padding:e.spacing.unit,display:"table-cell",fontSize:12}}})(at(le(Va))),Ha=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.onTraceClick=function(e){window.open("/tracing/id/".concat(e))},a.render=function(){var e=a.props,t=e.classes,n=e.selectedArea,r=e.filter,o=a.state.open,l={queryStartTime:ee()(n.left),queryEndTime:ee()(n.right)};return z.a.createElement(wa.a,{fullWidth:!0,maxWidth:"lg",open:o,onClose:a.handleClose,"aria-labelledby":"max-width-dialog-title"},z.a.createElement(_a.a,{id:"max-width-dialog-title"},"Traces ",z.a.createElement("span",{className:t.subTitle},z.a.createElement("span",{className:t.light}," From")," ",n?l.queryStartTime.format(J.Pattern.PRECISE_DATE_TIME):null,z.a.createElement("span",{className:t.light}," to")," ",n?l.queryEndTime.format(J.Pattern.PRECISE_DATE_TIME):null)," "),z.a.createElement(ka.a,null,z.a.createElement(za,{onTraceClick:a.onTraceClick,filter:r,globalFilterOverrides:l,loadTracesOnMount:!0,hideTitle:!0})),z.a.createElement(xa.a,null,z.a.createElement(G.a,{onClick:a.handleClose,color:"primary"},"Close")))},a.state={open:!1},a}return Object(l.a)(t,e),t}(z.a.Component),Wa=Object(K.withStyles)(function(e){return{subTitle:{marginLeft:e.spacing.unit,marginTop:1.5*e.spacing.unit,color:"#666",fontSize:14},light:{color:"#999",fontStyle:"Italic"}}})(Ha),Qa=a(27),Ya=Object(Qa.n)(Qa.l),Ka=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).render=function(){var e=a.props,t=e.classes,n=e.traceSearchFilter,r=e.title,o=e.data,l=e.yAxis,s=a.state,c=s.lastDrawArea,u=s.tooltipData;return z.a.createElement(ya.a,{className:t.card},z.a.createElement(Ia.a,{title:r,className:t.cardHeader,classes:{title:t.title,action:t.cardActions},action:z.a.createElement(z.a.Fragment,null,c?z.a.createElement(z.a.Fragment,null,z.a.createElement(Ke.a,{title:"View traces for the selected time range"},z.a.createElement(G.a,{className:t.viewTracesButton,variant:"outlined",onClick:a.handleClickOpen},z.a.createElement(St.a,{color:"action"}),z.a.createElement("span",{className:t.viewTracesContent},"View Traces"))),z.a.createElement(Wa,{filter:n,innerRef:a.traceDialogRef,selectedArea:c})):null,z.a.createElement(Ke.a,{title:"Click and drag in the plot area to zoom in, click anywhere in the graph to zoom out."},z.a.createElement(Zt.a,{className:t.infoIcon})))}),z.a.createElement(La.a,null,z.a.createElement("div",null,z.a.createElement(Ya,{xType:"time",height:400,animation:!0,xDomain:c?[c.left,c.right]:null,onMouseLeave:function(){return a.setState({tooltipData:[]})}},z.a.createElement(Qa.g,null),z.a.createElement(Qa.j,null),z.a.createElement(Qa.k,{title:"Time"}),z.a.createElement(Qa.m,{title:"".concat(l.title," (").concat(l.unit,")")}),o.map(function(e){return z.a.createElement(Qa.h,{key:e.title,color:e.color,size:3,data:e.points.map(function(e){return{x:e.timestamp,y:e.value}}),onNearestX:function(e,t){var n=t.index;return a.setState({tooltipData:o.map(function(e){return Object(i.a)({},e.points[n],{name:e.title})})})}})}),u.length>0?z.a.createElement(Qa.b,{values:u.map(function(e){return{x:e.timestamp,y:e.value}})},z.a.createElement("div",{className:"rv-hint__content"},z.a.createElement("div",{className:t.toolTipHead},"".concat(ee()(u[0].timestamp).format(J.Pattern.DATE_TIME))),u.map(function(e){return z.a.createElement("div",{key:e.name},"".concat(e.name,":\n                                                                    ").concat(Math.round(e.value)," ").concat(l.unit))}))):null,z.a.createElement(Qa.d,{enableY:!1,onBrushEnd:function(e){return a.setState({lastDrawArea:e})},onDrag:function(e){a.setState({lastDrawArea:{bottom:c.bottom+(e.top-e.bottom),left:c.left-(e.right-e.left),right:c.right-(e.right-e.left),top:c.top+(e.top-e.bottom)}})}})),z.a.createElement(Qa.c,{orientation:"horizontal",items:o.map(function(e){return{title:e.title,color:e.color}})}))))},a.handleClickOpen=function(){a.traceDialogRef.current&&a.traceDialogRef.current.handleClickOpen&&a.traceDialogRef.current.handleClickOpen()},a.state={tooltipData:[],lastDrawArea:null},a.traceDialogRef=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.Component),Za=Object(K.withStyles)(function(e){return{cardHeader:{borderBottom:"1px solid #eee",paddingTop:e.spacing.unit,paddingBottom:e.spacing.unit},title:{fontSize:16,fontWeight:500,color:"#4d4d4d"},viewTracesButton:{fontSize:12,verticalAlign:"middle",marginRight:e.spacing.unit},viewTracesContent:{paddingLeft:e.spacing.unit},infoIcon:{color:"#999",marginRight:27,fontSize:18,verticalAlign:"middle"},card:{boxShadow:"none",border:"1px solid #eee"},cardActions:{marginTop:e.spacing.unit/4},toolTipHead:{fontWeight:600}}})(Ka),Xa=a(26),Ja=a.n(Xa),$a=Object(Qa.n)(Qa.l),en=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).calculateMetrics=function(){var e=a.props,t=e.colorGenerator,n=e.data,r=e.direction,o=t.getColor(Oe.SUCCESS),l=t.getColor(Oe.ERROR),i=0,s=0,c=0,u=Number.MAX_SAFE_INTEGER,d=0,m={"2xx":0,"3xx":0,"4xx":0,"5xx":0},p=!0,g=!1,h=void 0;try{for(var f,v=n[Symbol.iterator]();!(p=(f=v.next()).done);p=!0){var E=f.value;i+=E.requestCount,c+=E.totalResponseTimeMilliSec,m[E.httpResponseGroup]+=E.requestCount,"5xx"===E.httpResponseGroup&&(s+=E.requestCount),E.timestamp<u&&(u=E.timestamp),E.timestamp>d&&(d=E.timestamp)}}catch(I){g=!0,h=I}finally{try{p||null==v.return||v.return()}finally{if(g)throw h}}var b=d>u?d-u:0,C=0===i?0:100*s/i,T=0===i?0:100*(i-s)/i,O=[];C>0&&O.push({title:"Error",count:s,percentage:C,color:l}),T>0&&O.push({title:"Success",count:i-s,percentage:T,color:o});var S=["2xx","3xx","4xx","5xx"].map(function(e){return{x:0===i?0:100*m[e]/i,y:r,title:"2xx"===e?"OK":e,count:m[e]}}),y=a.generateTimeSeriesDataSet(),N=y.map(function(e){return{timestamp:e.timestamp,value:e.requestCount}}),L=y.map(function(e){return{timestamp:e.timestamp,value:0===e.requestCount?0:e.totalResponseTimeMilliSec/e.requestCount}}),R=[{name:"Request",data:y.map(function(e){return{timestamp:e.timestamp,value:0===e.requestCount?0:e.totalRequestSizeBytes/e.requestCount}}),color:"#5bbd5a"},{name:"Response",data:y.map(function(e){return{timestamp:e.timestamp,value:0===e.requestCount?0:e.totalResponseSizeBytes/e.requestCount}}),color:"#76c7e3"}];return{totalResponseTime:c,totalRequestsCount:i,timeRange:b,statusData:O,trafficData:S,reqVolumeData:N,reqDurationData:L,reqResSizeData:R}},a.render=function(){var e=a.props,t=e.classes,n=e.colorGenerator,r=e.cell,o=e.component,l=a.state,i=l.statusTooltip,s=l.trafficTooltip,c=n.getColor(Oe.SUCCESS),u=n.getColor(Oe.ERROR),d=n.getColor(Oe.WARNING),m=n.getColor(Oe.CLIENT_ERROR),p=[c,m,d,u],g=a.calculateMetrics(),h=g.timeRange,f=g.statusData,v=g.trafficData,E=g.reqVolumeData,b=g.reqDurationData,C=g.reqResSizeData,T=g.totalRequestsCount,O=g.totalResponseTime,S={cell:r,component:o};return z.a.createElement("div",{className:t.root},z.a.createElement(Oa.a,{container:!0,spacing:24},z.a.createElement(Oa.a,{item:!0,md:3,sm:6,xs:12},z.a.createElement(fa.a,{className:t.card},z.a.createElement(Ca.a,{title:"Success / Failure Rate",className:t.cardHeader,classes:{title:t.title}}),z.a.createElement(Ea.a,{className:t.content,align:"center"},z.a.createElement(Qa.i,{innerRadius:60,radius:85,width:180,height:180,colorType:"literal",getAngle:function(e){return e.percentage},onValueMouseOver:function(e){return a.setState({statusTooltip:e})},onSeriesMouseOut:function(){return a.setState({statusTooltip:!1})},data:f},i?z.a.createElement(Qa.e,{value:i},z.a.createElement("div",{className:"rv-hint__content"},"".concat(i.title," :\n                                                            ").concat(Math.round(i.percentage),"%\n                                                            (").concat(i.count," Requests)"))):null),z.a.createElement("div",null,z.a.createElement(Qa.c,{items:f.map(function(e){return e.title}),colors:f.map(function(e){return e.color}),orientation:"horizontal"}))))),z.a.createElement(Oa.a,{container:!0,item:!0,md:3,sm:6,xs:12,alignItems:"center"},z.a.createElement(Oa.a,{item:!0,sm:12},z.a.createElement(fa.a,{className:t.card},z.a.createElement(Ca.a,{title:"Average Response Time",className:t.cardHeader,classes:{title:t.title}}),z.a.createElement(Ea.a,{align:"center"},z.a.createElement(Ja.a,{className:t.cardDetails},0===T?0:Math.round(O/T)),z.a.createElement(Ja.a,{color:"textSecondary",className:t.cardDetailsSecondary},"ms")))),z.a.createElement(Oa.a,{item:!0,sm:12,className:t.contentGrid},z.a.createElement(fa.a,{className:t.card},z.a.createElement(Ca.a,{title:"Average Request Count",className:t.cardHeader,classes:{title:t.title}}),z.a.createElement(Ea.a,{align:"center"},z.a.createElement(Ja.a,{className:t.cardDetails},0===h?0:Math.round(1e3*T*100/h)/100),z.a.createElement(Ja.a,{color:"textSecondary",className:t.cardDetailsSecondary},"Requests/s"))))),z.a.createElement(Oa.a,{item:!0,md:6,sm:12,xs:12},z.a.createElement(fa.a,{className:t.card},z.a.createElement(Ca.a,{title:"HTTP Traffic",className:t.cardHeader,classes:{title:t.title}}),z.a.createElement(Ea.a,{className:t.content},z.a.createElement("div",null,z.a.createElement($a,{yType:"ordinal",stackBy:"x",height:100,className:t.barChart},z.a.createElement(Qa.j,null),z.a.createElement(Qa.g,null),z.a.createElement(Qa.k,null),z.a.createElement(Qa.m,null),z.a.createElement(Qa.a,{text:"%",className:"alt-x-label",includeMargin:!1,xPercent:-.04,yPercent:1.61}),v.map(function(e,t){return z.a.createElement(Qa.f,{key:e.title,data:[e],color:p[t],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}})}),s?z.a.createElement(Qa.e,{value:s},z.a.createElement("div",{className:"rv-hint__content"},"".concat(s.title," : ").concat(Math.round(s.x),"%\n                                                            (").concat(s.count," Requests)"))):null),z.a.createElement(Qa.c,{orientation:"horizontal",items:[{title:"OK",color:c},{title:"3xx",color:d},{title:"4xx",color:m},{title:"5xx",color:u}]}))))),z.a.createElement(Oa.a,{item:!0,sm:12},z.a.createElement(Za,{title:"Request Volume",traceSearchFilter:S,data:[{title:"Request",points:E,color:"#12939a"}],yAxis:{title:"Volume",unit:"Ops / s"}})),z.a.createElement(Oa.a,{item:!0,sm:12},z.a.createElement(Za,{title:"Request Duration",traceSearchFilter:S,data:[{title:"Request",points:b,color:"#3f51b5"}],yAxis:{title:"Duration",unit:"ms"}})),z.a.createElement(Oa.a,{item:!0,sm:12},z.a.createElement(Za,{title:"Request/Response Size",traceSearchFilter:S,data:C.map(function(e){return{title:e.name,points:e.data,color:e.color}}),yAxis:{title:"Size",unit:"Bytes"}}))))},a.generateTimeSeriesDataSet=function(){for(var e=a.props,t=e.globalState,n=e.data,r=[],o=0,l=null,i=0;i<n.length;i++){var s=n[i];s.timestamp===o?(l.totalRequestSizeBytes+=s.totalRequestSizeBytes,l.totalResponseSizeBytes+=s.totalResponseSizeBytes,l.totalResponseTimeMilliSec+=s.totalResponseTimeMilliSec,l.requestCount+=s.requestCount):(l&&r.push(l),o=s.timestamp,l={timestamp:s.timestamp,totalRequestSizeBytes:s.totalRequestSizeBytes,totalResponseSizeBytes:s.totalResponseSizeBytes,totalResponseTimeMilliSec:s.totalResponseTimeMilliSec,requestCount:s.requestCount})}var c=[],u=function(e){c.push({timestamp:e,totalRequestSizeBytes:0,totalResponseSizeBytes:0,totalResponseTimeMilliSec:0,requestCount:0})};u(ze.parseTime(t.get(ae.GLOBAL_FILTER).startTime).valueOf());for(var d=0;d<r.length;d++){var m=r[d];(0===d||c[c.length-1].timestamp<m.timestamp-1e3)&&u(m.timestamp-1e3),c.push(m),(d===r.length-1||r[d+1].timestamp>m.timestamp+1e3)&&u(m.timestamp+1e3)}return u(ze.parseTime(t.get(ae.GLOBAL_FILTER).endTime).valueOf()),c},a.state={statusTooltip:!1,trafficTooltip:!1},a}return Object(l.a)(t,e),t}(z.a.Component),tn=Object(K.withStyles)(function(e){return{root:{flexGrow:1},card:{boxShadow:"none",border:"1px solid #eee"},cardHeader:{borderBottom:"1px solid #eee",paddingTop:e.spacing.unit,paddingBottom:e.spacing.unit},title:{fontSize:16,fontWeight:500,color:"#4d4d4d"},cardDetails:{fontSize:28,display:"inline-block"},cardDetailsSecondary:{fontSize:16,display:"inline-block",paddingLeft:5},contentGrid:{marginTop:48},barChart:{marginTop:40,marginBottom:40}}})(at(le(en))),an=a(67),nn=a.n(an),rn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n,r,o){var l=a.state,i=l.selectedType,s=l.selectedCell,c=t.valueOf(),u=n.valueOf();a.loadMetrics(e,c,u,r||i,o||s),a.loadCellMetadata(e,c,u)},a.getFilterChangeHandler=function(e){return function(t){var n=a.props,r=n.globalState,o=n.onFilterUpdate,l=a.state,i=l.selectedType,s=l.selectedCell,c=t.target.value;a.setState(Object(C.a)({},e,c)),o&&o(Object(C.a)({selectedType:i,selectedCell:s},e,c)),a.update(!0,ze.parseTime(r.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(r.get(ae.GLOBAL_FILTER).endTime),"selectedType"===e?c:null,"selectedCell"===e?c:null)}},a.loadCellMetadata=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=Object(R.a)(Object(R.a)(a)),s={queryStartTime:t,queryEndTime:n};e&&(lt.showLoadingOverlay("Loading Cell Info",o),i.setState(function(e){return{loadingCount:e.loadingCount+1}})),_.callObservabilityAPI({url:"/http-requests/cells/metadata".concat(_.generateQueryParamString(s)),method:"GET"},o).then(function(t){i.setState({cells:t.filter(function(e){return Boolean(e)&&e!==l})}),e&&(lt.hideLoadingOverlay(o),i.setState(function(e){return{loadingCount:e.loadingCount-1}}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),i.setState(function(e){return{loadingCount:e.loadingCount-1}}),lt.showNotification("Failed to load cell information",lt.Levels.ERROR,o))})},a.loadMetrics=function(e,t,n,r,o){var l=a.props,i=l.globalState,s=l.cell,c=Object(R.a)(Object(R.a)(a)),u={queryStartTime:t,queryEndTime:n};o!==J.Dashboard.ALL_VALUE&&(r===J.Dashboard.INBOUND?u.sourceCell=o:u.destinationCell=o),r===J.Dashboard.INBOUND?u.destinationCell=s:u.sourceCell=s,e&&(lt.showLoadingOverlay("Loading Cell Metrics",i),c.setState(function(e){return{loadingCount:e.loadingCount+1}})),_.callObservabilityAPI({url:"/http-requests/cells/metrics".concat(_.generateQueryParamString(u)),method:"GET"},i).then(function(t){var a=t.map(function(e){return{timestamp:e[0],httpResponseGroup:e[1],totalResponseTimeMilliSec:e[2],totalRequestSizeBytes:e[3],totalResponseSizeBytes:e[4],requestCount:e[5]}});c.setState({cellData:a}),e&&(lt.hideLoadingOverlay(i),c.setState(function(e){return{loadingCount:e.loadingCount-1}}))}).catch(function(){e&&(lt.hideLoadingOverlay(i),c.setState(function(e){return{loadingCount:e.loadingCount-1}}),lt.showNotification("Failed to load cell metrics",lt.Levels.ERROR,i))})},a.render=function(){var e=a.props,t=e.classes,n=e.cell,r=a.state,o=r.selectedType,l=r.selectedCell,i=r.cells,s=r.cellData,c=r.loadingCount,u=o===J.Dashboard.INBOUND?"Source":"Target";return c>0?null:z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:t.filters},z.a.createElement(ma.a,{className:t.formControl},z.a.createElement(ga.a,{htmlFor:"selected-type"},"Type"),z.a.createElement(nn.a,{value:o,onChange:a.getFilterChangeHandler("selectedType"),inputProps:{name:"selected-type",id:"selected-type"}},z.a.createElement("option",{value:J.Dashboard.INBOUND},"Inbound"),z.a.createElement("option",{value:J.Dashboard.OUTBOUND},"Outbound"))),z.a.createElement(ma.a,{className:t.formControl},z.a.createElement(ga.a,{htmlFor:"selected-cell"},u," Cell"),z.a.createElement(nn.a,{value:l,onChange:a.getFilterChangeHandler("selectedCell"),inputProps:{name:"selected-cell",id:"selected-cell"}},z.a.createElement("option",{value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),i.map(function(e){return z.a.createElement("option",{key:e,value:e},e)})))),z.a.createElement("div",{className:t.graphs},s.length>0?z.a.createElement(tn,{cell:n,data:s,direction:o===J.Dashboard.INBOUND?"In":"Out"}):z.a.createElement(Z,{title:"No Metrics Found",description:o===J.Dashboard.INBOUND?'No Requests from the selected cell to "'.concat(n,'" cell'):'No Requests from "'.concat(n,'" cell to the selected cell')})))},a.state={selectedType:e.globalFilterOverrides&&e.globalFilterOverrides.selectedType?e.globalFilterOverrides.selectedType:J.Dashboard.INBOUND,selectedCell:e.globalFilterOverrides&&e.globalFilterOverrides.selectedCell?e.globalFilterOverrides.selectedCell:J.Dashboard.ALL_VALUE,cells:[],cellData:[],loadingCount:0},a}return Object(l.a)(t,e),t}(z.a.Component),on=Object(K.withStyles)(function(e){return{filters:{marginTop:4*e.spacing.unit,marginBottom:4*e.spacing.unit},formControl:{marginRight:4*e.spacing.unit,minWidth:150},graphs:{marginBottom:4*e.spacing.unit},button:{marginTop:2*e.spacing.unit}}})(le(rn)),ln=a(53),sn=a.n(ln),cn=a(91),un=a.n(cn),dn=a(58),mn=a.n(dn),pn=a(181),gn=a.n(pn),hn=(a(5762),a(249)),fn=a.n(hn),vn=a(100),En=a.n(vn),bn=a(255),Cn=a.n(bn),Tn=a(101),On=a.n(Tn),Sn=a(49),yn=a.n(Sn),Nn=a(247),Ln=a.n(Nn),Rn=a(75),In=a.n(Rn),An=a(124),wn=a.n(An),Dn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).DEFAULT_RANGES={LAST_MIN:{name:"Last min",from:"now - 1 minute"},LAST_5_MINS:{name:"Last 5 mins",from:"now - 5 minutes"},LAST_10_MINS:{name:"Last 10 mins",from:"now - 10 minutes"},LAST_30_MINS:{name:"Last 30 mins",from:"now - 30 minutes"},LAST_1_HOUR:{name:"Last hour",from:"now - 1 hour"},LAST_3_HOURS:{name:"Last 2 hours",from:"now - 2 hours"},LAST_6_HOURS:{name:"Last 6 hours",from:"now - 6 hours"},LAST_12_HOURS:{name:"Last 12 hours",from:"now - 12 hours"},LAST_24_HOURS:{name:"Last 24 hours",from:"now - 24 hours"},LAST_7_DAYS:{name:"Last 7 days",from:"now - 7 days"},LAST_30_DAYS:{name:"Last 30 days",from:"now - 30 days"}},a.DATE_RANGE_FROM="DATE_RANGE_FROM",a.DATE_RANGE_TO="DATE_RANGE_TO",a.render=function(){var e,t,n,r,o=a.props.classes,l=a.state,i=l.isRangeFromCalendarOpen,s=l.isRangeToCalendarOpen,c=l.isRangeToNow,u=l.startTime,d=l.endTime,m=l.dateRangeNickname,p=l.lastFocussedDateRangeInput;try{e=ze.parseTime(u)}catch(f){e=void 0}try{t=ze.parseTime(d)}catch(f){t=void 0}if(e&&t){if(u.includes("now")&&!d.includes("now")){var g="Date range cannot be selected from a relative time to a absolute time";p===a.DATE_RANGE_FROM?n=g:p===a.DATE_RANGE_TO&&(r=g)}else if(e.isAfter(t)){var h="Date range cannot be from a later time to a earlier time";p===a.DATE_RANGE_FROM?n=h:p===a.DATE_RANGE_TO&&(r=h)}}else e||(n="Invalid time"),t||(r="Invalid time");return z.a.createElement("div",{className:o.dateRangePopOver},z.a.createElement(D.a,{container:!0},z.a.createElement(D.a,{item:!0,xs:8,className:o.customRangeContainer},z.a.createElement(Xe.a,{variant:"subtitle2"},"Custom Range"),z.a.createElement(On.a,{className:o.dateRangesTitleDivider}),z.a.createElement(D.a,{container:!0},z.a.createElement(D.a,{item:!0,xs:2,className:o.customDateRangeInputLabel},z.a.createElement(In.a,null,"From")),z.a.createElement(D.a,{item:!0,xs:7},z.a.createElement(yn.a,{className:o.formControl,fullWidth:!0},z.a.createElement(wn.a,{error:Boolean(n),value:u,onFocus:a.onFromDateRangeInputFocus,onChange:a.getCustomDateRangeInputChangeHandler("startTime"),helperText:n})),z.a.createElement(En.a,{in:i,className:o.collapsible},z.a.createElement(Cn.a,{input:!1,value:e,onChange:a.getCustomCalendarChangeHandler("startTime")})))),z.a.createElement(D.a,{container:!0},z.a.createElement(D.a,{item:!0,xs:2,className:o.customDateRangeInputLabel},z.a.createElement(In.a,null,"To")),z.a.createElement(D.a,{item:!0,xs:7},z.a.createElement(yn.a,{className:o.formControl,fullWidth:!0},z.a.createElement(wn.a,{error:Boolean(r),value:d,onFocus:a.onToDateRangeInputFocus,onChange:a.getCustomDateRangeInputChangeHandler("endTime"),helperText:r})),z.a.createElement(En.a,{in:s},z.a.createElement(Cn.a,{input:!1,value:t,onChange:a.getCustomCalendarChangeHandler("endTime")}))),z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(Ln.a,{className:o.isRangeToNowCheckbox,control:z.a.createElement(fn.a,{checked:c,onChange:a.onIsRangeToNowCheckBoxClick,value:"isRangeToNow",color:"default"}),label:"now"}))),z.a.createElement(D.a,{container:!0},z.a.createElement(D.a,{item:!0,xs:2}),z.a.createElement(D.a,{item:!0,xs:10},z.a.createElement(G.a,{variant:"outlined",size:"small",color:"primary",disabled:Boolean(n||r),className:o.customRangeApplyButton,onClick:a.onCustomRangeApply},"Apply")))),z.a.createElement(D.a,{item:!0,xs:4,className:o.defaultRangesContainer},z.a.createElement(Xe.a,{variant:"subtitle2"},"Default Ranges"),z.a.createElement(On.a,{className:o.dateRangesTitleDivider}),Object.keys(a.DEFAULT_RANGES).map(function(e){var t,n=a.DEFAULT_RANGES[e].name;return z.a.createElement(Xe.a,{key:e,className:$e()((t={},Object(C.a)(t,o.defaultRange,!0),Object(C.a)(t,o.selectedDefaultRange,n===m),t)),onClick:a.getDefaultRangeClickEventHandler(e)},n)}))))},a.getCustomDateRangeInputChangeHandler=function(e){var t=Object(R.a)(Object(R.a)(a));return function(a){var n=a.target.value;t.setState(function(t){var a;return a={},Object(C.a)(a,e,n),Object(C.a)(a,"isRangeToNow","endTime"===e?"now"===n.trim():t.isRangeToNow),a})}},a.getCustomCalendarChangeHandler=function(e){var t=Object(R.a)(Object(R.a)(a));return function(a){t.setState(function(t){var n;return n={},Object(C.a)(n,e,a.format(J.Pattern.DATE_TIME)),Object(C.a)(n,"isRangeToNow","endTime"!==e&&t.isRangeToNow),n})}},a.getDefaultRangeClickEventHandler=function(e){var t=Object(R.a)(Object(R.a)(a));return function(){var n=a.DEFAULT_RANGES[e].from,r=a.DEFAULT_RANGES[e].name;t.setState({isRangeToNow:!0,isRangeFromCalendarOpen:!1,isRangeToCalendarOpen:!1,startTime:n,endTime:"now",dateRangeNickname:r,lastFocussedDateRangeInput:void 0}),a.applyDateRange(n,"now",r)}},a.onCustomRangeApply=function(){a.applyDateRange()},a.onIsRangeToNowCheckBoxClick=function(e){var t=e.target.checked;a.setState(function(e){return{isRangeToNow:t,endTime:t?"now":e.endTime}})},a.onFromDateRangeInputFocus=function(){a.setState({isRangeFromCalendarOpen:!0,isRangeToCalendarOpen:!1,lastFocussedDateRangeInput:a.DATE_RANGE_FROM})},a.onToDateRangeInputFocus=function(){a.setState({isRangeFromCalendarOpen:!1,isRangeToCalendarOpen:!0,lastFocussedDateRangeInput:a.DATE_RANGE_TO})},a.applyDateRange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=a.props,o=r.onRangeChange,l=r.history,s=r.location,c=r.match,u=a.state,d=u.startTime,m=u.endTime,p=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(s.search),{globalFilterStartTime:void 0,globalFilterEndTime:void 0}));l.replace(c.url+p,Object(i.a)({},s.state)),o(e||d,t||m,n||null)},a.state={isRangeFromCalendarOpen:!1,isRangeToCalendarOpen:!1,isRangeToNow:"now"===e.endTime.trim(),startTime:e.startTime,endTime:e.endTime,dateRangeNickname:e.dateRangeNickname,lastFocussedDateRangeInput:void 0},a}return Object(l.a)(t,e),t}(z.a.Component),xn=Object(K.withStyles)(function(e){return{dateRangePopOver:{width:700,padding:2*e.spacing.unit},dateRangesTitleDivider:{marginBottom:2*e.spacing.unit},customRangeContainer:{padding:2*e.spacing.unit,borderRightStyle:"solid",borderRightColor:"#d0d0d0",borderRightWidth:2},customDateRangeInputLabel:{paddingTop:e.spacing.unit,paddingLeft:e.spacing.unit,paddingBottom:e.spacing.unit},customRangeApplyButton:{marginTop:2*e.spacing.unit},isRangeToNowCheckbox:{marginLeft:.5*e.spacing.unit},defaultRangesContainer:{padding:2*e.spacing.unit},defaultRange:{cursor:"pointer",padding:.5*e.spacing.unit},selectedDefaultRange:{fontWeight:500,color:e.palette.primary.main},formControl:{marginBottom:2*e.spacing.unit},collapsible:{marginBottom:15}}},{withTheme:!0})(Object(Y.a)(Dn)),jn=a(123),kn=a.n(jn),Mn=a(116),_n=a.n(Mn),Pn=a(182),Bn=a.n(Pn),Fn=a(74),Gn=a.n(Fn),Un=a(99),qn=a.n(Un),Vn=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.refreshManually()},a.componentDidUpdate=function(){a.startRefreshTask()},a.componentWillUnmount=function(){a.stopRefreshTask()},a.render=function(){var e=a.props,t=e.classes,n=e.title,r=e.subTitle,o=e.location,l=e.history,i=e.onUpdate,s=a.state,c=s.startTime,u=s.endTime,d=s.dateRangeNickname,m=s.refreshInterval,p=s.dateRangeSelectorAnchorElement,g=s.isAutoRefreshEnabled,h=Boolean(p);return z.a.createElement("div",{className:t.container},z.a.createElement(Qe.a,{disableGutters:!0},o.state&&o.state.hideBackButton||l.length<=1||"/"===o.pathname?null:z.a.createElement(we.a,{className:t.menuButton,color:"inherit","aria-label":"Back",onClick:function(){return l.goBack()}},z.a.createElement(B.a,null)),z.a.createElement(Xe.a,{variant:"h5",color:"inherit",className:t.title},n),r?z.a.createElement(Xe.a,{variant:"subtitle1",className:t.subTitle},r):null,z.a.createElement("div",{className:t.grow}),i?z.a.createElement(z.a.Fragment,null,z.a.createElement(mn.a,{"aria-owns":h?"date-range-picker-popper":void 0,className:t.dateRangeButton,"aria-haspopup":"true",size:"small",variant:"text",onClick:function(e){return a.openDateRangeSelector(e.currentTarget)}},d||z.a.createElement(z.a.Fragment,null,z.a.createElement(Xe.a,{color:"textSecondary"},"From"),z.a.createElement(Xe.a,{className:t.dateRangeNicknameSelectedTime},c),z.a.createElement(Xe.a,{color:"textSecondary"},"To"),z.a.createElement(Xe.a,{className:t.dateRangeNicknameSelectedTime},u)),z.a.createElement(gn.a,{color:"action",className:t.calendar})),z.a.createElement(_n.a,{id:"date-range-picker-popper",open:h,anchorEl:p,onClose:a.closeDateRangeSelector,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},z.a.createElement(xn,{startTime:c,endTime:u,dateRangeNickname:d,onRangeChange:a.setTimePeriod})),g?z.a.createElement(z.a.Fragment,null,z.a.createElement(yn.a,null,z.a.createElement(Gn.a,{value:m,onChange:a.setRefreshInterval,inputProps:{name:"refresh-interval",id:"refresh-interval"},startAdornment:z.a.createElement(kn.a,{className:t.startInputAdornment,variant:"filled",position:"start"},"Refresh"),className:t.refreshTimeSelect},z.a.createElement(Be.a,{value:-1},"Off"),z.a.createElement(Be.a,{value:5e3},"Every 5 sec"),z.a.createElement(Be.a,{value:1e4},"Every 10 sec"),z.a.createElement(Be.a,{value:15e3},"Every 15 sec"),z.a.createElement(Be.a,{value:3e4},"Every 30 sec"),z.a.createElement(Be.a,{value:6e4},"Every 1 min"),z.a.createElement(Be.a,{value:3e5},"Every 5 min"))),z.a.createElement(qn.a,{title:"Refresh Now"},z.a.createElement(we.a,{"aria-label":"Refresh",onClick:a.refreshManually},z.a.createElement(Bn.a,null)))):null):null))},a.openDateRangeSelector=function(e){a.setState({dateRangeSelectorAnchorElement:e})},a.closeDateRangeSelector=function(){a.setState({dateRangeSelectorAnchorElement:void 0})},a.setTimePeriod=function(e,t,n){var r=a.props.globalState;r.set(ae.GLOBAL_FILTER,Object(i.a)({},r.get(ae.GLOBAL_FILTER),{startTime:e,endTime:t,dateRangeNickname:n})),a.stopRefreshTask(),a.refresh(!0,e,t),a.setState({startTime:e,endTime:t,dateRangeNickname:n}),a.closeDateRangeSelector()},a.setRefreshInterval=function(e){var t=a.props.globalState,n=e.target.value;t.set(ae.GLOBAL_FILTER,Object(i.a)({},t.get(ae.GLOBAL_FILTER),{refreshInterval:n})),a.stopRefreshTask(),a.setState({refreshInterval:n})},a.refreshManually=function(){a.stopRefreshTask(),a.refresh(!0),a.startRefreshTask()},a.startRefreshTask=function(){var e=a.state,t=e.refreshInterval,n=e.isAutoRefreshEnabled,r=Object(R.a)(Object(R.a)(a));a.stopRefreshTask(),n&&t&&t>0&&(a.refreshIntervalID=setInterval(function(){return r.refresh(!1)},t))},a.stopRefreshTask=function(){a.refreshIntervalID&&(clearInterval(a.refreshIntervalID),a.refreshIntervalID=null)},a.refresh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=a.props.onUpdate,o=a.state,l=o.startTime,i=o.endTime;r&&r(e,ze.parseTime(t||l),ze.parseTime(n||i))};var l=a.props.globalState.get(ae.GLOBAL_FILTER);return a.state={startTime:l.startTime,endTime:l.endTime,dateRangeNickname:l.dateRangeNickname,refreshInterval:l.refreshInterval,dateRangeSelectorAnchorElement:void 0,isAutoRefreshEnabled:!0},a.refreshIntervalID=null,a}return Object(l.a)(t,e),t}(z.a.Component);Vn.getDerivedStateFromProps=function(e,t){return Object(i.a)({},t,{isAutoRefreshEnabled:t.endTime.includes("now")})};var zn=Object(K.withStyles)(function(e){return{container:{position:"sticky",top:64,backgroundColor:"#fafafa",marginBottom:42,zIndex:999,minHeight:70},title:{marginLeft:e.spacing.unit,marginTop:e.spacing.unit},subTitle:{marginLeft:e.spacing.unit,marginTop:1.5*e.spacing.unit,color:"#666"},grow:{flexGrow:1},dateRangeButton:{marginRight:3*e.spacing.unit,textTransform:"none",fontWeight:500,border:"1px solid #e0e0e0"},startInputAdornment:{marginRight:2*e.spacing.unit,marginBottom:2*e.spacing.unit},refreshTimeSelect:{border:"none",fontSize:14},menuButton:{marginTop:e.spacing.unit},dateRangeNicknameSelectedTime:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,fontWeight:500},calendar:{marginLeft:10}}},{withTheme:!0})(Object(Y.a)(le(Vn))),Hn=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleTabChange=function(e,t){var n=a.props,r=n.history,o=n.location,l=n.match;a.setState({selectedTabIndex:t});var s=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(o.search),{tab:a.tabs[t]}));r.replace(l.url+s,Object(i.a)({},o.state))},a.handleOnUpdate=function(e,t,n){a.tabContentRef.current&&a.tabContentRef.current.update&&a.tabContentRef.current.update(e,t,n)},a.onFilterUpdate=function(e){var t=a.props,n=t.history,r=t.location,o=t.match,l=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(r.search),e));n.replace(o.url+l,Object(i.a)({},r.state))},a.render=function(){var e=a.props,t=e.classes,n=e.location,r=e.match,o=a.state.selectedTabIndex,l=r.params.cellName,i=[sa,Ut,on][o],s=_.parseQueryParams(n.search),c={cell:l};return z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:"".concat(l),subTitle:"- Cell",onUpdate:a.handleOnUpdate}),z.a.createElement(Ge.a,{className:t.root},z.a.createElement("div",{className:t.tabBar},z.a.createElement(un.a,{value:o,indicatorColor:"primary",onChange:a.handleTabChange,className:t.tabs},z.a.createElement(sn.a,{label:"Details"}),z.a.createElement(sn.a,{label:"Components"}),z.a.createElement(sn.a,{label:"Metrics"})),z.a.createElement(G.a,{className:t.traceButton,component:Ft.a,size:"small",to:"/tracing/search".concat(_.generateQueryParamString(c))},z.a.createElement(St.a,null),z.a.createElement("span",{className:t.viewTracesContent},"View Traces"))),z.a.createElement(i,{innerRef:a.tabContentRef,cell:l,onFilterUpdate:a.onFilterUpdate,globalFilterOverrides:s})))},a.tabContentRef=z.a.createRef(),a.mounted=!1,a.tabs=["details","components","metrics"];var l=_.parseQueryParams(e.location.search),s=l.tab?a.tabs.indexOf(l.tab):null;return a.state={selectedTabIndex:s&&-1!==s?s:0},a}return Object(l.a)(t,e),t}(z.a.Component),Wn=Object(K.withStyles)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,padding:3*e.spacing.unit,paddingTop:0,margin:Number(e.spacing.unit)},tabBar:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2*e.spacing.unit,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:ua.a[200]},viewTracesContent:{paddingLeft:e.spacing.unit},traceButton:{fontSize:12}}})(Hn),Qn=a(39),Yn=a.n(Qn),Kn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).loadCellInfo=function(e,t,n){var r=a.props.globalState,o=Object(R.a)(Object(R.a)(a)),l={queryStartTime:t.valueOf(),queryEndTime:n.valueOf()};e&&(lt.showLoadingOverlay("Loading Cell Info",r),o.setState({isLoading:!0})),_.callObservabilityAPI({url:"/http-requests/cells".concat(_.generateQueryParamString(l)),method:"GET"},r).then(function(t){var a=t.map(function(e){return{sourceCell:e[0],destinationCell:e[1],httpResponseGroup:e[2],totalResponseTimeMilliSec:e[3],requestCount:e[4]}});o.setState({cellInfo:a}),e&&(lt.hideLoadingOverlay(r),o.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(r),o.setState({isLoading:!1}),lt.showNotification("Failed to load cell information",lt.Levels.ERROR,r))})},a.render=function(){var e=a.props,t=e.classes,n=e.match,r=a.state,o=r.cellInfo,l=r.isLoading,i=[{name:"Health",options:{customBodyRender:function(e){return z.a.createElement(Bt,{value:e})}}},{name:"Cell",options:{customBodyRender:function(e){return z.a.createElement(Ft.a,{to:"".concat(n.url,"/").concat(e)},e)}}},{name:"Inbound Error Rate",options:{customBodyRender:function(e){return"".concat(Math.round(100*e)," %")}}},{name:"Outbound Error Rate",options:{customBodyRender:function(e){return"".concat(Math.round(100*e)," %")}}},{name:"Average Response Time (ms)",options:{customBodyRender:function(e){return Math.round(e)}}},{name:"Average Inbound Request Count (requests/s)"}],s={},c=function(e){s[e]||(s[e]={inboundErrorCount:0,outboundErrorCount:0,requestCount:0,totalResponseTimeMilliSec:0})},u=!0,d=!1,m=void 0;try{for(var p,g=o[Symbol.iterator]();!(u=(p=g.next()).done);u=!0){var h=p.value;c(h.sourceCell),c(h.destinationCell),"5xx"===h.httpResponseGroup&&(s[h.destinationCell].inboundErrorCount+=h.requestCount,s[h.sourceCell].outboundErrorCount+=h.requestCount),s[h.destinationCell].requestCount+=h.requestCount,s[h.destinationCell].totalResponseTimeMilliSec+=h.totalResponseTimeMilliSec}}catch(b){d=!0,m=b}finally{try{u||null==g.return||g.return()}finally{if(d)throw m}}var f=[];for(var v in s)if(s.hasOwnProperty(v)&&Boolean(v)){var E=s[v];f.push([0===E.requestCount?-1:1-E.inboundErrorCount/E.requestCount,v,0===E.requestCount?0:E.inboundErrorCount/E.requestCount,0===E.requestCount?0:E.outboundErrorCount/E.requestCount,0===E.requestCount?0:E.totalResponseTimeMilliSec/E.requestCount,E.requestCount])}return z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:"Cells",onUpdate:a.loadCellInfo}),l?null:z.a.createElement(Yn.a,{className:t.root},f.length>0?z.a.createElement(kt,{columns:i,options:{filter:!1},data:f}):z.a.createElement(Z,{title:"No Cells Found",description:"No Requests between cells found in the selected time range"})))},a.state={cellInfo:[],isLoading:!1},a}return Object(l.a)(t,e),t}(z.a.Component),Zn=Object(K.withStyles)(function(e){return{root:{margin:e.spacing.unit,padding:3*e.spacing.unit}}})(le(Kn)),Xn=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.dependencyGraph.current&&a.draw()},a.componentDidUpdate=function(){a.dependencyGraph.current&&a.draw()},a.draw=function(){var e=a.props,n=e.nodeData,r=e.edgeData,o=e.selectedComponent,l=e.viewGenerator,i=e.cellColor,s=[],c=[],u=function(e,t){for(var a=t.x,n=t.y,r=[],o=0;o<e.length;o++)r.push(Math.hypot(e[o].x-a,e[o].y-n));return Math.max.apply(Math,r)},d=function(e){for(var t,a,n,r,o=0;o<e.length;o++)n=e[o].x<n||void 0===n?e[o].x:n,t=e[o].x>t||void 0===t?e[o].x:t,r=e[o].y<r||void 0===r?e[o].y:r,a=e[o].y>a||void 0===a?e[o].y:a;return{x:(n+t)/2,y:(r+a)/2}},m=function(e){var t=function(e){var t=[];return b.get({filter:function(a){a.group===e&&t.push(a.id)}}),t}(e),a=O.getPositions(t);return Object.values(a)},p=function(e,t){var a,n,r,o,l,i,s,c,u=e.length,d=new Array(u);for(n=0;n<u;n++)(a=n-1)<0&&(a=u-1),(r=n+1)===u&&(r=0),l=e[a],i=e[n],s=e[r],c=g(l[0],l[1],i[0],i[1],t,!1),o=g(i[0],i[1],s[0],s[1],t,!0),d[n]=[c[0],c[1],i[0],i[1],o[0],o[1]];return d},g=function(e,t,a,n,r,o){var l=Math.sqrt(Math.pow(a-e,2)+Math.pow(n-t,2)),i=o?r/l:(l-r)/l;return[e+i*(a-e),t+i*(n-t)]};n&&n.forEach(function(e,t){s.push({id:e.id,label:e.label,shape:"image",image:l(e.group,e.id,0),group:e.group})}),r&&r.forEach(function(e,t){c.find(function(t){return t.from===e.source&&t.to===e.target})||c.push({id:t,from:e.source,to:e.target})});var h,f=function(e,t){var a=[];return e.forEach(function(e){e.group===t&&a.push(e)}),a},v=f(s,t.NodeType.COMPONENT),E=f(s,t.NodeType.CELL),b=new Wt.a.DataSet(v),C=new Wt.a.DataSet(c),T={nodes:b,edges:C},O=new Wt.a.Network(a.dependencyGraph.current,T,t.GRAPH_OPTIONS);o&&O.selectNodes([o],!1),O.on("afterDrawing",function(e){var a=d(m(t.NodeType.COMPONENT)),n=u(m(t.NodeType.COMPONENT),a),r=n+70,o=a.x,l=a.y,s=0;s=0===n?7:12,e.translate(o,l),e.rotate(22.5*Math.PI/180),e.translate(-o,-l);var c=[];e.beginPath(),e.moveTo(o+r,l+r),e.lineJoin="round",e.lineWidth=3;for(var g=0;g<=8;g+=1)e.lineTo(o+r*Math.cos(2*g*Math.PI/8),l+r*Math.sin(2*g*Math.PI/8)),g<8&&c.push([o+r*Math.cos(2*g*Math.PI/8),l+r*Math.sin(2*g*Math.PI/8)]);e.closePath(),function(e,t,a){var n,r,o;a>0&&(n=p(t,a));var l=n.length;for(r=0;r<l;r++)o=n[r],0===r?(e.beginPath(),e.moveTo(o[0],o[1])):e.lineTo(o[0],o[1]),a>0&&e.quadraticCurveTo(o[2],o[3],o[4],o[5]);e.closePath()}(e,c,s),e.strokeStyle=i,e.stroke()}),O.on("stabilizationIterationsDone",function(){O.setOptions({physics:!1});var e=d(m(t.NodeType.COMPONENT)),a=u(m(t.NodeType.COMPONENT),e);a+=200;var n=2*Math.PI/E.length;E.forEach(function(e,t){b.add(e);var r=a*Math.cos(n*t),o=a*Math.sin(n*t);O.moveNode(e.id,r,o)}),h=b.get({returnType:"Object"})});O.on("hoverNode",function(e){var t=O.getConnectedNodes(e.node);if(t.length>0){var a=e.node;for(var n in h)h.hasOwnProperty(n)&&(h[n].image=l(h[n].group,n,.8),void 0===h[n].hiddenLabel&&(h[n].hiddenLabel=h[n].label,h[n].label=void 0));for(var r=0;r<t.length;r++)h[t[r]].image=l(h[t[r]].group,t[r],0),void 0!==h[t[r]].hiddenLabel&&(h[t[r]].label=h[t[r]].hiddenLabel,h[t[r]].hiddenLabel=void 0);h[a].image=l(h[a].group,a,0),void 0!==h[a].hiddenLabel&&(h[a].label=h[a].hiddenLabel,h[a].hiddenLabel=void 0)}var o=[];for(var i in h)h.hasOwnProperty(i)&&o.push(h[i]);b.update(o)}),O.on("blurNode",function(){for(var e in h)h.hasOwnProperty(e)&&(h[e].image=l(h[e].group,e,0),void 0!==h[e].hiddenLabel&&(h[e].label=h[e].hiddenLabel,h[e].hiddenLabel=void 0));var t=[];for(var a in h)h.hasOwnProperty(a)&&t.push(h[a]);b.update(t)})},a.render=function(){var e=a.props,t=e.nodeData,n=e.classes;return t&&t.length>0?z.a.createElement(zt,{title:"Unable to Render",description:"Unable to Render due to Invalid Data"},z.a.createElement("div",{className:n.graph,ref:a.dependencyGraph})):z.a.createElement(qt,{title:"No Data Available",description:"No Data Available to render Dependency Graph"})},a.dependencyGraph=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.Component);Xn.NodeType={CELL:"cell",COMPONENT:"component"},Xn.GRAPH_OPTIONS={nodes:{shapeProperties:{borderRadius:10},borderWidth:1,size:40,font:{size:15,color:"#000000"}},edges:{width:2,smooth:!1,color:{inherit:!1,color:"#ccc7c7"},arrows:{to:{enabled:!0,scaleFactor:.5}}},layout:{randomSeed:1,improvedLayout:!0},autoResize:!0,physics:{enabled:!0,barnesHut:{gravitationalConstant:-1e3,centralGravity:.3,springLength:100,springConstant:.04,damping:.09,avoidOverlap:1},forceAtlas2Based:{gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:1},repulsion:{centralGravity:1,springLength:0,springConstant:0,nodeDistance:0,damping:.09},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.1,solver:"forceAtlas2Based",stabilization:{enabled:!0,iterations:1e3,updateInterval:100,onlyDynamicEdges:!1,fit:!0},adaptiveTimestep:!1},interaction:{hover:!0}};var Jn=Object(K.withStyles)(function(e){return{graph:{width:"100%",height:"100%"}}})(Xn),$n=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime).valueOf(),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime).valueOf())},a.update=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,s=r.component,c=Object(R.a)(Object(R.a)(a)),u={queryStartTime:t.valueOf(),queryEndTime:n.valueOf()};e&&lt.showLoadingOverlay("Loading Component Dependency Graph",o);var d="/dependency-model/cells/".concat(l,"/components/").concat(s);d+="".concat(_.generateQueryParamString(u)),_.callObservabilityAPI({url:d,method:"GET"},o).then(function(t){var a=[],n=[];t.nodes.forEach(function(e){l===e.id.split(":")[0]?a.push(Object(i.a)({},e,{label:e.id,group:"component"})):"gateway"===e.id.split(":")[1]&&a.push(Object(i.a)({},e,{label:e.id.split(":")[0],group:"cell"}))}),t.edges.forEach(function(e){(l===e.source.split(":")[0]&&l===e.target.split(":")[0]||l===e.source.split(":")[0]&&"gateway"===e.target.split(":")[1])&&n.push(Object(i.a)({},e))}),c.setState({data:{nodes:a,edges:n}}),e&&lt.hideLoadingOverlay(o)}).catch(function(){e&&(lt.hideLoadingOverlay(o),lt.showNotification("Failed to load component dependency view",lt.Levels.ERROR,o))})},a.onClickNode=function(e){},a.render=function(){var e,t=a.props,n=t.classes,r=t.cell,o=t.component,l=t.colorGenerator,i=a.state.data.nodes.length,s="".concat(r,":").concat(o),c=a.state.data.nodes,u=a.state.data.edges;return e=i>1?z.a.createElement(zt,{title:"Unable to Render",description:"Unable to Render due to Invalid Data"},z.a.createElement(Jn,{id:"component-dependency-graph",nodeData:c,edgeData:u,selectedComponent:s,onClickNode:a.onClickNode,viewGenerator:function(e,t,a){var n,r=Oe.shadeColor(l.getColor(t.split(":")[0]),a),o=Oe.shadeColor(r,-.08);return n=e===Jn.NodeType.COMPONENT?'<svg xmlns="http://www.w3.org/2000/svg"  x="0px" y="0px" width="100%" height="100%" viewBox="0 0 14 14">'+'<path fill="'.concat(r,'"  stroke="').concat(s===t?"#444":o,'" stroke-opacity="').concat(1-a,'" ')+'stroke-width="0.5px" d="M13,7a6,6,0,0,1-6,6.06A6,6,0,0,1,1,7,6,6,0,0,1,7,.94,6,6,0,0,1,13,7Z" transform="translate(-0.79 -0.69)"/><path fill="#999" stroke="#fff" stroke-width="0.1px" d="M4.37,5c-.19.11-.19.28,0,.39L6.76,6.82a.76.76,0,0,0,.69,0L9.64,5.45a.23.23,0,0,0,0-.42L7.45,3.7a.76.76,0,0,0-.69,0Z" transform="translate(-0.79 -0.69)"/><path fill="#999" stroke="#fff" stroke-width="0.1px" d="M10,5.93c0-.22-.15-.31-.34-.19L7.45,7.1a.73.73,0,0,1-.69,0L4.37,5.73c-.19-.11-.35,0-.35.2V8a.88.88,0,0,0,.33.63l2.43,1.68a.61.61,0,0,0,.65,0L9.66,8.63A.9.9,0,0,0,10,8Z" transform="translate(-0.79 -0.69)"/><text fill="#fff" font-size="1.63px" font-family="ArialMT, Arial" transform="translate(5.76 5.1) scale(0.98 1)">\u03bc</text></svg>':'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 14 14">'+'<path fill="'.concat(r,'"  stroke="').concat(o,'" stroke-opacity="').concat(1-a,'" ')+' stroke-width="0.5px" d="M8.92.84H5a1.45,1.45,0,0,0-1,.42L1.22,4a1.43,1.43,0,0,0-.43,1V9a1.43,1.43,0,0,0,.43,1L4,12.75a1.4,1.4,0,0,0,1,.41H8.92a1.4,1.4,0,0,0,1-.41L12.72,10a1.46,1.46,0,0,0,.41-1V5a1.46,1.46,0,0,0-.41-1L9.94,1.25A1.44,1.44,0,0,0,8.92.84Z" transform="translate(-0.54 -0.37)"/></svg>',"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n))},graphType:"dependency",cellColor:l.getColor(r)})):z.a.createElement("div",null,z.a.createElement(Zt.a,{className:n.infoIcon,color:"action"}),z.a.createElement(Xe.a,{variant:"subtitle2",color:"textSecondary",className:n.info},'"'.concat(o,'"')," component in ",'"'.concat(r,'"')," cell does not depend on any other Component")),z.a.createElement("div",{className:n.dependencies},z.a.createElement(Xe.a,{color:"textSecondary",className:n.subtitle},"Dependencies"),z.a.createElement("div",{className:n.graphContainer},z.a.createElement("div",{className:n.diagram},e)))},a.state={data:{nodes:[],edges:[]}},a}return Object(l.a)(t,e),t}(z.a.Component),er=Object(K.withStyles)(function(e){return{subtitle:{fontWeight:400,fontSize:"1rem"},graph:{width:"100%",height:"100%"},dependencies:{marginTop:3*e.spacing.unit},graphContainer:{display:"flex"},diagram:{padding:3*e.spacing.unit,flexGrow:1},info:{display:"inline-flex"},infoIcon:{verticalAlign:"middle",display:"inline-flex",fontSize:18,marginRight:4}}},{withTheme:!0})(at(le($n))),tr=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=r.component,s=Object(R.a)(Object(R.a)(a)),c={queryStartTime:t.valueOf(),queryEndTime:n.valueOf(),destinationCell:l,destinationComponent:i};e&&(lt.showLoadingOverlay("Loading Component Info",o),s.setState({isLoading:!0})),_.callObservabilityAPI({url:"/http-requests/cells/components/metrics/".concat(_.generateQueryParamString(c)),method:"GET"},o).then(function(t){var a=t.map(function(e){return{isError:"5xx"===e[1],count:e[5]}}).reduce(function(e,t){return t.isError&&(e.errorsCount+=t.count),e.total+=t.count,e},{errorsCount:0,total:0});s.setState({health:1-(0===a.total?a.errorsCount/a.total:0),isDataAvailable:a.total>0}),e&&(lt.hideLoadingOverlay(o),s.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),s.setState({isLoading:!1}),lt.showNotification("Failed to load component information",lt.Levels.ERROR,o))})},a.state={isDataAvailable:!1,health:-1,dependencyGraphData:[],isLoading:!1},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e,t=this.props,a=t.classes,n=t.cell,r=t.component,o=this.state,l=o.health,i=o.isLoading,s=o.isDataAvailable;return e=s?z.a.createElement(ea.a,{className:a.table},z.a.createElement(aa.a,null,z.a.createElement(la.a,null,z.a.createElement(ra.a,{className:a.tableCell},z.a.createElement(Xe.a,{color:"textSecondary"},"Health")),z.a.createElement(ra.a,{className:a.tableCell},z.a.createElement(Bt,{value:l}))),z.a.createElement(la.a,null,z.a.createElement(ra.a,{className:a.tableCell},z.a.createElement(Xe.a,{color:"textSecondary"},"Cell")),z.a.createElement(ra.a,{className:a.tableCell},z.a.createElement(Ft.a,{to:"/cells/".concat(n)},n))))):z.a.createElement(Z,{title:"Component Not Found",description:'The "'.concat(r,'" component not found. ')+"This is possibly because no requests had been received/sent by this component in the selected time period"}),z.a.createElement(z.a.Fragment,null,i?null:e,s?z.a.createElement(er,{cell:n,component:r}):null)}}]),t}(z.a.Component),ar=Object(K.withStyles)(function(){return{table:{width:"20%",marginTop:25},tableCell:{borderBottom:"none"}}})(le(tr)),nr=a(183),rr=a.n(nr),or=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n){a.loadPodInfo(e,t,n)},a.loadPodInfo=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=r.component,s=Object(R.a)(Object(R.a)(a)),c={queryStartTime:t.valueOf(),queryEndTime:n.valueOf(),cell:l,component:i};e&&(lt.showLoadingOverlay("Loading Pod Info",o),s.setState({isLoading:!0})),_.callObservabilityAPI({url:"/k8s/pods".concat(_.generateQueryParamString(c)),method:"GET"},o).then(function(t){var a=t.map(function(e){return{name:e[2],creationTimestamp:e[3],lastKnownAliveTimestamp:e[4],nodeName:e[5]}});s.setState({podInfo:a}),e&&(lt.hideLoadingOverlay(o),s.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),s.setState({isLoading:!1}),lt.showNotification("Failed to load pod information",lt.Levels.ERROR,o))})},a.metricsButtonRenderer=function(e){var t=Object(R.a)(Object(R.a)(a)),n=t.props.globalState,r=t.state,o=r.metricsPopperElement,l=r.openMetricsPopoverPod,i=n.get(ae.CONFIG).templates.kubernetesMetricsLinks.pod,s=n.get(ae.CONFIG).templates.kubernetesMetricsLinks.node,c=function(){t.setState({metricsPopperElement:null,openMetricsPopoverPod:null})},u=function(t){var a=ze.parseTime(n.get(ae.GLOBAL_FILTER).startTime).valueOf(),r=ze.parseTime(n.get(ae.GLOBAL_FILTER).endTime).valueOf();return t.replace(/\${pod}/g,e.podName).replace(/\${node}/g,e.nodeName).replace(/\${fromTime}/g,a).replace(/\${toTime}/g,r)},d=l===e.podName?o:null;return z.a.createElement(z.a.Fragment,null,z.a.createElement(we.a,{size:"small",color:"inherit",onClick:function(a){t.setState({metricsPopperElement:a.currentTarget,openMetricsPopoverPod:e.podName})},disabled:!i&&!s},z.a.createElement(rr.a,null)),i||s?z.a.createElement(ke.a,{anchorEl:d,open:Boolean(d),onClose:c},i?z.a.createElement(Be.a,{onClick:function(){c(),window.open(u(i))}},"Pod Metrics"):null,s?z.a.createElement(Be.a,{onClick:function(){c(),window.open(u(s))}},"Node Metrics"):null):null)},a.render=function(){var e,t=a.props.component,n=a.state,r=n.podInfo,o=n.isLoading,l=[{name:"Pod"},{name:"Created Timestamp",options:{customBodyRender:function(e){return ee()(e).format(J.Pattern.DATE_TIME)}}},{name:"Last Known Alive Timestamp",options:{customBodyRender:function(e){return ee()(e).format(J.Pattern.DATE_TIME)}}},{name:"Node"},{name:"",options:{customBodyRender:a.metricsButtonRenderer}}];return e=r.length>0?z.a.createElement(kt,{columns:l,options:{filter:!1},data:r.map(function(e){return[e.name,e.creationTimestamp,e.lastKnownAliveTimestamp,e.nodeName,{podName:e.name,nodeName:e.nodeName}]})}):z.a.createElement(Z,{title:"No Pods Found",description:'No Pods found for "'.concat(t,'" component ')+"in the selected time range"}),o?null:e},a.state={podInfo:[],isLoading:!1,metricsPopperElement:null,openMetricsPopoverPod:null},a}return Object(l.a)(t,e),t}(z.a.Component),lr=Object(K.withStyles)({})(le(or)),ir=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){var e=a.props.globalState;a.update(!0,ze.parseTime(e.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(e.get(ae.GLOBAL_FILTER).endTime))},a.update=function(e,t,n,r,o,l){var i=a.state,s=i.selectedType,c=i.selectedCell,u=i.selectedComponent,d=t.valueOf(),m=n.valueOf();a.loadMetrics(e,d,m,r||s,o||c,l||u),a.loadComponentMetadata(e,d,m)},a.getFilterChangeHandler=function(e){return function(t){var n=a.props,r=n.globalState,o=n.onFilterUpdate,l=a.state,i=l.selectedType,s=l.selectedCell,c=l.selectedComponent,u=t.target.value;a.setState(Object(C.a)({},e,u)),o&&o(Object(C.a)({selectedType:i,selectedCell:s,selectedComponent:c},e,u)),a.update(!0,ze.parseTime(r.get(ae.GLOBAL_FILTER).startTime),ze.parseTime(r.get(ae.GLOBAL_FILTER).endTime),"selectedType"===e?u:null,"selectedCell"===e?u:null,"selectedComponent"===e?u:null)}},a.loadComponentMetadata=function(e,t,n){var r=a.props,o=r.globalState,l=r.cell,i=r.component,s=Object(R.a)(Object(R.a)(a)),c={queryStartTime:t,queryEndTime:n};e&&(lt.showLoadingOverlay("Loading Component Info",o),s.setState(function(e){return{loadingCount:e.loadingCount+1}})),_.callObservabilityAPI({url:"/http-requests/cells/components/metadata".concat(_.generateQueryParamString(c)),method:"GET"},o).then(function(t){s.setState({components:t.filter(function(e){return e.cell!==l||e.component!==i})}),e&&(lt.hideLoadingOverlay(o),s.setState(function(e){return{loadingCount:e.loadingCount-1}}))}).catch(function(){e&&(lt.hideLoadingOverlay(o),s.setState(function(e){return{loadingCount:e.loadingCount-1}}),lt.showNotification("Failed to load component information",lt.Levels.ERROR,o))})},a.loadMetrics=function(e,t,n,r,o,l){var i=a.props,s=i.globalState,c=i.cell,u=i.component,d=Object(R.a)(Object(R.a)(a)),m={queryStartTime:t,queryEndTime:n};o!==J.Dashboard.ALL_VALUE&&(r===J.Dashboard.INBOUND?m.sourceCell=o:m.destinationCell=o),l!==J.Dashboard.ALL_VALUE&&(r===J.Dashboard.INBOUND?m.sourceComponent=l:m.destinationComponent=l),r===J.Dashboard.INBOUND?(m.destinationCell=c,m.destinationComponent=u):(m.sourceCell=c,m.sourceComponent=u),e&&(lt.showLoadingOverlay("Loading Component Metrics",s),d.setState(function(e){return{loadingCount:e.loadingCount+1}})),_.callObservabilityAPI({url:"/http-requests/cells/components/metrics".concat(_.generateQueryParamString(m)),method:"GET"},s).then(function(t){var a=t.map(function(e){return{timestamp:e[0],httpResponseGroup:e[1],totalResponseTimeMilliSec:e[2],totalRequestSizeBytes:e[3],totalResponseSizeBytes:e[4],requestCount:e[5]}});d.setState({componentData:a}),e&&(lt.hideLoadingOverlay(s),d.setState(function(e){return{loadingCount:e.loadingCount-1}}))}).catch(function(){e&&(lt.hideLoadingOverlay(s),d.setState(function(e){return{loadingCount:e.loadingCount-1}}),lt.showNotification("Failed to load component metrics",lt.Levels.ERROR,s))})},a.render=function(){var e=a.props,t=e.classes,n=e.cell,r=e.component,o=a.state,l=o.selectedType,i=o.selectedCell,s=o.selectedComponent,c=o.componentData,u=o.metadata,d=o.loadingCount,m=l===J.Dashboard.INBOUND?"Source":"Target";return d>0?null:z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:t.filters},z.a.createElement(ma.a,{className:t.formControl},z.a.createElement(ga.a,{htmlFor:"selected-type"},"Type"),z.a.createElement(nn.a,{value:l,onChange:a.getFilterChangeHandler("selectedType"),inputProps:{name:"selected-type",id:"selected-type"}},z.a.createElement("option",{value:J.Dashboard.INBOUND},J.Dashboard.INBOUND),z.a.createElement("option",{value:J.Dashboard.OUTBOUND},J.Dashboard.OUTBOUND))),z.a.createElement(ma.a,{className:t.formControl},z.a.createElement(ga.a,{htmlFor:"selected-cell"},m," Cell"),z.a.createElement(nn.a,{value:i,onChange:a.getFilterChangeHandler("selectedCell"),inputProps:{name:"selected-cell",id:"selected-cell"}},z.a.createElement("option",{value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),u.availableCells.map(function(e){return z.a.createElement("option",{key:e,value:e},e)}))),z.a.createElement(ma.a,{className:t.formControl},z.a.createElement(ga.a,{htmlFor:"selected-component"},m," Component"),z.a.createElement(nn.a,{value:s,onChange:a.getFilterChangeHandler("selectedComponent"),inputProps:{name:"selected-component",id:"selected-component"}},z.a.createElement("option",{value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),u.availableComponents.map(function(e){return z.a.createElement("option",{key:e,value:e},e)})))),z.a.createElement("div",{className:t.graphs},c.length>0?z.a.createElement(tn,{cell:n,component:r,data:c,direction:l===J.Dashboard.INBOUND?"In":"Out"}):z.a.createElement(Z,{title:"No Metrics Found",description:l===J.Dashboard.INBOUND?"No Requests from the selected component "+'to the "'.concat(n,'" cell\'s "').concat(r,'" component'):'No Requests from the "'.concat(n,'" cell\'s "').concat(r,'" ')+"component to the selected component"})))},a.state={selectedType:e.globalFilterOverrides&&e.globalFilterOverrides.selectedType?e.globalFilterOverrides.selectedType:J.Dashboard.INBOUND,selectedCell:e.globalFilterOverrides&&e.globalFilterOverrides.selectedCell?e.globalFilterOverrides.selectedCell:J.Dashboard.ALL_VALUE,selectedComponent:e.globalFilterOverrides&&e.globalFilterOverrides.selectedComponent?e.globalFilterOverrides.selectedComponent:J.Dashboard.ALL_VALUE,components:[],metadata:{availableCells:[],availableComponents:[]},componentData:[],loadingCount:0},a}return Object(l.a)(t,e),t}(z.a.Component);ir.getDerivedStateFromProps=function(e,t){var a=e.cell,n=e.component,r=t.components,o=t.selectedCell,l=t.selectedComponent,s=[];r.forEach(function(e){var t=!0;if(Boolean(e.cell)&&e.cell===a){var o=r.find(function(e){return a===e.cell&&e.name!==n});t=Boolean(o)}t&&Boolean(e.cell)&&!s.includes(e.cell)&&s.push(e.cell)});var c=[];r.forEach(function(e){!Boolean(e.name)||!Boolean(e.cell)||o!==J.Dashboard.ALL_VALUE&&e.cell!==o||e.cell===a&&e.name===n||c.includes(e.name)||c.push(e.name)});var u=0===r.length||c.includes(l)?l:J.Dashboard.ALL_VALUE;return Object(i.a)({},t,{selectedComponent:u,metadata:{availableCells:s,availableComponents:c}})};var sr=Object(K.withStyles)(function(e){return{filters:{marginTop:4*e.spacing.unit,marginBottom:4*e.spacing.unit},formControl:{marginRight:4*e.spacing.unit,minWidth:150},graphs:{marginBottom:4*e.spacing.unit},button:{marginTop:2*e.spacing.unit}}})(le(ir)),cr=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleTabChange=function(e,t){var n=a.props,r=n.history,o=n.location,l=n.match;a.setState({selectedTabIndex:t});var s=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(o.search),{tab:a.tabs[t]}));r.replace(l.url+s,Object(i.a)({},o.state))},a.handleOnUpdate=function(e,t,n){a.tabContentRef.current&&a.tabContentRef.current.update&&a.tabContentRef.current.update(e,t,n)},a.onFilterUpdate=function(e){var t=a.props,n=t.history,r=t.location,o=t.match,l=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(r.search),e));n.replace(o.url+l,Object(i.a)({},r.state))},a.tabs=["details","k8s-pods","metrics"];var l=_.parseQueryParams(e.location.search),s=l.tab?a.tabs.indexOf(l.tab):null;return a.state={selectedTabIndex:s&&-1!==s?s:0},a.tabContentRef=z.a.createRef(),a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.location,n=e.match,r=this.state.selectedTabIndex,o=n.params.cellName,l=n.params.componentName,i=[ar,lr,sr][r],s=_.parseQueryParams(a.search),c={cell:o,component:l};return z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:"".concat(l),subTitle:"- Component",onUpdate:this.handleOnUpdate}),z.a.createElement(Yn.a,{className:t.root},z.a.createElement("div",{className:t.tabBar},z.a.createElement(un.a,{value:r,indicatorColor:"primary",onChange:this.handleTabChange,className:t.tabs},z.a.createElement(sn.a,{label:"Details"}),z.a.createElement(sn.a,{label:"K8s Pods"}),z.a.createElement(sn.a,{label:"Metrics"})),z.a.createElement(G.a,{className:t.traceButton,component:Ft.a,to:"/tracing/search".concat(_.generateQueryParamString(c))},z.a.createElement(St.a,null),z.a.createElement("span",{className:t.viewTracesContent},"View Traces"))),z.a.createElement(i,{innerRef:this.tabContentRef,cell:o,component:l,onFilterUpdate:this.onFilterUpdate,globalFilterOverrides:s})))}}]),t}(z.a.Component),ur=Object(K.withStyles)(function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,padding:3*e.spacing.unit,paddingTop:0,margin:e.spacing.unit},tabBar:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2*e.spacing.unit,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:ua.a[200]},viewTracesContent:{paddingLeft:e.spacing.unit},traceButton:{fontSize:12}}})(cr),dr=a(5809),mr=a(5805),pr=Object(Y.a)(function(e){var t=e.match;return z.a.createElement(dr.a,null,z.a.createElement(mr.a,{exact:!0,path:"".concat(t.path,"/"),component:Zn}),z.a.createElement(mr.a,{exact:!0,path:"".concat(t.path,"/:cellName"),component:Wn}),z.a.createElement(mr.a,{exact:!0,path:"".concat(t.path,"/:cellName/components/:componentName"),component:ur}),z.a.createElement(mr.a,{path:"".concat(t.url,"/*"),render:function(e){return z.a.createElement(Z,Object.assign({},e,{showNavigationButtons:!0}))}}))}),gr=a(253),hr=a.n(gr),fr=a(121),vr=a.n(fr),Er=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M9.81.21H4.19l-4,4V9.81l4,4H9.81l4-4V4.19Zm3,9.19L9.4,12.79H4.6L1.21,9.4V4.6L4.6,1.21H9.4L12.79,4.6Z"}))},br=a(176),Cr=a.n(br),Tr=a(88),Or=a.n(Tr),Sr=a(185),yr=a.n(Sr),Nr=a(98),Lr=a.n(Nr),Rr=(a(5773),a(5775),a(93)),Ir=a.n(Rr),Ar=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M13.4,3.3C13.4,3.3,13.3,3.2,13.4,3.3c-0.1-0.3-0.3-0.4-0.4-0.4L7.2,0.1c-0.2-0.1-0.3-0.1-0.5,0L0.9,2.9 C0.7,3,0.6,3.2\n,0.6,3.5v7.1c0,0.2,0.1,0.4,0.3,0.5l5.7,2.8l0,0l0,0l0.2,0c0,0,0.1,0,0,0l6-2.9c0.2-0.1,0.3-0.3,0.3-0.5L13.4,3.3 L13.4\n,3.3z M6.4,6.7v5.8l-4.6-2.2V4.4L6.4,6.7z M11.5,3.5L7,5.6L2.5,3.5L7,1.3L11.5,3.5z M12.2,4.4v5.8l-4.7,2.3V6.7L12.2,4.4z"}))},wr=a(184),Dr=a.n(wr),xr=a(177),jr=a.n(xr),kr=a(178),Mr=a.n(kr),_r=a(179),Pr=a.n(_r),Br=function(e){return z.a.createElement(W.a,Object.assign({viewBox:"0 0 14 14"},e),z.a.createElement("path",{d:"M1.1,6.2V2.9c0-0.2,0.2-0.4,0.4-0.4h8.8V0.2l2.4,2.6c0.1,0.1,0.1,0.3,0,0.4l-2.5,2.6l0-2.3H2.1l0,2.9c0,0.2-0.2,0.4-0.4,0.4\nH1.5C1.3,6.6,1.1,6.4,1.1,6.2z M12.5,7.4h-0.3c-0.2,0-0.4,0.2-0.4,0.4l0,2.9H3.7l0-2.3l-2.5,2.6c-0.1,0.1-0.1,0.3,0,0.4l2.4,2.6\nv-2.3h8.8c0.2,0,0.4-0.2,0.4-0.4V7.8C12.9,7.6,12.7,7.4,12.5,7.4z"}))},Fr=a(132),Gr=a.n(Fr),Ur=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).render=function(){var e=a.props,t=e.classes,n=e.summary,r=e.request,o=e.selectedCell,l=e.colorGenerator,i=e.globalState,s=e.listData,c=a.state.trafficTooltip,u=[{options:{customBodyRender:function(e){var a=l.getColorForPercentage(e,i);return e<i.get(ae.CONFIG).percentageRangeMinValue.errorThreshold?z.a.createElement(q.a,{style:{color:a},className:t.listIcon}):e<i.get(ae.CONFIG).percentageRangeMinValue.warningThreshold?z.a.createElement(q.a,{style:{color:a},className:t.listIcon}):z.a.createElement(_t.a,{style:{color:a},className:t.listIcon})}}},{options:{customBodyRender:function(e){var a=e.cell,n=e.component;return z.a.createElement(Ja.a,{component:Ft.a,className:t.sidebarListTableText,to:"/cells/".concat(a).concat(n?"/components/".concat(n):"")},n||a)}}},{options:{customBodyRender:function(e){return z.a.createElement(qn.a,{title:"View Traces"},z.a.createElement(v.a,{size:"small",color:"inherit",component:Ft.a,to:"/tracing/search".concat(_.generateQueryParamString(e))},z.a.createElement(St.a,null)))}}}],d=l.getColor(Oe.SUCCESS),m=l.getColor(Oe.WARNING),p=l.getColor(Oe.ERROR),g=l.getColor(Oe.UNKNOWN);return z.a.createElement("div",{className:t.drawerContent},z.a.createElement("div",{className:t.sidebarContainer},o?z.a.createElement("div",{className:t.cellNameContainer},z.a.createElement(Er,{className:t.titleIcon,fontSize:"small"}),z.a.createElement(Ja.a,{color:"inherit",className:t.sideBarContentTitle},"Cell:"),z.a.createElement(Ja.a,{component:Ft.a,to:"/cells/".concat(o),className:t.cellName},n.topic)):null,z.a.createElement(Br,{className:t.titleIcon,fontSize:"small"}),z.a.createElement(Ja.a,{color:"inherit",className:t.sideBarContentTitle},"HTTP Traffic"),z.a.createElement("hr",{className:t.titleDivider}),z.a.createElement(ea.a,{className:t.table},z.a.createElement(Gr.a,null,z.a.createElement(la.a,null,z.a.createElement(ra.a,{className:t.sidebarTableCell},"Requests/s"),0===r.statusCodes[1].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},z.a.createElement(Ir.a,{className:t.avatar,style:{backgroundColor:d}},"OK")),0===r.statusCodes[2].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},z.a.createElement(Ir.a,{className:t.avatar,style:{backgroundColor:d}},"3xx")),0===r.statusCodes[3].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},z.a.createElement(Ir.a,{className:t.avatar,style:{backgroundColor:m}},"4xx")),0===r.statusCodes[4].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},z.a.createElement(Ir.a,{className:t.avatar,style:{backgroundColor:p}},"5xx")),0===r.statusCodes[5].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},z.a.createElement(Ir.a,{className:t.avatar,style:{backgroundColor:g}},"xxx")))),z.a.createElement(aa.a,null,z.a.createElement(la.a,null,z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[0].value),0===r.statusCodes[1].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[1].value,"%"),0===r.statusCodes[2].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[2].value,"%"),0===r.statusCodes[3].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[3].value,"%"),0===r.statusCodes[4].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[4].value,"%"),0===r.statusCodes[5].value?null:z.a.createElement(ra.a,{className:t.sidebarTableCell},r.statusCodes[5].value,"%")))),z.a.createElement("div",{className:t.barChart},z.a.createElement(Qa.l,{yType:"ordinal",stackBy:"x",width:250,height:90},z.a.createElement(Qa.j,null),z.a.createElement(Qa.g,null),z.a.createElement(Qa.k,null),z.a.createElement(Qa.m,null),z.a.createElement(Qa.a,{text:"%",className:"alt-x-label",includeMargin:!1,xPercent:-.15,yPercent:1.8}),z.a.createElement(Qa.f,{color:d,data:[{y:"Total",x:r.statusCodes[1].value,title:r.statusCodes[1].key,percentage:r.statusCodes[1].value,count:r.statusCodes[1].count}],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}}),z.a.createElement(Qa.f,{color:p,data:[{y:"Total",x:r.statusCodes[2].value,title:r.statusCodes[2].key,percentage:r.statusCodes[2].value,count:r.statusCodes[2].count}],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}}),z.a.createElement(Qa.f,{color:m,data:[{y:"Total",x:r.statusCodes[3].value,title:r.statusCodes[3].key,percentage:r.statusCodes[3].value,count:r.statusCodes[3].count}],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}}),z.a.createElement(Qa.f,{color:p,data:[{y:"Total",x:r.statusCodes[4].value,title:r.statusCodes[4].key,percentage:r.statusCodes[4].value,count:r.statusCodes[4].count}],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}}),z.a.createElement(Qa.f,{color:g,data:[{y:"Total",x:r.statusCodes[5].value,title:r.statusCodes[5].key,percentage:r.statusCodes[5].value,count:r.statusCodes[5].count}],onValueMouseOver:function(e){return a.setState({trafficTooltip:e})},onSeriesMouseOut:function(){return a.setState({trafficTooltip:!1})}}),c?z.a.createElement(Qa.e,{value:c},z.a.createElement("div",{className:"rv-hint__content"},"".concat(c.title," :\n                                                ").concat(c.percentage,"% (").concat(c.count,")"))):null))),z.a.createElement("div",{className:t.sidebarContainer},o?z.a.createElement(Ar,{className:t.titleIcon,fontSize:"small"}):z.a.createElement(it,{className:t.titleIcon,fontSize:"small"}),z.a.createElement(Ja.a,{color:"inherit",className:t.sideBarContentTitle},o?"Components":"Cells"," (",n.content[0].value,")"),z.a.createElement(jr.a,{className:t.panel},z.a.createElement(Pr.a,{expandIcon:z.a.createElement(Dr.a,null),className:t.expansionSum},0===n.content[1].value?null:z.a.createElement(Ja.a,{className:t.secondaryHeading},z.a.createElement(_t.a,{className:t.cellIcon,style:{color:d}}),"\xa0",n.content[1].value),0===n.content[2].value?null:z.a.createElement(Ja.a,{className:t.secondaryHeading},z.a.createElement(q.a,{className:t.cellIcon,style:{color:p}}),"\xa0",n.content[2].value)),z.a.createElement(Mr.a,{className:t.panelDetails},z.a.createElement("div",{className:"overviewSidebarListTable"},z.a.createElement(jt.a,{columns:u,options:{download:!1,selectableRows:!1,print:!1,filter:!1,search:!1,viewColumns:!1,rowHover:!1},data:s.map(function(e){return[e[0],{cell:o||e[1],component:o?e[1]:null},{cell:o||e[2],component:o?e[2]:null}]})}))))))},a.state={trafficTooltip:!1},a}return Object(l.a)(t,e),t}(z.a.Component),qr=Object(K.withStyles)(function(){return{drawerContent:{padding:20},sideBarContentTitle:{fontSize:14,fontWeight:500,display:"inline-flex",paddingLeft:10},titleIcon:{verticalAlign:"middle"},sidebarTableCell:{padding:10},avatar:{width:25,height:25,fontSize:10,fontWeight:600,color:"#fff"},sidebarContainer:{marginBottom:30},expansionSum:{padding:0,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:ua.a[300]},cellIcon:{verticalAlign:"middle"},panel:{marginTop:15,boxShadow:"none",borderTopWidth:1,borderTopStyle:"solid",borderTopColor:ua.a[200]},secondaryHeading:{paddingRight:10},panelDetails:{padding:0,marginBottom:100},sidebarListTableText:{fontSize:12},listIcon:{width:20},cellNameContainer:{marginTop:10,marginBottom:25},cellName:{display:"inline-flex",paddingLeft:10},barChart:{marginTop:20},titleDivider:{height:1,border:"none",flexShrink:0,backgroundColor:"#d1d1d1"}}},{withTheme:!0})(le(at(Ur))),Vr=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).getCellState=function(e){return a.defaultState.healthInfo.find(function(t){return t.nodeId===e}).status},a.onClickCell=function(e,t){var n=a.props,r=n.globalState,o=n.history,l=n.match,s=n.location,c=ze.parseTime(r.get(ae.GLOBAL_FILTER).startTime),u=ze.parseTime(r.get(ae.GLOBAL_FILTER).endTime),d=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(s.search),{cell:e}));o.replace(l.url+d,Object(i.a)({},s.state));var m={queryStartTime:c.valueOf(),queryEndTime:u.valueOf(),timeGranularity:ze.getTimeGranularity(c,u)};t&&lt.showLoadingOverlay("Loading ".concat(e," Cell Information"),r),_.callObservabilityAPI({url:"/http-requests/cells/".concat(e,"/components").concat(_.generateQueryParamString(m)),method:"GET"},a.props.globalState).then(function(n){var o=a.state.data.nodes.find(function(t){return t.id===e}),l=a.getComponentHealth(o.components,n),s=a.getHealthCount(l),c=a.getStatusCodeContent(e,a.defaultState.request.cellStats),u=a.loadComponentsInfo(o.components,l);a.setState(function(t){return{summary:Object(i.a)({},t.summary,{topic:e,content:[{key:"Total",value:u.length},{key:"Successful",value:s.success},{key:"Failed",value:s.error},{key:"Warning",value:s.warning}]}),data:Object(i.a)({},t.data),listData:u,selectedCell:o.id,request:Object(i.a)({},t.request,{statusCodes:c})}}),t&&lt.hideLoadingOverlay(r)}).catch(function(n){a.setState({error:n}),t&&(lt.hideLoadingOverlay(r),lt.showNotification("Failed to load ".concat(e," request statistics"),lt.Levels.ERROR,r))})},a.getComponentHealth=function(e,t){var n=a.props.globalState.get(ae.CONFIG),r=[];return e.forEach(function(e){var o=a.getTotalComponentRequests(e,t,"*");if(0===o)r.push({nodeId:e,status:J.Status.Success,percentage:1});else{var l=1-a.getTotalComponentRequests(e,t,"5xx")/o;l>n.percentageRangeMinValue.warningThreshold?r.push({nodeId:e,status:J.Status.Success,percentage:l}):l>n.percentageRangeMinValue.errorThreshold?r.push({nodeId:e,status:J.Status.Warning,percentage:l}):r.push({nodeId:e,status:J.Status.Error,percentage:l})}}),r},a.onClickGraph=function(){var e=a.props,t=e.history,n=e.match,r=e.location,o=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(r.search),{cell:void 0}));t.replace(n.url+o,Object(i.a)({},r.state));var l=JSON.parse(JSON.stringify(a.defaultState));a.setState(function(e){return Object(i.a)({},e,{summary:l.summary,listData:a.loadCellInfo(l.data.nodes),selectedCell:null,request:l.request})})},a.handleDrawerOpen=function(){a.setState({open:!0})},a.handleDrawerClose=function(){a.setState({open:!1})},a.loadCellInfo=function(e){var t=[];return e.forEach(function(e){var n=a.defaultState.healthInfo.find(function(t){return t.nodeId===e.id});t.push([n.percentage,e.id,e.id])}),t},a.loadComponentsInfo=function(e,t){var a=[];return e.forEach(function(e){var n=t.find(function(t){return t.nodeId===e});a.push([n.percentage,e,e])}),a},a.callOverviewInfo=function(e,t,n){var r=a.props,o=r.colorGenerator,l=r.globalState,s=a.state.selectedCell,c=Object(R.a)(Object(R.a)(a)),u={};t&&n&&(u.queryStartTime=t.valueOf(),u.queryEndTime=n.valueOf()),e&&lt.showLoadingOverlay("Loading Cell Dependencies",l),_.callObservabilityAPI({url:"/dependency-model/cells".concat(_.generateQueryParamString(u)),method:"GET"},l).then(function(t){var a=t.nodes,n=t.edges;c.defaultState.healthInfo=c.getCellHealth(a);var r=c.getHealthCount(c.defaultState.healthInfo),u=[{key:"Total",value:a.length},{key:"Successful",value:r.success},{key:"Failed",value:r.error},{key:"Warning",value:r.warning}];c.defaultState.summary.content=u,c.defaultState.data.nodes=a,c.defaultState.data.edges=n,o.addKeys(a);var d=c.loadCellInfo(a);c.setState(function(e){return{data:{nodes:a,edges:n},summary:Object(i.a)({},e.summary,{content:u}),listData:d,isLoading:!1}}),e&&lt.hideLoadingOverlay(l),s&&c.onClickCell(s,e)}).catch(function(t){c.setState({error:t}),e&&(lt.hideLoadingOverlay(l),lt.showNotification("Failed to load Cell Dependencies",lt.Levels.ERROR,l))})},a.getHealthCount=function(e){var t=0,a=0,n=0;return e.forEach(function(e){e.status===J.Status.Success?t+=1:e.status===J.Status.Warning?a+=1:n+=1}),{success:t,warning:a,error:n}},a.getCellHealth=function(e){var t=a.props.globalState.get(ae.CONFIG),n=[];return e.forEach(function(e){var r=a.getTotalRequests(e.id,a.defaultState.request.cellStats,"*");if(0===r)n.push({nodeId:e.id,status:J.Status.Success,percentage:1});else{var o=1-a.getTotalRequests(e.id,a.defaultState.request.cellStats,"5xx")/r;o>t.percentageRangeMinValue.warningThreshold?n.push({nodeId:e.id,status:J.Status.Success,percentage:o}):o>t.percentageRangeMinValue.errorThreshold?n.push({nodeId:e.id,status:J.Status.Warning,percentage:o}):n.push({nodeId:e.id,status:J.Status.Error,percentage:o})}}),n},a.loadOverviewOnTimeUpdate=function(e,t,n){var r=a.props.globalState,o={queryStartTime:t.valueOf(),queryEndTime:n.valueOf(),timeGranularity:ze.getTimeGranularity(t,n)};e&&lt.showLoadingOverlay("Loading Cell Metadata",r),_.callObservabilityAPI({url:"/http-requests/cells".concat(_.generateQueryParamString(o)),method:"GET"},a.props.globalState).then(function(o){var l=a.getStatusCodeContent(null,o);a.defaultState.request.statusCodes=l,a.defaultState.request.cellStats=o,a.setState(function(e){return{stats:{cellStats:o},request:Object(i.a)({},e.request,{statusCodes:l})}}),e&&lt.hideLoadingOverlay(r),a.callOverviewInfo(e,t,n)}).catch(function(t){a.setState({error:t}),e&&(lt.hideLoadingOverlay(r),lt.showNotification("Failed to load Cell Metadata",lt.Levels.ERROR,r))})},a.getStatusCodeContent=function(e,t){var n=a.getTotalRequests(e,t,"*"),r=a.getTotalRequests(e,t,"2xx"),o=a.getTotalRequests(e,t,"3xx"),l=a.getTotalRequests(e,t,"4xx"),i=a.getTotalRequests(e,t,"5xx"),s=n-(r+o+l+i);return[{key:"Total",value:n},{key:"OK",count:r,value:a.getPercentage(r,n)},{key:"3xx",count:o,value:a.getPercentage(o,n)},{key:"4xx",count:l,value:a.getPercentage(l,n)},{key:"5xx",count:i,value:a.getPercentage(i,n)},{key:"Unknown",count:s,value:a.getPercentage(s,n)}]},a.getPercentage=function(e,t){return 0!==t?Math.round(e/t*100):0},a.getTotalRequests=function(e,t,a){var n=0;return t.forEach(function(t){""!==t[1]&&(e&&e!==t[1]||("*"===a?n+=t[4]:a===t[2]&&(n+=t[4])))}),n},a.getTotalComponentRequests=function(e,t,a){var n=0;return t.forEach(function(t){""!==t[2]&&(e&&e!==t[2]||("*"===a?n+=t[6]:a===t[4]&&(n+=t[6])))}),n},a.handleClick=function(e){var t=e.currentTarget;a.setState(function(e){return{legend:t,legendOpen:!e.legendOpen}})},a.render=function(){var e=a.props,t=e.classes,n=e.theme,r=e.colorGenerator,o=a.state,l=o.open,i=o.selectedCell,s=o.legend,c=o.legendOpen,u=o.isLoading,d=c?"legend-popper":null,m=a.props.globalState.get(ae.CONFIG).percentageRangeMinValue,p=a.state.data.nodes&&a.state.data.nodes.length>0,g=a.state.data.nodes,f=a.state.data.edges;return z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:"Overview",onUpdate:a.loadOverviewOnTimeUpdate}),u?null:z.a.createElement("div",{className:t.root},z.a.createElement(Yn.a,{className:$e()(t.content,Object(C.a)({},t.contentShift,l))},p?z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:t.graphContainer},z.a.createElement("div",{className:t.diagram},z.a.createElement(Yt,{id:"graph-id",nodeData:g,edgeData:f,onClickNode:function(e){return a.onClickCell(e,!0)},viewGenerator:function(e,t){var n,o=Oe.shadeColor(r.getColor(e),t),l=Oe.shadeColor(o,-.08),s=Oe.shadeColor(r.getColor(Oe.ERROR),t),c=Oe.shadeColor(r.getColor(Oe.WARNING),t),u=a.getCellState(e),d='<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 14 14">'+'<path fill="'.concat(o,'"  stroke="').concat(i===e?"#444":l,'" stroke-opacity="').concat(1-t,'" ')+' stroke-width="0.5px" d="M8.92.84H5a1.45,1.45,0,0,0-1,.42L1.22,4a1.43,1.43,0,0,0-.43,1V9a1.43,1.43,0,0,0,.43,1L4,12.75a1.4,1.4,0,0,0,1,.41H8.92a1.4,1.4,0,0,0,1-.41L12.72,10a1.46,1.46,0,0,0,.41-1V5a1.46,1.46,0,0,0-.41-1L9.94,1.25A1.44,1.44,0,0,0,8.92.84Z" transform="translate(-0.54 -0.37)"/></svg>',m='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><g>'+'<path fill="'.concat(o,'" stroke="').concat(i===e?"#444":l,'" stroke-opacity="').concat(1-t,'" ')+' stroke-width="0.5px" d="M8.92.84H5a1.45,1.45,0,0,0-1,.42L1.22,4a1.43,1.43,0,0,0-.43,1V9a1.43,1.43,0,0,0,.43,1L4,12.75a1.4,1.4,0,0,0,1,.41H8.92a1.4,1.4,0,0,0,1-.41L12.72,10a1.46,1.46,0,0,0,.41-1V5a1.46,1.46,0,0,0-.41-1L9.94,1.25A1.44,1.44,0,0,0,8.92.84Z" transform="translate(-0.54 -0.37)"/></g>'+'<path fill="'.concat(s,'" d="M11.17.5a2.27,2.27,0,1,0,2.26,2.26A2.27,2.27,0,0,0,11.17.5Z" transform="translate(-0.54 -0.37)"/>')+'<path fill="#fff" d="M11.17,5.15a2.39,2.39,0,1,1,2.38-2.39A2.39,2.39,0,0,1,11.17,5.15Zm0-4.53A2.14,2.14,0,1,0,13.3,2.76,2.14,2.14,0,0,0,11.17.62Z" transform="translate(-0.54 -0.37)"/><path fill="#fff" d="M10.86,3.64h.61v.61h-.61Zm0-2.44h.61V3h-.61Z" transform="translate(-0.54 -0.37)"/></svg>',p='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><g>'+'<path fill="'.concat(o,'" stroke="').concat(i===e?"#444":l,'" stroke-opacity="').concat(1-t,'" ')+'stroke-width="0.5px" d="M8.92.84H5a1.45,1.45,0,0,0-1,.42L1.22,4a1.43,1.43,0,0,0-.43,1V9a1.43,1.43,0,0,0,.43,1L4,12.75a1.4,1.4,0,0,0,1,.41H8.92a1.4,1.4,0,0,0,1-.41L12.72,10a1.46,1.46,0,0,0,.41-1V5a1.46,1.46,0,0,0-.41-1L9.94,1.25A1.44,1.44,0,0,0,8.92.84Z" transform="translate(-0.54 -0.37)"/></g>'+'<path fill="'.concat(c,'" d="M11.17.5a2.27,2.27,0,1,0,2.26,2.26A2.27,2.27,0,0,0,11.17.5Z" transform="translate(-0.54 -0.37)"/>')+'<path fill="#fff" d="M11.17,5.15a2.39,2.39,0,1,1,2.38-2.39A2.39,2.39,0,0,1,11.17,5.15Zm0-4.53A2.14,2.14,0,1,0,13.3,2.76,2.14,2.14,0,0,0,11.17.62Z" transform="translate(-0.54 -0.37)"/><path fill="#fff" d="M10.86,3.64h.61v.61h-.61Zm0-2.44h.61V3h-.61Z" transform="translate(-0.54 -0.37)"/></svg>';return n=u===J.Status.Success?d:u===J.Status.Warning?p:m,"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n))},onClickGraph:a.onClickGraph,selectedCell:i,graphType:"overview"}))),z.a.createElement(mn.a,{"aria-describedby":d,variant:"outlined",className:t.btnLegend,onClick:a.handleClick},"Legend")):z.a.createElement(Z,{title:"No Cells Found",description:"No Requests were sent within the selected time range"}),z.a.createElement(Lr.a,{id:d,open:c,anchorEl:s,placement:"top-end",transition:!0},function(e){var a=e.TransitionProps;return z.a.createElement(Or.a,Object.assign({},a,{timeout:350}),z.a.createElement(Yn.a,null,z.a.createElement("div",{className:t.legendContent},z.a.createElement(Er,{className:t.legendFirstEl,color:"action",fontSize:"small"}),z.a.createElement(Ja.a,{color:"inherit",className:t.legendText}," Cell"),z.a.createElement(vr.a,{className:t.legendIcon,color:"action"}),z.a.createElement(Ja.a,{color:"inherit",className:t.legendText}," Dependency"),z.a.createElement(h.a,{className:t.legendIcon,style:{color:r.getColor(Oe.WARNING)}}),z.a.createElement(Ja.a,{color:"inherit",className:t.legendText},Math.round(100*(1-m.warningThreshold)),"% - ",Math.round(100*(1-m.errorThreshold)),"% Error "),z.a.createElement(h.a,{className:t.legendIcon,color:"error"}),z.a.createElement(Ja.a,{color:"inherit",className:t.legendText},">",Math.round(100*(1-m.errorThreshold)),"% Error"))))})),p?z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:$e()(t.moreDetails,Object(C.a)({},t.moreDetailsShift,l))},z.a.createElement(v.a,{color:"inherit","aria-label":"Open drawer",onClick:a.handleDrawerOpen,className:$e()(t.menuButton,l&&t.hide)},z.a.createElement(yr.a,null))),z.a.createElement(Cr.a,{className:t.drawer,variant:"persistent",anchor:"right",open:l,classes:{paper:t.drawerPaper}},z.a.createElement("div",{className:t.drawerHeader},z.a.createElement(v.a,{onClick:a.handleDrawerClose},"rtl"===n.direction?z.a.createElement(ct.a,null):z.a.createElement(dt.a,null)),z.a.createElement(Ja.a,{color:"textSecondary",className:t.sideBarHeading},i?"Cell Details":"Overview")),z.a.createElement(On.a,null),z.a.createElement(qr,{summary:a.state.summary,request:a.state.request,selectedCell:i,open:a.state.open,listData:a.state.listData}))):null))},a.defaultState={summary:{topic:"Cellery Deployment",content:[{key:"Total",value:0},{key:"Successful",value:0},{key:"Failed",value:0},{key:"Warning",value:0}]},request:{statusCodes:[{key:"Total",value:0},{key:"OK",value:0},{key:"3xx",value:0},{key:"4xx",value:0},{key:"5xx",value:0},{key:"Unknown",value:0}],cellStats:[]},healthInfo:[],selectedCell:null,data:{nodes:null,edges:null},error:null,open:!0,legend:null,legendOpen:!1,listData:[],page:0,rowsPerPage:5};var l=_.parseQueryParams(e.location.search);return a.state=Object(i.a)({},JSON.parse(JSON.stringify(a.defaultState)),{selectedCell:l.cell?l.cell:null,isLoading:!0}),a}return Object(l.a)(t,e),t}(z.a.Component),zr=Object(K.withStyles)(function(e){return{root:{display:"flex"},moreDetails:{position:"absolute",right:25,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},moreDetailsShift:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginTop:8,marginRight:8},hide:{display:"none"},drawer:{width:300,flexShrink:0},drawerPaper:{top:135,width:300,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:ua.a[200]},drawerHeader:{display:"flex",alignItems:"center",padding:5,justifyContent:"flex-start",textTransform:"uppercase",minHeight:"fit-content"},content:{flexGrow:1,padding:3*e.spacing.unit,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:Number(e.spacing.unit),marginRight:-300+e.spacing.unit},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:e.spacing.unit},sideBarHeading:{letterSpacing:1,fontSize:12,marginLeft:4},btnLegend:{float:"right",position:"sticky",bottom:20,marginTop:10,fontSize:12},legendContent:{padding:2*e.spacing.unit},legendText:{display:"inline-flex",marginLeft:5,fontSize:12},legendIcon:{verticalAlign:"middle",marginLeft:20},legendFirstEl:{verticalAlign:"middle"},graphContainer:{display:"flex"},diagram:{padding:3*e.spacing.unit,flexGrow:1}}},{withTheme:!0})(le(at(Vr))),Hr=a(350),Wr=a.n(Hr),Qr=J.Dashboard.APIM_HOSTNAME,Yr=function(e){function t(){var e,a;Object(n.a)(this,t);for(var l=arguments.length,i=new Array(l),s=0;s<l;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(i)))).handleLogin=function(){var e=a.props.globalState,t=document.getElementById("username").value;se.signIn(t,e)},a.handleKeyPress=function(e){"Enter"===e.key&&a.handleLogin()},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props.classes;return z.a.createElement(z.a.Fragment,{className:e.progress},z.a.createElement("div",{className:e.centerDiv},z.a.createElement(A.a,null),z.a.createElement("div",null,"Loading")))}},{key:"componentDidMount",value:function(){var e=window.location.search.substr(1),t=new URLSearchParams(e),a=this.props.globalState;if(null===localStorage.getItem("isAuthenticated")||null===localStorage.getItem(ae.USER))if("true"!==localStorage.getItem("isAuthenticated")&&"codeAuthorized"!==localStorage.getItem("isAuthenticated"))localStorage.setItem("isAuthenticated","true"),_.callObservabilityAPI({url:"/user-auth/getCredentials/client",method:"GET"},a).then(function(e){window.location.href="https://".concat(Qr,"/oauth2/authorize?response_type=code")+"&client_id=".concat(e,"&")+"redirect_uri=http://cellery-dashboard&nonce=abc&scope=openid"}).catch(function(e){localStorage.setItem("error2",e.toString())});else if("true"!==localStorage.getItem("isAuthenticated")||t.has("code")){if(t.has("code")&&"codeAuthorized"!==localStorage.getItem("isAuthenticated")){var n=t.get("code");_.callObservabilityAPI({url:"/user-auth/requestToken/".concat(n),method:"GET"},a).then(function(e){localStorage.setItem("idToken",e);var t=Wr()(e);localStorage.setItem("decoded",t.toString());var n={username:t.sub};se.signIn(n.username,a)}).catch(function(e){localStorage.setItem("error",e.toString())})}}else _.callObservabilityAPI({url:"/user-auth/getCredentials/client",method:"GET"},a).then(function(e){window.location.href="https://".concat(Qr,"/oauth2/authorize?response_type=code")+"&client_id=".concat(e,"&")+"redirect_uri=http://cellery-dashboard&nonce=abc&scope=openid"}).catch(function(e){localStorage.setItem("error2",e.toString())});else"loggedOut"===localStorage.getItem("isAuthenticated")&&(localStorage.removeItem(ae.USER),window.location.href="https://".concat(Qr,"/oidc/logout?id_token_hint=\n            ").concat(localStorage.getItem("idToken"),"&post_logout_redirect_uri=http://cellery-dashboard"))}}]),t}(z.a.Component),Kr=qa()(function(e){return{layout:Object(C.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},heading:{margin:e.spacing.unit,paddingTop:2*e.spacing.unit},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit},centerDiv:{position:"absolute",margin:"auto",top:0,right:0,bottom:0,left:0,width:"200px",height:"100px"}}})(le(Yr)),Zr=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).getChangeHandlerForNumber=function(e){return function(t){var n=a.props.onDurationUpdate,r=""===t.target.value?void 0:parseFloat(t.target.value);void 0!==r&&isNaN(r)||a.setState(function(t){var a=Object(i.a)({},t,Object(C.a)({},e,r));return n&&n(a),a})}},a.state={duration:e.defaultDuration,durationMultiplier:e.defaultDurationMultiplier},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.label,n=e.durationInputId,r=e.durationMultiplierInputId,o=this.state,l=o.duration,i=o.durationMultiplier;return z.a.createElement(wn.a,{id:n,value:l||"",type:"number",className:t.durationTextField,placeholder:"Eg: 1,000",onChange:this.getChangeHandlerForNumber("duration"),InputProps:{startAdornment:z.a.createElement(kn.a,{className:t.startInputAdornment,variant:"filled",position:"start"},a),endAdornment:z.a.createElement(kn.a,{variant:"filled",position:"end"},z.a.createElement(Gn.a,{value:i,onChange:this.getChangeHandlerForNumber("durationMultiplier"),inputProps:{name:r,id:r}},z.a.createElement(Be.a,{value:1},"ms"),z.a.createElement(Be.a,{value:1e3},"s")))}})}}]),t}(z.a.Component),Xr=qa()(function(e){return{durationTextField:{marginTop:2*e.spacing.unit},startInputAdornment:{marginRight:2*e.spacing.unit,marginBottom:2*e.spacing.unit}}})(Zr),Jr=function(){function e(t){var a=this;Object(n.a)(this,e),this.isSiblingOf=function(e){return Boolean(e)&&a.traceId===e.traceId&&a.spanId===e.spanId&&(a.kind===J.Span.Kind.CLIENT&&e.kind===J.Span.Kind.SERVER||a.kind===J.Span.Kind.SERVER&&e.kind===J.Span.Kind.CLIENT)},this.isParentOf=function(e){var t=!1;return Boolean(e)&&a.traceId===e.traceId&&(a.spanId===e.spanId?a.kind===J.Span.Kind.CLIENT&&e.kind===J.Span.Kind.SERVER&&(t=!0):a.spanId===e.parentId&&(t=!0,a.hasSibling()&&a.kind!==J.Span.Kind.SERVER&&(t=!1),e.hasSibling()&&e.kind!==J.Span.Kind.CLIENT&&(t=!1))),t},this.hasSibling=function(){return a.kind===J.Span.Kind.CLIENT||a.kind===J.Span.Kind.SERVER},this.addSpanReference=function(e){var t=!1;return a.isParentOf(e)?(a.children.add(e),t=!0):Boolean(e)&&e.isParentOf(a)&&(a.parent=e,t=!0),a.isSiblingOf(e)&&(a.sibling=e,t=!0),t},this.resetSpanReferences=function(){a.children.clear(),a.parent=null,a.sibling=null,a.treeDepth=0},this.getUniqueId=function(){return"".concat(a.traceId,"--").concat(a.spanId).concat(a.kind?"--".concat(a.kind):"")},this.isFromCellGateway=function(){return Boolean(a.cell)&&Boolean(a.cell.name)&&J.Cell.GATEWAY_NAME_PATTERN.test(a.serviceName)},this.isFromIstioSystemComponent=function(){return J.System.ISTIO_MIXER_NAME_PATTERN.test(a.serviceName)},this.isFromSideCar=function(){return"proxy"===a.tags.component},this.isFromCellerySystemComponent=function(){return a.isFromCellGateway()||J.System.GLOBAL_GATEWAY_NAME_PATTERN.test(a.serviceName)||J.System.SIDECAR_AUTH_FILTER_OPERATION_NAME_PATTERN.test(a.operationName)},this.hasError=function(){return!0===a.tags.error||"true"===a.tags.error},this.shallowClone=function(){var t=new e({traceId:a.traceId,spanId:a.spanId,parentId:a.parentId,serviceName:a.serviceName,operationName:a.operationName,kind:a.kind,startTime:a.startTime,duration:a.duration});return t.tags=Object(i.a)({},a.tags),t.componentType=a.componentType,t.cell=Object(i.a)({},a.cell),t},this.serviceName=t.serviceName,this.operationName=t.operationName,this.kind=t.kind?t.kind.toUpperCase():null,this.startTime=t.startTime,this.duration=t.duration,this.tags=t.tags?JSON.parse(t.tags):{},this.traceId=t.traceId,this.spanId=t.spanId,this.parentId=t.parentId;var r=function(e,n){t[n]&&(a.tags[e]=t[[n]])};r("k8s.pod","pod"),r("k8s.namespace","namespace"),this.componentType="",this.cell=t.cell?{name:t.cell,version:null}:null,this.parent=null,this.children=new Set,this.sibling=null,this.treeDepth=null}return Object(T.a)(e,[{key:"walk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!n||!n(this)){var r;e&&(r=e(this,t));for(var o=[],l=this.children.values(),i=l.next();!i.done;)o.push(i.value),i=l.next();o.sort(function(e,t){return e.startTime-t.startTime});for(var s=0;s<o.length;s++)o[s].walk(e,r,a,n);a&&a(this)}}}]),e}(),$r=a(351),eo=a.n($r),to=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleTagsTempInputUpdate=function(e){var n=e.currentTarget.value;a.setState({tagsTempInput:{content:n,errorMessage:!n||t.parseChip(n)?"":'Invalid tag filter format. Expected "tagKey=tagValue"'}})},a.handleTagAdd=function(e){var n=a.props.onTagsUpdate,r=t.parseChip(e);r&&a.setState(function(e){var t=Object(i.a)({},e.tags,Object(C.a)({},r.key,r.value));return n&&n(t),{tags:t,tagsTempInput:Object(i.a)({},e.tagsTempInput,{content:"",errorMessage:""})}})},a.handleTagRemove=function(e){var n=a.props.onTagsUpdate,r=t.parseChip(e);r&&a.setState(function(e){var t=Object(i.a)({},e.tags);return Reflect.deleteProperty(t,r.key),n&&n(t),{tags:t}})},a.state={tagsTempInput:{content:"",errorMessage:""},tags:e.defaultTags},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this,a=this.state,n=a.tagsTempInput,r=a.tags,o=[];for(var l in r)r.hasOwnProperty(l)&&o.push("".concat(l,"=").concat(r[l]));var i=n.content?"Press Enter to Add the Tag":null;return z.a.createElement(eo.a,{label:"Tags",InputLabelProps:{shrink:!0},onBeforeAdd:function(e){return Boolean(t.parseChip(e))},error:Boolean(n.errorMessage),helperText:n.errorMessage?n.errorMessage:i,onAdd:this.handleTagAdd,placeholder:"Eg: http.status_code=200",value:o,onUpdateInput:this.handleTagsTempInputUpdate,inputValue:n.content,onDelete:this.handleTagRemove,onBlur:function(){return e.setState({tagsTempInput:{content:"",errorMessage:""}})}})}}]),t}(z.a.Component);to.parseChip=function(e){var t=null;if(e){var a=e.split("=");2===a.length&&a[0]&&a[1]&&(t={key:a[0].trim(),value:a[1].trim()})}return t};var ao=to,no=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).render=function(){var e=a.props,t=e.classes,n=e.location,r=a.state,o=r.data,l=r.filter,i=r.metaData,s=r.isLoading,c=_.parseQueryParams(n.search),u=!0;for(var d in c)c.hasOwnProperty(d)&&c[d]&&(u=!1);var m=function(e){return e.map(function(e){return z.a.createElement(Be.a,{key:e,value:e},e)})};return z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:"Distributed Tracing",onUpdate:a.onGlobalRefresh}),s?null:z.a.createElement(Ge.a,{className:t.container},z.a.createElement(Xe.a,{variant:"h6",color:"inherit",className:t.subheading},"Search Traces"),z.a.createElement(D.a,{container:!0,justify:"flex-start",className:t.searchForm},z.a.createElement(D.a,{container:!0,justify:"flex-start",spacing:24},z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(In.a,{htmlFor:"cell",shrink:!0},"Cell"),z.a.createElement(Gn.a,{value:l.cell,inputProps:{name:"cell",id:"cell"},onChange:a.getChangeHandlerForString("cell")},z.a.createElement(Be.a,{key:J.Dashboard.ALL_VALUE,value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),m(o.cells)))),z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(In.a,{htmlFor:"component",shrink:!0},"Component"),z.a.createElement(Gn.a,{value:l.component,onChange:a.getChangeHandlerForString("component"),inputProps:{name:"component",id:"component"}},z.a.createElement(Be.a,{key:J.Dashboard.ALL_VALUE,value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),m(i.availableComponents)))),z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(In.a,{htmlFor:"operation",shrink:!0},"Operation"),z.a.createElement(Gn.a,{value:l.operation,onChange:a.getChangeHandlerForString("operation"),inputProps:{name:"operation",id:"operation"}},z.a.createElement(Be.a,{key:J.Dashboard.ALL_VALUE,value:J.Dashboard.ALL_VALUE},J.Dashboard.ALL_VALUE),m(i.availableOperations)))))),z.a.createElement(D.a,{container:!0,justify:"flex-start",spacing:24,className:t.searchForm},z.a.createElement(D.a,{item:!0,xs:6},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(ao,{onTagsUpdate:a.handleTagsUpdate,defaultTags:l.tags}))),z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(In.a,{htmlFor:"min-duration-input",shrink:!0},"Duration"),z.a.createElement(Xr,{onDurationUpdate:a.handleMinDurationUpdate,label:"Min",durationInputId:"min-duration-input",defaultDuration:l.minDuration,defaultDurationMultiplier:l.minDurationMultiplier}))),z.a.createElement(D.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl,fullWidth:!0},z.a.createElement(Xr,{onDurationUpdate:a.handleMaxDurationUpdate,label:"Max",durationInputId:"max-duration-input",defaultDuration:l.maxDuration,defaultDurationMultiplier:l.maxDurationMultiplier})))),z.a.createElement(mn.a,{variant:"contained",color:"primary",onClick:a.onSearchButtonClick,disabled:0===o.cells.length},"Search"),o.cells.length>0?z.a.createElement("div",{className:t.resultContainer},z.a.createElement(za,{innerRef:a.tracesListRef,filter:l,onTraceClick:a.onTraceClick,loadTracesOnMount:!u})):z.a.createElement(Z,{title:"No Traces Available",description:"No Traces are available in the Selected Time Range. This is because no requests were sent/received during this time period."})))},a.onTraceClick=function(e,t,n){a.props.history.push({pathname:"./id/".concat(e),state:{selectedComponent:{cellName:t,serviceName:n}}})},a.onSearchButtonClick=function(){var e=a.props,t=e.history,n=e.match,r=e.location,o=a.state.filter,l=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(r.search),o,{tags:JSON.stringify(o.tags)}));t.replace(n.url+l,Object(i.a)({},r.state)),a.search(!0)},a.onGlobalRefresh=function(e,t,n){a.state.hasSearchCompleted&&a.search(e),a.loadCellData(e&&!a.state.hasSearchCompleted,t,n)},a.loadCellData=function(e,t,n){var r=a.props.globalState,o=Object(R.a)(Object(R.a)(a)),l={queryStartTime:t.valueOf(),queryEndTime:n.valueOf()};e&&(lt.showLoadingOverlay("Loading Cell Information",r),o.setState({isLoading:!0})),_.callObservabilityAPI({url:"/traces/metadata".concat(_.generateQueryParamString(l)),method:"GET"},r).then(function(t){for(var a=[],n=[],l=[],s=t.map(function(e){return{cell:e[0],serviceName:e[1],operationName:e[2]}}),c=0;c<s.length;c++){var u=new Jr(s[c]),d=u.cell,m=d?d.name:null,p=u.serviceName,g=u.operationName;m&&(a.includes(m)||a.push(m),n.map(function(e){return e.name}).includes(p)||n.push({name:p,cell:m}),l.map(function(e){return e.name}).includes(g)||l.push({name:g,component:p,cell:m}))}o.setState(function(e){return Object(i.a)({},e,{data:{cells:a,components:n,operations:l}})}),e&&(lt.hideLoadingOverlay(r),o.setState({isLoading:!1}))}).catch(function(){e&&(lt.hideLoadingOverlay(r),o.setState({isLoading:!1}),lt.showNotification("Failed to load Cell Data",lt.Levels.ERROR,r))})},a.getChangeHandlerForString=function(e){return function(t){var n=t.target.value;a.setState(function(t){return Object(i.a)({},t,{filter:Object(i.a)({},t.filter,Object(C.a)({},e,n))})})}},a.handleMinDurationUpdate=function(e){var t=e.duration,n=e.durationMultiplier;a.setState(function(e){return{filter:Object(i.a)({},e.filter,{minDuration:t,minDurationMultiplier:n})}})},a.handleMaxDurationUpdate=function(e){var t=e.duration,n=e.durationMultiplier;a.setState(function(e){return{filter:Object(i.a)({},e.filter,{maxDuration:t,maxDurationMultiplier:n})}})},a.handleTagsUpdate=function(e){a.setState(function(t){return{filter:Object(i.a)({},t.filter,{tags:e})}})},a.search=function(e){a.tracesListRef.current&&a.tracesListRef.current.loadTraces&&a.tracesListRef.current.loadTraces(e)};var l=e.location,s=_.parseQueryParams(l.search);return a.state={data:{cells:[],components:[],operations:[]},filter:{cell:s.cell?s.cell:J.Dashboard.ALL_VALUE,component:s.component?s.component:J.Dashboard.ALL_VALUE,operation:s.operation?s.operation:J.Dashboard.ALL_VALUE,tags:s.tags?JSON.parse(s.tags):{},minDuration:s.minDuration?parseInt(s.minDuration,10):void 0,minDurationMultiplier:s.minDurationMultiplier?parseInt(s.minDurationMultiplier,10):1,maxDuration:s.maxDuration?parseInt(s.maxDuration,10):void 0,maxDurationMultiplier:s.maxDurationMultiplier?parseInt(s.maxDurationMultiplier,10):1},metaData:{availableComponents:[],availableOperations:[]},isLoading:!1,hasSearchCompleted:!1},a.tracesListRef=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.Component);no.getDerivedStateFromProps=function(e,t){var a=t.data,n=t.filter,r=t.metaData,o=n.cell===J.Dashboard.ALL_VALUE?a.cells:[n.cell],l=a.components.filter(function(e){return o.includes(e.cell)}).map(function(e){return e.name}),s=0===a.cells.length||n.component&&l.includes(n.component)?n.component:J.Dashboard.ALL_VALUE,c=s===J.Dashboard.ALL_VALUE?l:[s],u=a.operations.filter(function(e){return c.includes(e.component)}).map(function(e){return e.name}),d=0===a.cells.length||n.operation&&u.includes(n.operation)?n.operation:J.Dashboard.ALL_VALUE;return Object(i.a)({},t,{filter:Object(i.a)({},n,{component:s,operation:d}),metaData:Object(i.a)({},r,{availableComponents:l,availableOperations:u})})};var ro=qa()(function(e){return{container:{flexGrow:1,padding:3*e.spacing.unit,margin:e.spacing.unit},subheading:{marginBottom:2*e.spacing.unit},formControl:{marginBottom:2*e.spacing.unit},searchForm:{marginBottom:Number(e.spacing.unit)},resultContainer:{marginTop:3*e.spacing.unit}}})(le(no)),oo=a(186),lo=a.n(oo),io=function(){function e(){Object(n.a)(this,e)}return Object(T.a)(e,null,[{key:"addTreeConnections",value:function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<e.length;n++)a!==n&&e[a].addSpanReference(e[n]);for(var r=0;r<e.length;r++){var o=e[r];if(!o.parent&&o!==t)for(var l=0;l<e.length;l++)if(e[l].spanId===o.parentId){o.parent=e[l],e[l].children.add(o);break}}}}]),e}();io.buildTree=function(e){var t,a=e.map(function(e){return e.spanId}),n=e.filter(function(e){return e.spanId===e.traceId||!a.includes(e.parentId)});if(1===n.length)t=n[0];else{if(2!==n.length)throw Error("Invalid Trace: Expected 1 root span, but found ".concat(n.length," root spans"));var r;if(!n[0].isSiblingOf(n[1]))throw Error("Invalid Trace: Expected 1 root span, but found two non-sibling root spans.");r=n[0].isParentOf(n[1])?0:1,t=n[r],n[0].sibling=n[1],n[1].sibling=n[0]}for(var o=0;o<e.length;o++){for(var l=e[o],i=!1,s=!1,c=0;c<e.length;c++){var u=e[c];if(o!==c&&!l.isFromSideCar()&&l.cell===u.cell&&l.serviceName===u.serviceName&&(l.parentId===u.spanId&&(i=!0),l.spanId===u.parentId&&(s=!0),s&&i))break}s&&i&&(l.kind=null)}return io.addTreeConnections(e,t),t},io.labelSpanTree=function(e){e.walk(function(e){e.isFromIstioSystemComponent()||e.isFromCellerySystemComponent()?e.componentType=J.CelleryType.SYSTEM:e.componentType=J.CelleryType.COMPONENT},null),e.walk(function(e,t){return e.treeDepth=t,t+1},0)},io.getTreeRoot=function(e){var t=e.filter(function(e){return null===e.parent});if(1!==e.length&&t.length===e.length)throw Error("The spans in the list does not contain a tree structure");if(1!==t.length)throw Error("Invalid Trace Tree: Expected 1 root span, found ".concat(t.length," spans"));return t[0]},io.getOrderedList=function(e){var t=[];return e.walk(function(e){t.push(e)}),t},io.resetTreeSpanReferences=function(e){for(var t=0;t<e.length;t++)e[t].resetSpanReferences()},io.removeSpanFromTree=function(e){var t=e.parent;t&&t.children.delete(e),e.children.forEach(function(e){t&&t.children.add(e),e.parent=t}),e.sibling&&(e.sibling.sibling=null)};var so=io,co=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleClick=function(e){var t=e.currentTarget;a.setState(function(e){return{legend:t,legendOpen:!e.legendOpen}})},a.render=function(){var e=a.props,n=e.classes,r=e.spans,o=e.colorGenerator,l=a.state,i=l.legend,s=l.legendOpen,c=so.getTreeRoot(r),u=s?"legend-popper":null,d=[],m=[],p=[],g=function(e){return"".concat(e.cell&&e.cell.name?"".concat(e.cell.name,":"):"").concat(e.serviceName)},f=function(e){if(!d.includes(g(e))){var t=e.cell?e.cell.name:null;t||(t=e.componentType===J.CelleryType.SYSTEM?Oe.SYSTEM:e.componentType);var a=o.getColor(t);d.push(g(e)),m.push({id:g(e),color:a,size:350,span:e})}};c.walk(function(e,t){var a=t;return J.System.SIDECAR_AUTH_FILTER_OPERATION_NAME_PATTERN.test(e.operationName)||J.System.ISTIO_MIXER_NAME_PATTERN.test(e.serviceName)||(a&&e.kind===J.Span.Kind.SERVER?(f(e),function(e,t){var a={source:g(e),target:g(t)};(e.hasError()||t.hasError())&&(a.color=o.getColor(Oe.ERROR)),p.push(a)}(a,e),a=null):a||e.kind!==J.Span.Kind.CLIENT||(f(e),a=e)),a},null);for(var v=Number.MAX_SAFE_INTEGER,E=0,b=0;b<m.length;b++){var C=m[b];C.span.duration<v&&(v=C.span.duration),C.span.duration>E&&(E=C.span.duration)}return m.length>0&&p.length>0?z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:n.graphContainer},z.a.createElement("div",{className:n.diagram},z.a.createElement(Yt,{id:"graph-id",nodeData:m,edgeData:p,graphType:"dependency",onClickNode:a.onClickCell,viewGenerator:function(e,a){var n;n=e===t.GLOBAL_GATEWAY?Oe.shadeColor(o.getColor(Oe.SYSTEM),a):Oe.shadeColor(o.getColor(e.split(":")[0]),a);var r=Oe.shadeColor(n,-.08),l=Oe.shadeColor(o.getColor(Oe.ERROR),a),i=[];m.forEach(function(t){t.id===e&&i.push(t)});var s,c=(i[0].span.duration-v)*(t.MAX_RADIUS-t.MIN_RADIUS)/(E-v)+t.MIN_RADIUS;if(i[0].span.hasError()){var u=120-c*(Math.PI/4)-30;s='<svg xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="100%" height="100%" viewBox="0 0 240 240">'+'<g><g><g><circle cx="120" cy="120" r="'.concat(c-3,'" fill="').concat(n,'" stroke="').concat(r,'" stroke-width="5"/></g></g>')+'<g transform="translate('.concat(150,",").concat(u,') scale(0.35, 0.35)">')+'<path stroke="#fff" strokeWidth="10" fill="'.concat(l,'" d="M120.5,9.6C59.1,9.6,9,59.8,9,121.3S59.1,233,120.5, 233S232,182.8,232,121.3S181.9,9.6,120.5,9.6z"/>')+'<path fill="#ffffff" d="M105.4,164.5h29.9v29.9h-29.9V164.5z M105.4, 44.2h29.9v90.1h-29.9V44.2z"/></g></g></svg>'}else s='<svg xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="100%" height="100%" viewBox="0 0 240 240">'+'<circle cx="120" cy="120" r="'.concat(c-3,'" fill="').concat(n,'" stroke="').concat(r,'" stroke-width="5"/>')+"</svg>";return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(s))}}))),z.a.createElement(mn.a,{"aria-describedby":u,variant:"outlined",className:n.btnLegend,onClick:a.handleClick},"Legend"),z.a.createElement(Lr.a,{id:u,open:s,anchorEl:i,placement:"top-end",disablePortal:!1,transition:!0},function(e){var t=e.TransitionProps;return z.a.createElement(Or.a,Object.assign({},t,{timeout:350}),z.a.createElement(Yn.a,null,z.a.createElement("div",{className:n.legendContent},z.a.createElement("div",null,z.a.createElement(lo.a,{className:n.legendFirstEl,color:"action"}),z.a.createElement(Ja.a,{color:"inherit",className:n.legendText}," Component/System component "),z.a.createElement(Ja.a,{color:"textSecondary",className:n.legendHelpText}," (Radius proportional to the request duration)")),z.a.createElement("div",null,z.a.createElement(vr.a,{className:n.legendFirstEl,color:"action"}),z.a.createElement(Ja.a,{color:"inherit",className:n.legendText}," Dependency"),z.a.createElement(h.a,{className:n.legendIcon,color:"error"}),z.a.createElement(Ja.a,{color:"inherit",className:n.legendText},"Error")))))})):null},a.state={legend:null,legendOpen:!1},a}return Object(l.a)(t,e),t}(z.a.Component);co.MIN_RADIUS=60,co.MAX_RADIUS=120,co.GLOBAL_GATEWAY="global-gateway";var uo=Object(K.withStyles)(function(e){return{graph:{width:"100%",height:"100%"},btnLegend:{position:"sticky",bottom:20,fontSize:12,float:"right"},legendContent:{padding:2*e.spacing.unit},legendText:{display:"inline-flex",marginLeft:5,fontSize:12},legendHelpText:{display:"inline-flex",fontSize:11,marginLeft:5},legendIcon:{verticalAlign:"middle",marginLeft:20},legendFirstEl:{verticalAlign:"middle"},graphContainer:{display:"flex"},diagram:{padding:3*e.spacing.unit,flexGrow:1}}},{withTheme:!0})(at(co)),mo=(a(5779),a(104)),po=a.n(mo),go=a(352),ho=a.n(go),fo=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).state={config:"",spanData:"sequenceDiagram \n",copyArr:[],clicked:!1,cellName:null,clonedArray:[],cellClicked:"global",callIdClicked:""},a.mermaidDivRef=z.a.createRef(),a.addCells=a.addCells.bind(Object(R.a)(Object(R.a)(a))),a.addServices=a.addServices.bind(Object(R.a)(Object(R.a)(a))),a.drawCells=a.drawCells.bind(Object(R.a)(Object(R.a)(a))),a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props.classes;return z.a.createElement("div",null,z.a.createElement("div",{className:e.navigation},z.a.createElement("span",{className:e.navList},z.a.createElement(Ja.a,{color:"textSecondary",className:e.subtitle,onClick:this.addCells,style:this.state.clicked?{color:"#3e51b5",cursor:"pointer",textDecoration:"underline"}:{}},"Cells")),z.a.createElement("span",{className:e.navList},z.a.createElement(dt.a,{color:"action",style:this.state.clicked?{}:{display:"none"}})),z.a.createElement("span",{className:e.navList},z.a.createElement(Ja.a,{color:"textSecondary",className:e.subtitle,style:this.state.clicked?{}:{display:"none"}},this.state.cellClicked," cell [",this.state.callIdClicked,"] - Services"))),z.a.createElement("br",null),z.a.createElement("div",{className:e.mermaid,ref:this.mermaidDivRef},this.state.config))}},{key:"componentDidMount",value:function(){var e=this;this.addCells(),po()(".messageText").on("tap",function(t){if("Return"!==t.srcElement.innerHTML&&!0!==e.state.clicked){var a=t.srcElement.innerHTML.match(/\d+/g).map(Number);e.addServices(a)}}),this.cloneArray()}},{key:"componentDidUpdate",value:function(e,t,a){if(this.state.config!==t.config){var n=this.mermaidDivRef.current.getElementsByClassName("messageText");this.mermaidDivRef.current.removeAttribute("data-processed"),ho.a.init(this.mermaidDivRef.current),this.state.clicked||this.setMessageLinkStyle(n)}if(this.state.config!==t.config||this.props.colorGenerator!==e.colorGenerator){var r=this.mermaidDivRef.current.getElementsByClassName("actor");this.addActorColor(this.state.clicked,r)}}},{key:"setMessageLinkStyle",value:function(e){for(var t=this.props.classes,a=0;a<e.length;a++)e[a].innerHTML.match("\\s\\[([0-9]+)\\]+$")&&e[a].classList.add(t.newMessageText)}},{key:"addActorColor",value:function(e,a){var n,r,o,l=this.props.colorGenerator;if(e){n=(r=this.state.cellClicked)===t.GLOBAL?l.getColor(Oe.SYSTEM):l.getColor(t.addDash(r)),o="\n                stroke: ".concat(n,";\n                stroke-width: 3;\n                fill: #ffffff");for(var i=0;i<a.length;i+=2)a[i].style=o}else for(var s=1;s<a.length;s+=2)if(null!==a[s].firstElementChild){var c=t.addDash(a[s].firstElementChild.innerHTML);n=c===t.addDash(t.GLOBAL_GATEWAY)?l.getColor(Oe.SYSTEM):l.getColor(c),o="\n                stroke: ".concat(n,";\n                stroke-width: 3;\n                fill: #ffffff"),a[s-1].style=o}}},{key:"cloneArray",value:function(){this.setState({clonedArray:this.props.spans})}},{key:"addServices",value:function(e){var a="sequenceDiagram \n",n=this.state.clonedArray[t.findSpanIndexCall(this.state.clonedArray,e)],r=n.cell.name;this.setState({cellClicked:r,callIdClicked:e}),a+="activate ".concat(t.removeDash(n.serviceName),"\n");var o=0;n.walk(function(n){n.isFromIstioSystemComponent()||n.isFromCellerySystemComponent()||n.callingId||r!==n.cell.name||n.parent.serviceName!==n.serviceName&&(o+=1,a+="".concat("".concat(t.removeDash(n.parent.serviceName),"  ->>+")+"".concat(t.removeDash(n.serviceName),":")).concat(n.operationName)+"- [".concat(e,".").concat(o,"] \n"))},null,function(e){e.isFromIstioSystemComponent()||e.isFromCellerySystemComponent()||(a+=t.updateTextDataWithReturn(e,r))},function(e){return!e.isFromIstioSystemComponent()&&!e.isFromCellerySystemComponent()&&!e.callingId&&r!==e.parent.cell.name}),a+="deactivate ".concat(t.removeDash(n.serviceName),"\n"),this.setState({config:a,clicked:!0})}},{key:"addCells",value:function(){this.setState({config:this.drawCells(),clicked:!1})}},{key:"drawCells",value:function(){for(var e=t.separateCells(this.props.spans),a="sequenceDiagram \n",n=0;n<e.length;n++)a+="participant ".concat(e[n],"\n");return(a+="activate ".concat(t.GLOBAL_GATEWAY,"\n"))+this.addCellConnections()}},{key:"addCellConnections",value:function(){var e=1,a=so.getTreeRoot(this.props.spans),n="";return a.walk(function(a){var r,o;null!==a.parent&&(r=null===a.parent.cell?t.GLOBAL_GATEWAY:a.parent.cell.name,a.cell&&((r=t.removeDash(r))===(o=t.removeDash(a.cell.name))||a.operationName.match(J.System.SIDECAR_AUTH_FILTER_OPERATION_NAME_PATTERN)||(a.callingId=e,n+="".concat(r,"->>+").concat(o,": call ").concat(a.cell.name,"-cell [").concat(e,"] \n"),e+=1)))},void 0,function(e){if(e.cell){var a="";a=null===e.parent.cell?t.GLOBAL_GATEWAY:e.parent.cell.name,e.cell.name===a||e.operationName.match(J.System.SIDECAR_AUTH_FILTER_OPERATION_NAME_PATTERN)||(n+="".concat(t.removeDash(e.cell.name),"--\x3e>-")+"".concat(t.removeDash(a),": Return \n"))}}),n+="deactivate ".concat(t.GLOBAL_GATEWAY)}}],[{key:"updateTextDataWithReturn",value:function(e,a){var n="";return e.callingId||a!==e.cell.name||e.parent.serviceName!==e.serviceName&&(n+="".concat(t.removeDash(e.serviceName),"--\x3e>- ")+"".concat(t.removeDash(e.parent.serviceName),": Return \n")),n}},{key:"separateCells",value:function(e){for(var a=[],n=0;n<e.length;n++)if(e[n].serviceName.includes(t.GLOBAL)&&(a.includes(t.GLOBAL_GATEWAY)||a.push(t.GLOBAL_GATEWAY)),e[n].cell){var r=t.removeDash(e[n].cell.name);a.includes(r)||a.push(r)}return a}},{key:"removeDash",value:function(e){return e.includes("-")?e.replace(/-/g," "):e}},{key:"addDash",value:function(e){return e.includes(" ")?e.replace(" ","-"):e}},{key:"findSpanIndexCall",value:function(e,t){var a=!1;return e.findIndex(function(e){return e.callingId&&(a=e.callingId===t[0]),a})}}]),t}(z.a.Component);fo.GLOBAL="global",fo.GLOBAL_GATEWAY="global gateway";var vo=Object(K.withStyles)(function(){return{newMessageText:{fill:"#4c4cb3 !important",cursor:"pointer"},subtitle:{fontWeight:400,fontSize:"1.0rem"},mermaid:{padding:10},navigation:{paddingTop:20,paddingBottom:5,marginLeft:50},navList:{display:"block",float:"left"}}},{withTheme:!0})(at(fo)),Eo=a(119),bo=a.n(Eo),Co=a(248),To=a.n(Co),Oo=a(120),So=a.n(Oo),yo=(a(5799),a(5801),a(37)),No=a.n(yo),Lo=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentWillUnmount=function(){var e=a.props.classes;t.clearInteractions(".".concat(e.resizeHandle)),t.clearInteractions(".".concat(e.spanLabelContainer)),a.timeline&&a.timeline.destroy()},a.render=function(){var e=a.props,t=e.classes,n=e.spans;a.calculateTrace();for(var r=[],o=0;o<n.length;o++){var l=n[o].serviceName;r.includes(l)||r.push(l)}var i=a.trace.maxTime-a.trace.minTime,s=new Date(a.trace.minTime).toGMTString();return z.a.createElement(z.a.Fragment,null,z.a.createElement("div",{className:t.overallDescriptionContainer},z.a.createElement("span",{className:t.overallDescriptionKey},"Trace Start:"),z.a.createElement("span",{className:t.overallDescriptionValue},s),z.a.createElement("span",{className:t.overallDescriptionSeparator}),z.a.createElement("span",{className:t.overallDescriptionKey},"Duration:"),z.a.createElement("span",{className:t.overallDescriptionValue},i,"ms"),z.a.createElement("span",{className:t.overallDescriptionSeparator}),z.a.createElement("span",{className:t.overallDescriptionKey},"Services:"),z.a.createElement("span",{className:t.overallDescriptionValue},r.length),z.a.createElement("span",{className:t.overallDescriptionSeparator}),z.a.createElement("span",{className:t.overallDescriptionKey},"Depth:"),z.a.createElement("span",{className:t.overallDescriptionValue},a.trace.treeHeight),z.a.createElement("span",{className:t.overallDescriptionSeparator}),z.a.createElement("span",{className:t.overallDescriptionKey},"Total Spans:"),z.a.createElement("span",{className:t.overallDescriptionValue},n.length)),z.a.createElement("div",{ref:a.timelineNode}))},a.calculateTrace=function(){var e=a.props.spans,t=so.getTreeRoot(e);a.trace.treeHeight=0;var n=Number.MAX_VALUE,r=0,o=[];t.walk(function(e){e.treeDepth>a.trace.treeHeight&&(a.trace.treeHeight=e.treeDepth),e.startTime<n&&(n=e.startTime),e.startTime+e.duration>r&&(r=e.startTime+e.duration),e.cell.name&&!o.includes(e.cell.name)&&o.push(e.cell.name)}),a.trace.treeHeight+=1,a.trace.minTime=n,a.trace.maxTime=r},a.drawTimeline=function(){var e=a.props,n=e.selectedComponent,r=e.classes,o=e.colorGenerator,l=e.spans,i=Object(R.a)(Object(R.a)(a));a.selectedSpan=null;var s={CLIENT:{name:"Client",color:"#1abc9c"},SERVER:{name:"Server",color:"#3498db"},PRODUCER:{name:"Producer",color:"#16a085"},CONSUMER:{name:"Consumer",color:"#2980b9"}},c=a.trace.maxTime-a.trace.minTime,u=a.trace.minTime-.05*c,d=a.trace.maxTime+.12*c,m=function(e,a){!n||a.cell.name&&a.cell.name!==n.cellName||a.serviceName!==n.serviceName||e.classList.add(t.Classes.SELECTED_SPAN)},p={orientation:"top",showMajorLabels:!0,editable:!1,selectable:!1,groupEditable:!1,showCurrentTime:!1,min:new Date(u),max:new Date(d),start:new Date(u),end:new Date(d),order:function(e,t){return e.order-t.order},groupTemplate:function(e){var t=document.createElement("div");if(e&&e.span.serviceName){var n=s[e.span.kind],o=e.span.children.size;No.a.render(z.a.createElement("div",null,z.a.createElement("div",{style:{paddingLeft:"".concat(15*(e.span.treeDepth+(0===o?1:0)),"px"),minWidth:"".concat(15*(a.trace.treeHeight+1)+100,"px"),width:"".concat(i.spanLabelWidth>0?i.spanLabelWidth:null,"px")},className:r.spanLabelContainer},e.span.cell&&e.span.cell.name?z.a.createElement("span",{className:r.cellName},"".concat(e.span.cell.name,":")):null,z.a.createElement("span",{className:r.serviceName},e.span.serviceName),z.a.createElement("span",{className:r.operationName},e.span.operationName)),n?z.a.createElement("div",{className:r.kindBadge,style:{backgroundColor:n.color}},n.name):null),t),m(t,e.span)}return t},template:function(e,a){var n=document.createElement("div"),l=z.a.createElement("span",null,e.content);if(e.itemType===t.ItemType.SPAN){l=z.a.createElement("span",null,e.span.duration," ms");var i=e.span.cell.name;i||(i=e.span.componentType===J.CelleryType.SYSTEM?Oe.SYSTEM:e.span.componentType);var s=o.getColor(i),c=a.parentElement.parentElement;c.style.backgroundColor=s,c.style.borderColor=s}else if(e.itemType===t.ItemType.SPAN_DESCRIPTION){var u=[];for(var d in e.span.tags)e.span.tags.hasOwnProperty(d)&&u.push({key:d,value:e.span.tags[d]});u.length>0&&(l=z.a.createElement(fa.a,{className:r.spanDescriptionContent},z.a.createElement(Ea.a,null,z.a.createElement(Ja.a,{color:"textSecondary",gutterBottom:!0},"Tags"),z.a.createElement(ea.a,null,z.a.createElement(aa.a,null,u.map(function(e,t){return z.a.createElement(la.a,{hover:!0,key:t},z.a.createElement(ra.a,{component:"th",scope:"row"},z.a.createElement("div",null,e.key)),z.a.createElement(ra.a,null,z.a.createElement("div",null,e.value)))}))))))}return No.a.render(l,n),a.setAttribute(t.SPAN_ID_ATTRIBUTE_KEY,e.span.getUniqueId()),m(a,e.span),n},groupOrder:function(e,t){return t.order-e.order}},g=l.slice().reverse(),h=".".concat(r.spanLabelContainer);t.clearInteractions(".".concat(r.resizeHandle)),t.clearInteractions(h),a.timeline||(a.timeline=new Wt.a.Timeline(a.timelineNode.current),a.addTimelineEventListener("changed",function(){var e=document.querySelector("div.".concat(t.Classes.VIS_FOREGROUND)).offsetWidth,n=function(t){t.style.left="0px",t.style.width="".concat(e,"px")};a.timelineNode.current.querySelectorAll("div.".concat(t.Classes.VIS_ITEM_SPAN_DESCRIPTION)).forEach(n),a.timelineNode.current.querySelectorAll("div.".concat(t.Classes.VIS_ITEM_CONTENT)).forEach(n),a.timelineNode.current.querySelectorAll("div.".concat(t.Classes.VIS_ITEM_SPAN)).forEach(function(e){e.querySelector("div.".concat(t.Classes.VIS_ITEM_OVERFLOW)).style.transform="translateX(".concat(e.offsetWidth+7,"px)")});var r=a.timelineNode.current.querySelectorAll("div.".concat(t.Classes.VIS_ITEM_SPAN)),o=Reflect.apply([].slice,r,[]).map(function(e){return e.parentElement.offsetHeight}).reduce(function(e,t){return t<e?t:e},Number.MAX_VALUE);r.forEach(function(e){e.style.top="".concat((o-e.offsetHeight)/2,"px")}),a.timelineNode.current.querySelectorAll("div.".concat(t.Classes.VIS_LABEL,", ")+"div.".concat(t.Classes.VIS_GROUP)).forEach(function(e){e.querySelector("div.".concat(t.Classes.SELECTED_SPAN))&&e.classList.add(t.Classes.HIGHLIGHTED_SPAN)})})),a.clearTimelineEventListeners("click"),a.addTimelineEventListener("click",function(e){"item"!==e.what&&"background"!==e.what||(a.selectedSpan===e.group?a.selectedSpan=null:a.selectedSpan=e.group,a.updateTimelineItems(g,{min:u,max:d}))}),a.timeline.setOptions(p),a.updateTimelineItems(g,{min:u,max:d}),a.addHorizontalResizability(h)},a.updateTimelineItems=function(e,n){for(var r=[],o=[],l=function(l){var i=e[l],s=[];i.walk(function(e){e!==i&&s.push(e.getUniqueId())}),o.push({id:"".concat(i.getUniqueId(),"-span"),itemType:t.ItemType.SPAN,order:1,start:new Date(i.startTime),end:new Date(i.startTime+i.duration),group:i.getUniqueId(),className:t.Classes.VIS_ITEM_SPAN,span:i}),a.selectedSpan&&a.selectedSpan===i.getUniqueId()&&o.push({id:"".concat(i.getUniqueId(),"-span-description"),itemType:t.ItemType.SPAN_DESCRIPTION,order:2,start:new Date(n.min),end:new Date(n.max),group:i.getUniqueId(),className:t.Classes.VIS_ITEM_SPAN_DESCRIPTION,span:i}),r.push({id:i.getUniqueId(),order:2*l,nestedGroups:s.length>0?s:null,span:i})},i=0;i<e.length;i++)l(i);a.timeline.setGroups(new Wt.a.DataSet(r)),a.timeline.setItems(new Wt.a.DataSet(o))},a.addHorizontalResizability=function(e){var t=Object(R.a)(Object(R.a)(a)),n={right:!0},r=a.props.classes,o=document.createElement("div");o.classList.add(r.resizeHandle);var l=a.timelineNode.current.querySelector(".vis-panel.vis-top");l.insertBefore(o,l.childNodes[0]),po()(e).resizable({manualStart:!0,edges:n}).on("resizemove",function(e){e.target.forEach(function(a){a.style.width="".concat(e.rect.width,"px"),t.spanLabelWidth=e.rect.width,t.timeline.body.emitter.emit("_change")})}),po()(".".concat(r.resizeHandle)).on("down",function(t){t.interaction.start({name:"resize",edges:n},po()(e),a.timelineNode.current.querySelectorAll(e))})},a.addTimelineEventListener=function(e,t){a.timeline.on(e,t),a.timelineEventListeners.push({type:e,callBack:t})},a.clearTimelineEventListeners=function(e){var t;e?(t=a.timelineEventListeners.filter(function(t){return t.type===e}),a.timelineEventListeners=a.timelineEventListeners.filter(function(t){return t.type!==e})):(t=a.timelineEventListeners,a.timelineEventListeners=[]);for(var n=0;n<t.length;n++){var r=t[n];a.timeline.off(r.type,r.callBack)}},a.timelineNode=z.a.createRef(),a.timeline=null,a.timelineEventListeners=[],a.spanLabelWidth=400,a.trace={treeHeight:0,minTime:0,maxTime:Number.MAX_VALUE},a}return Object(l.a)(t,e),Object(T.a)(t,[{key:"componentDidUpdate",value:function(){this.drawTimeline()}}]),t}(z.a.Component);Lo.SPAN_ID_ATTRIBUTE_KEY="spanId",Lo.Classes={VIS_FOREGROUND:"vis-foreground",VIS_LABEL:"vis-label",VIS_GROUP:"vis-group",VIS_ITEM_CONTENT:"vis-item-content",VIS_ITEM_OVERFLOW:"vis-item-overflow",VIS_ITEM_SPAN:"vis-item-span",VIS_ITEM_SPAN_DESCRIPTION:"vis-item-span-description",SELECTED_SPAN:"selected-span",HIGHLIGHTED_SPAN:"highlighted-span"},Lo.ItemType={SPAN:"span",SPAN_DESCRIPTION:"description"},Lo.clearInteractions=function(e){po()(e).unset()};var Ro=Object(K.withStyles)(function(e){return{spanLabelContainer:{width:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",display:"inline-block"},cellName:{fontWeight:500,fontSize:"normal"},serviceName:{fontWeight:500,fontSize:"normal",paddingRight:e.spacing.unit},operationName:{color:"#7c7c7c",fontSize:"small"},kindBadge:{borderRadius:"8px",color:"white",padding:"2px 5px",marginLeft:"15px",fontSize:"12px",display:"inline-block"},resizeHandle:{transform:"translateX(-5px)",backgroundColor:"#919191",cursor:"ew-resize",position:"absolute",width:"5px",height:"100%",userSelect:"none"},spanDescriptionContent:{margin:"5px 12px 5px 7px"},overallDescriptionContainer:{paddingTop:3*e.spacing.unit,paddingRight:0,paddingBottom:2*e.spacing.unit,paddingLeft:0},overallDescriptionKey:{color:"#7c7c7c",paddingRight:5},overallDescriptionValue:{fontWeight:500,color:"#5a5a5a"},overallDescriptionSeparator:{borderStyle:"solid",borderWidth:"0 0 0 1px",borderColor:"#d4d4d4",marginLeft:2*e.spacing.unit,marginRight:2*e.spacing.unit}}},{withTheme:!0})(at(Lo)),Io=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.timelineViewRef.current.drawTimeline()},a.handleServiceTypeChange=function(e){var t=e.target.value;a.setState({selectedServiceTypes:t})},a.render=function(){var e=a.props,t=e.classes,n=e.selectedComponent,r=a.state.filteredSpans,o=[];for(var l in J.CelleryType)if(J.CelleryType.hasOwnProperty(l)){var i=J.CelleryType[l];i!==J.CelleryType.COMPONENT&&o.push(i)}return z.a.createElement(z.a.Fragment,null,z.a.createElement(Oa.a,{container:!0,justify:"flex-start"},z.a.createElement(Oa.a,{item:!0,xs:3},z.a.createElement(yn.a,{className:t.formControl},z.a.createElement(In.a,{htmlFor:"select-multiple-checkbox"},"Type"),z.a.createElement(Gn.a,{multiple:!0,value:a.state.selectedServiceTypes,onChange:a.handleServiceTypeChange,input:z.a.createElement(To.a,{id:"select-multiple-checkbox"}),renderValue:function(e){return e.join(", ")}},o.map(function(e){var t=a.state.selectedServiceTypes.filter(function(e){return e!==J.CelleryType.COMPONENT}).indexOf(e)>-1;return z.a.createElement(Be.a,{key:e,value:e},z.a.createElement(bo.a,{checked:t}),z.a.createElement(So.a,{primary:e}))}),z.a.createElement(Be.a,{key:J.CelleryType.COMPONENT,value:J.CelleryType.COMPONENT,className:t.componentTypeMenuItem},z.a.createElement(bo.a,{checked:!0}),z.a.createElement(So.a,{primary:J.CelleryType.COMPONENT})))))),z.a.createElement(Ro,{spans:r,selectedComponent:n,innerRef:a.timelineViewRef}))},a.state={selectedServiceTypes:[J.CelleryType.COMPONENT,J.CelleryType.SYSTEM],filteredSpans:[]},a.timelineViewRef=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.PureComponent);Io.getDerivedStateFromProps=function(e,t){for(var a=[],n=0;n<e.spans.length;n++)a.push(e.spans[n].shallowClone());a.length>0&&so.buildTree(a);var r=[];if(a.length>0)for(var o=0;o<a.length;o++){var l=a[o];t.selectedServiceTypes.includes(l.componentType)?r.push(l):so.removeSpanFromTree(l)}if(r.length>0){var s=so.getTreeRoot(r);so.labelSpanTree(s)}return Object(i.a)({},t,{filteredSpans:r})};var Ao=qa()(function(e){return{formControl:{marginTop:4*e.spacing.unit,marginBottom:.5*e.spacing.unit},componentTypeMenuItem:{pointerEvents:"none"}}})(Io),wo=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).componentDidMount=function(){a.loadTrace()},a.componentDidUpdate=function(){a.traceViewRef.current&&a.traceViewRef.current.draw&&a.traceViewRef.current.draw()},a.loadTrace=function(){var e=a.props,t=e.globalState,n=e.match.params.traceId,r=Object(R.a)(Object(R.a)(a));r.setState({traceTree:null,spans:[]}),lt.showLoadingOverlay("Loading trace",t),r.setState({isLoading:!0}),_.callObservabilityAPI({url:"/traces/".concat(n),method:"GET"},t).then(function(e){var a=e.map(function(e){return new Jr({traceId:e[0],spanId:e[1],parentId:e[2],namespace:e[3],cell:e[4],serviceName:e[5],pod:e[6],operationName:e[7],kind:e[8],startTime:e[9],duration:e[10],tags:e[11]})});if(a.length>0)try{var n=so.buildTree(a);so.labelSpanTree(n),r.setState({traceTree:n,spans:so.getOrderedList(n)})}catch(o){lt.showNotification("Unable to Render Invalid Trace",lt.Levels.ERROR,t),r.setState({errorMessage:o.message})}lt.hideLoadingOverlay(t),r.setState({isLoading:!1})}).catch(function(){lt.hideLoadingOverlay(t),r.setState({isLoading:!1}),lt.showNotification("Failed to fetch Trace with ID ".concat(n),lt.Levels.ERROR,t)})},a.handleTabChange=function(e,t){var n=a.props,r=n.history,o=n.location,l=n.match;a.setState({selectedTabIndex:t});var s=_.generateQueryParamString(Object(i.a)({},_.parseQueryParams(o.search),{tab:a.tabs[t]}));r.replace(l.url+s,Object(i.a)({},o.state))},a.render=function(){var e,t=a.props,n=t.classes,r=t.location,o=t.match,l=a.state,i=l.spans,s=l.selectedTabIndex,c=l.isLoading,u=l.errorMessage,d=l.traceTree,m=r.state?r.state.selectedComponent:null,p=o.params.traceId,g=[Ao,vo,uo][s];return e=c||i&&i.length?z.a.createElement(zt,{title:"Unable to render Invalid Trace"},z.a.createElement(g,{spans:i,innerRef:a.traceViewRef,selectedComponent:m})):u?z.a.createElement(qt,{title:"Unable to Render Trace",description:u}):z.a.createElement(Z,{title:"Unable to find Trace",description:'Trace with ID "'.concat(p,'" Not Found')}),z.a.createElement(z.a.Fragment,null,z.a.createElement(zn,{title:d?d.serviceName:"Distributed Tracing",subTitle:"".concat(d?d.operationName:"")}),z.a.createElement(Ge.a,{className:n.container},z.a.createElement(un.a,{value:s,indicatorColor:"primary",onChange:a.handleTabChange,className:n.tabs},z.a.createElement(sn.a,{label:"Timeline"}),z.a.createElement(sn.a,{label:"Sequence Diagram"}),z.a.createElement(sn.a,{label:"Dependency Diagram"})),c?null:e))},a.tabs=["timeline","sequenceDiagram","dependency-diagram"];var l=_.parseQueryParams(e.location.search),s=l.tab?a.tabs.indexOf(l.tab):null;return a.state={traceTree:null,spans:[],selectedTabIndex:s&&-1!==s?s:0,isLoading:!1,errorMessage:null},a.traceViewRef=z.a.createRef(),a}return Object(l.a)(t,e),t}(z.a.Component),Do=qa()(function(e){return{container:{flexGrow:1,padding:3*e.spacing.unit,margin:e.spacing.unit,display:"flow-root"},tabs:{marginBottom:2*e.spacing.unit,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:ua.a[200]}}})(le(wo)),xo=a(5807),jo=Object(Y.a)(function(e){var t=e.match,a=e.location;return z.a.createElement(dr.a,null,z.a.createElement(mr.a,{exact:!0,path:"".concat(t.path,"/search"),component:ro}),z.a.createElement(mr.a,{exact:!0,path:"".concat(t.path,"/id/:traceId"),component:Do}),z.a.createElement(xo.a,{exact:!0,from:"".concat(t.url,"/"),to:{pathname:"".concat(t.url,"/search"),state:a.state}}),z.a.createElement(mr.a,{path:"".concat(t.url,"/*"),render:function(e){return z.a.createElement(Z,Object.assign({},e,{showNavigationButtons:!0}))}}))}),ko=a(5806),Mo=le(function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).handleUserChange=function(e,t,n){a.setState({isAuthenticated:Boolean(n)})},a.render=function(){return a.state.isAuthenticated?z.a.createElement(Dt,null,z.a.createElement(zt,{showNavigationButtons:!0},z.a.createElement(dr.a,null,z.a.createElement(mr.a,{exact:!0,path:"/",component:zr}),z.a.createElement(mr.a,{path:"/cells",component:pr}),z.a.createElement(mr.a,{path:"/tracing",component:jo}),z.a.createElement(mr.a,{path:"/*",render:function(e){return z.a.createElement(Z,Object.assign({},e,{showNavigationButtons:!0}))}})))):z.a.createElement(Kr,null)},a.state={isAuthenticated:Boolean(e.globalState.get(ae.USER))},e.globalState.addListener(ae.USER,a.handleUserChange),a}return Object(l.a)(t,e),t}(z.a.Component)),_o=Object(K.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:{light:"#E5EAEA",main:"#29ABE0",contrastText:"#FFF",dark:"#1F88b3"},secondary:{main:"#424245"}}}),Po=function(){return z.a.createElement(K.MuiThemeProvider,{theme:_o},z.a.createElement(hr.a,null),z.a.createElement(ko.a,null,z.a.createElement(zt,{showNavigationButtons:!0},z.a.createElement(tt,null,z.a.createElement(oe,null,z.a.createElement(Mo,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));No.a.render(z.a.createElement(Po,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5538,2,1]]]);
//# sourceMappingURL=main.2742dd39.chunk.js.map